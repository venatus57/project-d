[{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\cars\\page.tsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\cars\\page.tsx:62:35\n  60 |\n  61 |         const car: Car = {\n> 62 |             id: editingCar?.id || Date.now().toString(),\n     |                                   ^^^^^^^^^^ Cannot call impure function\n  63 |             name: formData.name || \"\",\n  64 |             make: formData.make || \"\",\n  65 |             model: formData.model || \"\",","line":62,"column":35,"nodeType":null,"endLine":62,"endColumn":45}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { Plus, Trash2, Car as CarIcon, Gauge, Weight, Settings, ArrowLeft, Zap } from \"lucide-react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { Car, Drivetrain, ModLevel, STORAGE_KEYS, getPowerToWeight } from \"../lib/types\";\r\n\r\nconst DRIVETRAINS: { value: Drivetrain; label: string }[] = [\r\n    { value: \"FR\", label: \"FR (Propulsion)\" },\r\n    { value: \"FF\", label: \"FF (Traction)\" },\r\n    { value: \"MR\", label: \"MR (Moteur central)\" },\r\n    { value: \"RR\", label: \"RR (Moteur arri√®re)\" },\r\n    { value: \"AWD\", label: \"AWD (4 roues motrices)\" },\r\n];\r\n\r\nconst MOD_LEVELS: { value: ModLevel; label: string; color: string }[] = [\r\n    { value: \"STOCK\", label: \"Stock\", color: \"text-toxic-green border-toxic-green\" },\r\n    { value: \"TUNED\", label: \"Tuned\", color: \"text-toxic-cyan border-toxic-cyan\" },\r\n    { value: \"FULL_RACE\", label: \"Full Race\", color: \"text-toxic-magenta border-toxic-magenta\" },\r\n];\r\n\r\nexport default function CarsPage() {\r\n    const [cars, setCars] = useState<Car[]>([]);\r\n    const [isLoaded, setIsLoaded] = useState(false);\r\n    const [showForm, setShowForm] = useState(false);\r\n    const [editingCar, setEditingCar] = useState<Car | null>(null);\r\n\r\n    // Form state\r\n    const [formData, setFormData] = useState<Partial<Car>>({\r\n        name: \"\",\r\n        make: \"\",\r\n        model: \"\",\r\n        year: undefined,\r\n        power: 100,\r\n        weight: 1000,\r\n        drivetrain: \"FR\",\r\n        mods: \"STOCK\",\r\n        color: \"#FACC15\",\r\n    });\r\n\r\n    // Load from localStorage\r\n    useEffect(() => {\r\n        const saved = localStorage.getItem(STORAGE_KEYS.CARS);\r\n        if (saved) {\r\n            try { setCars(JSON.parse(saved)); } catch { }\r\n        }\r\n        setIsLoaded(true);\r\n    }, []);\r\n\r\n    // Save to localStorage\r\n    useEffect(() => {\r\n        if (isLoaded) {\r\n            localStorage.setItem(STORAGE_KEYS.CARS, JSON.stringify(cars));\r\n        }\r\n    }, [cars, isLoaded]);\r\n\r\n    const handleSubmit = () => {\r\n        if (!formData.name || !formData.power || !formData.weight) return;\r\n\r\n        const car: Car = {\r\n            id: editingCar?.id || Date.now().toString(),\r\n            name: formData.name || \"\",\r\n            make: formData.make || \"\",\r\n            model: formData.model || \"\",\r\n            year: formData.year,\r\n            power: formData.power || 100,\r\n            weight: formData.weight || 1000,\r\n            drivetrain: formData.drivetrain || \"FR\",\r\n            mods: formData.mods || \"STOCK\",\r\n            color: formData.color,\r\n        };\r\n\r\n        if (editingCar) {\r\n            setCars(cars.map(c => c.id === editingCar.id ? car : c));\r\n        } else {\r\n            setCars([...cars, car]);\r\n        }\r\n\r\n        resetForm();\r\n    };\r\n\r\n    const resetForm = () => {\r\n        setFormData({\r\n            name: \"\",\r\n            make: \"\",\r\n            model: \"\",\r\n            year: undefined,\r\n            power: 100,\r\n            weight: 1000,\r\n            drivetrain: \"FR\",\r\n            mods: \"STOCK\",\r\n            color: \"#FACC15\",\r\n        });\r\n        setEditingCar(null);\r\n        setShowForm(false);\r\n    };\r\n\r\n    const startEdit = (car: Car) => {\r\n        setFormData(car);\r\n        setEditingCar(car);\r\n        setShowForm(true);\r\n    };\r\n\r\n    const deleteCar = (id: string) => {\r\n        setCars(cars.filter(c => c.id !== id));\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-black text-zinc-100 p-8 font-pixel\">\r\n\r\n            {/* Header */}\r\n            <header className=\"mb-8 border-b-2 border-zinc-800 pb-4\">\r\n                <Link href=\"/garage\" className=\"text-zinc-500 hover:text-toxic-cyan text-sm flex items-center gap-2 mb-4 font-bold tracking-widest uppercase\">\r\n                    <ArrowLeft size={14} /> Retour au garage\r\n                </Link>\r\n                <h1 className=\"text-4xl font-bold italic tracking-tighter text-toxic-magenta glitch-hover text-shadow-neon\">\r\n                    MES VOITURES\r\n                </h1>\r\n                <p className=\"text-zinc-500 mt-2 font-bold tracking-widest uppercase\">G√®re tes voitures et leurs specs MF Ghost</p>\r\n            </header>\r\n\r\n            {/* Add Button */}\r\n            <button\r\n                onClick={() => setShowForm(true)}\r\n                className=\"flex items-center gap-2 bg-toxic-green text-black px-6 py-3 font-bold hover:bg-white transition-colors mb-8 hard-border shadow-[0_0_15px_rgba(0,255,65,0.4)] uppercase\"\r\n            >\r\n                <Plus size={18} />\r\n                AJOUTER UNE VOITURE\r\n            </button>\r\n\r\n            {/* Form Modal */}\r\n            <AnimatePresence>\r\n                {showForm && (\r\n                    <motion.div\r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        exit={{ opacity: 0 }}\r\n                        className=\"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center p-4 font-pixel\"\r\n                        onClick={() => resetForm()}\r\n                    >\r\n                        <motion.div\r\n                            initial={{ scale: 0.95, opacity: 0, y: 20 }}\r\n                            animate={{ scale: 1, opacity: 1, y: 0 }}\r\n                            exit={{ scale: 0.95, opacity: 0, y: 20 }}\r\n                            transition={{ duration: 0.2 }}\r\n                            onClick={(e) => e.stopPropagation()}\r\n                            className=\"bg-[#050510] border-2 border-zinc-800 hard-border p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto\"\r\n                        >\r\n                            <h2 className=\"text-2xl font-bold text-toxic-cyan mb-6 flex items-center gap-2 uppercase tracking-widest text-shadow-neon\">\r\n                                <CarIcon size={24} />\r\n                                {editingCar ? \"MODIFIER LA VOITURE\" : \"NOUVELLE VOITURE\"}\r\n                            </h2>\r\n\r\n                            <div className=\"space-y-4\">\r\n                                {/* Name */}\r\n                                <div>\r\n                                    <label className=\"text-zinc-500 text-[10px] block mb-1 font-bold tracking-widest uppercase\">NOM COMPLET *</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        placeholder=\"EX: TOYOTA AE86 TRUENO\"\r\n                                        value={formData.name}\r\n                                        onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                                        className=\"w-full bg-black border-2 border-zinc-800 hard-border px-3 py-2 text-white font-bold uppercase transition-colors focus:border-toxic-cyan outline-none\"\r\n                                    />\r\n                                </div>\r\n\r\n                                {/* Make & Model */}\r\n                                <div className=\"grid grid-cols-2 gap-4\">\r\n                                    <div>\r\n                                        <label className=\"text-zinc-500 text-[10px] block mb-1 font-bold tracking-widest uppercase\">MARQUE</label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            placeholder=\"TOYOTA\"\r\n                                            value={formData.make}\r\n                                            onChange={(e) => setFormData({ ...formData, make: e.target.value })}\r\n                                            className=\"w-full bg-black border-2 border-zinc-800 hard-border px-3 py-2 text-white font-bold uppercase transition-colors focus:border-toxic-cyan outline-none\"\r\n                                        />\r\n                                    </div>\r\n                                    <div>\r\n                                        <label className=\"text-zinc-500 text-[10px] block mb-1 font-bold tracking-widest uppercase\">MOD√àLE</label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            placeholder=\"AE86\"\r\n                                            value={formData.model}\r\n                                            onChange={(e) => setFormData({ ...formData, model: e.target.value })}\r\n                                            className=\"w-full bg-black border-2 border-zinc-800 hard-border px-3 py-2 text-white font-bold uppercase transition-colors focus:border-toxic-cyan outline-none\"\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Year & Color */}\r\n                                <div className=\"grid grid-cols-2 gap-4\">\r\n                                    <div>\r\n                                        <label className=\"text-zinc-500 text-[10px] block mb-1 font-bold tracking-widest uppercase\">ANN√âE</label>\r\n                                        <input\r\n                                            type=\"number\"\r\n                                            placeholder=\"1986\"\r\n                                            value={formData.year || \"\"}\r\n                                            onChange={(e) => setFormData({ ...formData, year: parseInt(e.target.value) || undefined })}\r\n                                            className=\"w-full bg-black border-2 border-zinc-800 hard-border px-3 py-2 text-white font-bold uppercase transition-colors focus:border-toxic-cyan outline-none\"\r\n                                        />\r\n                                    </div>\r\n                                    <div>\r\n                                        <label className=\"text-zinc-500 text-[10px] block mb-1 font-bold tracking-widest uppercase\">COULEUR</label>\r\n                                        <div className=\"relative w-full h-10 border-2 border-zinc-800 hard-border cursor-pointer focus-within:border-toxic-cyan transition-colors overflow-hidden\">\r\n                                            <input\r\n                                                type=\"color\"\r\n                                                value={formData.color || \"#00FFFF\"}\r\n                                                onChange={(e) => setFormData({ ...formData, color: e.target.value })}\r\n                                                className=\"absolute inset-[-10px] w-20 h-20 opacity-0 cursor-pointer\"\r\n                                            />\r\n                                            <div className=\"w-full h-full\" style={{ backgroundColor: formData.color || \"#00FFFF\" }} />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Power & Weight */}\r\n                                <div className=\"grid grid-cols-2 gap-4\">\r\n                                    <div>\r\n                                        <label className=\"text-zinc-500 text-[10px] block mb-1 font-bold tracking-widest uppercase flex items-center gap-1\">\r\n                                            <Gauge size={12} /> PUISSANCE (ch) *\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"number\"\r\n                                            placeholder=\"130\"\r\n                                            value={formData.power || \"\"}\r\n                                            onChange={(e) => setFormData({ ...formData, power: parseInt(e.target.value) || 0 })}\r\n                                            className=\"w-full bg-black border-2 border-zinc-800 hard-border px-3 py-2 text-white font-bold uppercase transition-colors focus:border-toxic-cyan outline-none\"\r\n                                        />\r\n                                    </div>\r\n                                    <div>\r\n                                        <label className=\"text-zinc-500 text-[10px] block mb-1 font-bold tracking-widest uppercase flex items-center gap-1\">\r\n                                            <Weight size={12} /> POIDS (kg) *\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"number\"\r\n                                            placeholder=\"940\"\r\n                                            value={formData.weight || \"\"}\r\n                                            onChange={(e) => setFormData({ ...formData, weight: parseInt(e.target.value) || 0 })}\r\n                                            className=\"w-full bg-black border-2 border-zinc-800 hard-border px-3 py-2 text-white font-bold uppercase transition-colors focus:border-toxic-cyan outline-none\"\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Power/Weight Ratio Display */}\r\n                                {formData.power && formData.weight && (\r\n                                    <div className=\"bg-black border-2 border-zinc-800 hard-border p-3 text-center\">\r\n                                        <div className=\"text-zinc-500 text-[10px] tracking-widest font-bold uppercase\">RATIO POIDS/PUISSANCE</div>\r\n                                        <div className=\"text-2xl font-bold text-toxic-yellow text-shadow-[0_0_10px_rgba(255,255,0,0.3)]\">\r\n                                            {(formData.weight / formData.power).toFixed(2)} kg/ch\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* Drivetrain */}\r\n                                <div>\r\n                                    <label className=\"text-zinc-500 text-[10px] block mb-2 font-bold tracking-widest uppercase\">TRANSMISSION</label>\r\n                                    <div className=\"grid grid-cols-3 gap-2\">\r\n                                        {DRIVETRAINS.map((dt) => (\r\n                                            <button\r\n                                                key={dt.value}\r\n                                                onClick={() => setFormData({ ...formData, drivetrain: dt.value })}\r\n                                                className={`p-2 text-xs font-bold border-2 hard-border transition-colors uppercase tracking-wider ${formData.drivetrain === dt.value\r\n                                                    ? \"bg-toxic-cyan/20 border-toxic-cyan text-toxic-cyan shadow-[0_0_10px_rgba(0,255,255,0.2)]\"\r\n                                                    : \"bg-black border-zinc-800 text-zinc-500 hover:border-toxic-cyan hover:text-toxic-cyan\"\r\n                                                    }`}\r\n                                            >\r\n                                                {dt.value}\r\n                                            </button>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Mods */}\r\n                                <div>\r\n                                    <label className=\"text-zinc-500 text-[10px] block mb-2 font-bold tracking-widest uppercase flex items-center gap-1\">\r\n                                        <Settings size={12} /> NIVEAU DE MODIFICATION\r\n                                    </label>\r\n                                    <div className=\"grid grid-cols-3 gap-2\">\r\n                                        {MOD_LEVELS.map((mod) => (\r\n                                            <button\r\n                                                key={mod.value}\r\n                                                onClick={() => setFormData({ ...formData, mods: mod.value })}\r\n                                                className={`p-2 text-xs font-bold border-2 hard-border transition-colors uppercase tracking-wider ${formData.mods === mod.value\r\n                                                    ? `bg-opacity-20 ${mod.color} bg-current shadow-[0_0_10px_currentColor]`\r\n                                                    : \"bg-black border-zinc-800 text-zinc-500 hover:border-zinc-500 hover:text-zinc-300\"\r\n                                                    }`}\r\n                                            >\r\n                                                {mod.label}\r\n                                            </button>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Submit */}\r\n                                <div className=\"flex gap-3 pt-6 border-t-2 border-zinc-800 mt-6\">\r\n                                    <button\r\n                                        onClick={() => resetForm()}\r\n                                        className=\"flex-1 px-4 py-3 bg-black border-2 border-zinc-800 text-zinc-400 hover:bg-zinc-800 hover:text-white font-bold transition-colors hard-border uppercase tracking-widest\"\r\n                                    >\r\n                                        ANNULER\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={handleSubmit}\r\n                                        disabled={!formData.name || !formData.power || !formData.weight}\r\n                                        className=\"flex-1 px-4 py-3 bg-toxic-green text-black font-bold hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors hard-border uppercase tracking-widest shadow-[0_0_15px_rgba(0,255,65,0.4)] disabled:shadow-none\"\r\n                                    >\r\n                                        {editingCar ? \"MODIFIER\" : \"AJOUTER\"}\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </motion.div>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n\r\n            {/* Cars Grid */}\r\n            {cars.length === 0 ? (\r\n                <div className=\"text-center py-16 border-2 border-dashed border-zinc-800 hard-border bg-zinc-950/50\">\r\n                    <CarIcon size={48} className=\"mx-auto text-zinc-800 mb-4\" />\r\n                    <h2 className=\"text-xl font-bold text-zinc-400 mb-2 uppercase tracking-wide\">Aucune voiture</h2>\r\n                    <p className=\"text-zinc-600 font-bold tracking-widest uppercase\">Ajoute ta premi√®re voiture pour commencer !</p>\r\n                </div>\r\n            ) : (\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                    {cars.map((car, index) => (\r\n                        <motion.div\r\n                            key={car.id}\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            transition={{ delay: index * 0.05 }}\r\n                            className=\"bg-zinc-950 border-2 border-zinc-800 hard-border overflow-hidden hover:border-toxic-cyan transition-colors\"\r\n                        >\r\n                            {/* Color Bar */}\r\n                            <div\r\n                                className=\"h-4 border-b-2 border-zinc-800\"\r\n                                style={{ backgroundColor: car.color || \"#00FFFF\" }}\r\n                            />\r\n\r\n                            <div className=\"p-4\">\r\n                                {/* Header */}\r\n                                <div className=\"flex justify-between items-start mb-4\">\r\n                                    <div>\r\n                                        <h3 className=\"text-2xl font-bold text-white uppercase tracking-wider\">{car.name}</h3>\r\n                                        {car.year && (\r\n                                            <p className=\"text-zinc-500 text-xs font-bold tracking-widest\">{car.year}</p>\r\n                                        )}\r\n                                    </div>\r\n                                    <span className={`px-2 py-1 text-[10px] font-bold border-2 hard-border ${MOD_LEVELS.find(m => m.value === car.mods)?.color\r\n                                        } uppercase tracking-widest shadow-[0_0_10px_currentColor]`} style={{ opacity: 0.9 }}>\r\n                                        {car.mods}\r\n                                    </span>\r\n                                </div>\r\n\r\n                                {/* Stats */}\r\n                                <div className=\"grid grid-cols-3 gap-4 mb-6\">\r\n                                    <div className=\"bg-black border-2 border-zinc-800 hard-border p-2 text-center\">\r\n                                        <div className=\"text-xl font-bold text-toxic-yellow\">{car.power}</div>\r\n                                        <div className=\"text-zinc-600 text-[10px] font-bold tracking-widest uppercase\">ch</div>\r\n                                    </div>\r\n                                    <div className=\"bg-black border-2 border-zinc-800 hard-border p-2 text-center\">\r\n                                        <div className=\"text-xl font-bold text-toxic-cyan\">{car.weight}</div>\r\n                                        <div className=\"text-zinc-600 text-[10px] font-bold tracking-widest uppercase\">kg</div>\r\n                                    </div>\r\n                                    <div className=\"bg-black border-2 border-zinc-800 hard-border p-2 text-center\">\r\n                                        <div className=\"text-xl font-bold text-toxic-green\">{car.drivetrain}</div>\r\n                                        <div className=\"text-zinc-600 text-[10px] font-bold tracking-widest uppercase\">trans.</div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Power/Weight */}\r\n                                <div className=\"flex items-center justify-between py-3 border-t-2 border-zinc-800 mb-2\">\r\n                                    <span className=\"text-zinc-500 text-xs font-bold tracking-widest uppercase flex items-center gap-1\">\r\n                                        <Zap size={12} className=\"text-toxic-magenta\" /> Ratio\r\n                                    </span>\r\n                                    <span className=\"text-toxic-cyan font-bold text-lg text-shadow-[0_0_10px_rgba(0,255,255,0.3)]\">\r\n                                        {getPowerToWeight(car).toFixed(2)} kg/ch\r\n                                    </span>\r\n                                </div>\r\n\r\n                                {/* Actions */}\r\n                                <div className=\"flex gap-2 pt-2\">\r\n                                    <button\r\n                                        onClick={() => startEdit(car)}\r\n                                        className=\"flex-1 text-sm py-2 bg-zinc-950 border-2 border-zinc-800 hover:bg-zinc-800 hover:border-toxic-cyan transition-colors hard-border font-bold uppercase tracking-widest text-zinc-300 hover:text-toxic-cyan\"\r\n                                    >\r\n                                        MODIFIER\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => deleteCar(car.id)}\r\n                                        className=\"px-4 py-2 bg-black border-2 border-red-500/50 text-red-500 hover:bg-red-500 hover:text-black transition-colors hard-border shadow-[0_0_10px_rgba(239,68,68,0.2)]\"\r\n                                    >\r\n                                        <Trash2 size={16} />\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </motion.div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\conquest\\builder\\MapComponent.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\conquest\\builder\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Gauge' is defined but never used.","line":9,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":36},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":715,"column":59,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[38834,38955],"text":"\r\n                                                D√âMARRER L&apos;ENREGISTREMENT\r\n                                            "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[38834,38955],"text":"\r\n                                                D√âMARRER L&lsquo;ENREGISTREMENT\r\n                                            "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[38834,38955],"text":"\r\n                                                D√âMARRER L&#39;ENREGISTREMENT\r\n                                            "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[38834,38955],"text":"\r\n                                                D√âMARRER L&rsquo;ENREGISTREMENT\r\n                                            "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":733,"column":63,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[40274,40316],"text":"Autorise l&apos;acc√®s √† la position en \"pr√©cis\""},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[40274,40316],"text":"Autorise l&lsquo;acc√®s √† la position en \"pr√©cis\""},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[40274,40316],"text":"Autorise l&#39;acc√®s √† la position en \"pr√©cis\""},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[40274,40316],"text":"Autorise l&rsquo;acc√®s √† la position en \"pr√©cis\""},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":733,"column":87,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[40274,40316],"text":"Autorise l'acc√®s √† la position en &quot;pr√©cis\""},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[40274,40316],"text":"Autorise l'acc√®s √† la position en &ldquo;pr√©cis\""},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[40274,40316],"text":"Autorise l'acc√®s √† la position en &#34;pr√©cis\""},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[40274,40316],"text":"Autorise l'acc√®s √† la position en &rdquo;pr√©cis\""},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":733,"column":94,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[40274,40316],"text":"Autorise l'acc√®s √† la position en \"pr√©cis&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[40274,40316],"text":"Autorise l'acc√®s √† la position en \"pr√©cis&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[40274,40316],"text":"Autorise l'acc√®s √† la position en \"pr√©cis&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[40274,40316],"text":"Autorise l'acc√®s √† la position en \"pr√©cis&rdquo;"},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect, useCallback, useRef } from \"react\";\r\nimport dynamic from \"next/dynamic\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport {\r\n    Pencil, Upload, Save, Undo2, RotateCcw, MapPin,\r\n    Ruler, FileDown, ChevronLeft, ChevronRight,\r\n    TrendingDown, TrendingUp, Gauge, Navigation, Flag, Route, Zap,\r\n    Disc, StopCircle, Navigation2\r\n} from \"lucide-react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\n\r\n// Types\r\ntype LatLng = [number, number];\r\n\r\ntype RouteData = {\r\n    id: string;\r\n    name: string;\r\n    points: LatLng[];\r\n    routeGeometry: LatLng[]; // Points interpol√©s suivant la route\r\n    distance: number;\r\n    createdAt: string;\r\n    type: \"DOWNHILL\" | \"UPHILL\" | \"MIXED\";\r\n    difficulty: \"EASY\" | \"MEDIUM\" | \"HARD\" | \"LEGENDARY\";\r\n    region: string;\r\n};\r\n\r\ntype RegionPreset = {\r\n    name: string;\r\n    center: LatLng;\r\n    zoom: number;\r\n    category?: string;\r\n};\r\n\r\n// Cols et routes mythiques de France üá´üá∑\r\nconst REGION_PRESETS: RegionPreset[] = [\r\n    // === ALPES ===\r\n    { name: \"Col du Galibier\", center: [45.0642, 6.4078], zoom: 14, category: \"Alpes\" },\r\n    { name: \"Col de l'Iseran\", center: [45.4167, 7.0306], zoom: 14, category: \"Alpes\" },\r\n    { name: \"Col de la Bonette\", center: [44.3261, 6.8072], zoom: 14, category: \"Alpes\" },\r\n    { name: \"Col du Lautaret\", center: [45.0356, 6.4039], zoom: 13, category: \"Alpes\" },\r\n    { name: \"Col de l'Izoard\", center: [44.8203, 6.7344], zoom: 14, category: \"Alpes\" },\r\n    { name: \"Col du Telegraphe\", center: [45.2031, 6.4436], zoom: 14, category: \"Alpes\" },\r\n    { name: \"Alpe d'Huez\", center: [45.0922, 6.0703], zoom: 13, category: \"Alpes\" },\r\n    { name: \"Col de la Croix de Fer\", center: [45.2264, 6.2047], zoom: 14, category: \"Alpes\" },\r\n\r\n    // === ALPES-MARITIMES / C√îTE D'AZUR ===\r\n    { name: \"Col de Turini\", center: [43.9797, 7.3917], zoom: 14, category: \"C√¥te d'Azur\" },\r\n    { name: \"Col de la Bonette-Restefond\", center: [44.3261, 6.8072], zoom: 13, category: \"C√¥te d'Azur\" },\r\n    { name: \"Col de Vence\", center: [43.7567, 7.0667], zoom: 14, category: \"C√¥te d'Azur\" },\r\n    { name: \"Route Napol√©on\", center: [43.8333, 6.8833], zoom: 11, category: \"C√¥te d'Azur\" },\r\n    { name: \"Gorges du Verdon\", center: [43.7500, 6.3333], zoom: 12, category: \"C√¥te d'Azur\" },\r\n    { name: \"Col de Braus\", center: [43.8667, 7.3833], zoom: 14, category: \"C√¥te d'Azur\" },\r\n\r\n    // === PROVENCE ===\r\n    { name: \"Mont Ventoux\", center: [44.1736, 5.2789], zoom: 13, category: \"Provence\" },\r\n    { name: \"Col de la Cayolle\", center: [44.2583, 6.7458], zoom: 14, category: \"Provence\" },\r\n\r\n    // === PYR√âN√âES ===\r\n    { name: \"Col du Tourmalet\", center: [42.9083, -0.1456], zoom: 14, category: \"Pyr√©n√©es\" },\r\n    { name: \"Col d'Aubisque\", center: [42.9714, -0.3397], zoom: 14, category: \"Pyr√©n√©es\" },\r\n    { name: \"Col du Soulor\", center: [42.9597, -0.3083], zoom: 14, category: \"Pyr√©n√©es\" },\r\n    { name: \"Col de Peyresourde\", center: [42.7969, 0.4492], zoom: 14, category: \"Pyr√©n√©es\" },\r\n    { name: \"Col du Portet d'Aspet\", center: [42.9297, 0.8742], zoom: 14, category: \"Pyr√©n√©es\" },\r\n    { name: \"Col de Vars\", center: [44.5381, 6.7028], zoom: 14, category: \"Pyr√©n√©es\" },\r\n\r\n    // === VOSGES ===\r\n    { name: \"Col de la Schlucht\", center: [48.0631, 7.0228], zoom: 14, category: \"Vosges\" },\r\n    { name: \"Grand Ballon\", center: [47.9019, 7.0989], zoom: 13, category: \"Vosges\" },\r\n    { name: \"Col du Ballon d'Alsace\", center: [47.8208, 6.8372], zoom: 14, category: \"Vosges\" },\r\n\r\n    // === MASSIF CENTRAL ===\r\n    { name: \"Puy de D√¥me\", center: [45.7725, 2.9644], zoom: 13, category: \"Massif Central\" },\r\n    { name: \"Col du Pas de Peyrol\", center: [45.1094, 2.6817], zoom: 14, category: \"Massif Central\" },\r\n\r\n    // === √éLE-DE-FRANCE & ENVIRONS ===\r\n    { name: \"For√™t de Fontainebleau\", center: [48.4047, 2.6989], zoom: 12, category: \"√éle-de-France\" },\r\n    { name: \"For√™t de Rambouillet\", center: [48.6439, 1.8250], zoom: 12, category: \"√éle-de-France\" },\r\n    { name: \"Vall√©e de Chevreuse\", center: [48.7072, 2.0347], zoom: 13, category: \"√éle-de-France\" },\r\n    { name: \"Routes du Vexin\", center: [49.1000, 1.7500], zoom: 12, category: \"√éle-de-France\" },\r\n    { name: \"For√™t de Compi√®gne\", center: [49.3833, 2.9000], zoom: 12, category: \"√éle-de-France\" },\r\n    { name: \"C√¥tes de Beaune (Bourgogne)\", center: [47.0167, 4.8333], zoom: 12, category: \"√éle-de-France\" },\r\n];\r\n\r\n// Dynamically import the map component (Leaflet requires browser)\r\nconst MapComponent = dynamic(() => import(\"./MapComponent\"), {\r\n    ssr: false,\r\n    loading: () => (\r\n        <div className=\"w-full h-full bg-zinc-900 flex items-center justify-center\">\r\n            <div className=\"text-zinc-500 font-mono animate-pulse\">LOADING MAP...</div>\r\n        </div>\r\n    )\r\n});\r\n\r\n// Storage key\r\nconst STORAGE_KEY = \"projectd_routes\";\r\n\r\n// OSRM API for road routing\r\nasync function getRouteFromOSRM(waypoints: LatLng[]): Promise<{ geometry: LatLng[]; distance: number } | null> {\r\n    if (waypoints.length < 2) return null;\r\n\r\n    // Format: lon,lat;lon,lat;...\r\n    const coords = waypoints.map(p => `${p[1]},${p[0]}`).join(';');\r\n    const url = `https://router.project-osrm.org/route/v1/driving/${coords}?overview=full&geometries=geojson`;\r\n\r\n    try {\r\n        const response = await fetch(url);\r\n        const data = await response.json();\r\n\r\n        if (data.code === 'Ok' && data.routes?.[0]) {\r\n            const route = data.routes[0];\r\n            // Convert GeoJSON coordinates [lon, lat] to LatLng [lat, lon]\r\n            const geometry: LatLng[] = route.geometry.coordinates.map(\r\n                (coord: [number, number]) => [coord[1], coord[0]] as LatLng\r\n            );\r\n            return {\r\n                geometry,\r\n                distance: route.distance / 1000 // Convert m to km\r\n            };\r\n        }\r\n    } catch (error) {\r\n        console.error('OSRM routing error:', error);\r\n    }\r\n    return null;\r\n}\r\n\r\nexport default function RouteBuilderPage() {\r\n    const router = useRouter();\r\n\r\n    // √âtats\r\n    const [mode, setMode] = useState<\"DRAW\" | \"IMPORT\" | \"TRACK\">(\"DRAW\");\r\n    const [waypoints, setWaypoints] = useState<LatLng[]>([]); // Points cliqu√©s par l'user\r\n    const [routeGeometry, setRouteGeometry] = useState<LatLng[]>([]); // Route calcul√©e\r\n    const [routeName, setRouteName] = useState(\"\");\r\n    const [distance, setDistance] = useState(0);\r\n    const [isPanelOpen, setIsPanelOpen] = useState(true);\r\n    const [savedRoutes, setSavedRoutes] = useState<RouteData[]>([]);\r\n    const [isCalculating, setIsCalculating] = useState(false);\r\n    const [snapToRoad, setSnapToRoad] = useState(true); // Active par d√©faut\r\n\r\n    // GPS Tracking states\r\n    const [isRecording, setIsRecording] = useState(false);\r\n    const [gpsTrack, setGpsTrack] = useState<LatLng[]>([]);\r\n    const [currentPosition, setCurrentPosition] = useState<LatLng | null>(null);\r\n    const [gpsAccuracy, setGpsAccuracy] = useState<number>(0);\r\n    const [gpsError, setGpsError] = useState<string | null>(null);\r\n    const watchIdRef = useRef<number | null>(null);\r\n\r\n    // Nouveaux √©tats pour am√©liorer le processus\r\n    const [routeType, setRouteType] = useState<\"DOWNHILL\" | \"UPHILL\" | \"MIXED\">(\"DOWNHILL\");\r\n    const [difficulty, setDifficulty] = useState<\"EASY\" | \"MEDIUM\" | \"HARD\" | \"LEGENDARY\">(\"MEDIUM\");\r\n    const [selectedRegion, setSelectedRegion] = useState<RegionPreset>(REGION_PRESETS[0]);\r\n    const [selectedCategory, setSelectedCategory] = useState<string>(\"Alpes\");\r\n    const [step, setStep] = useState<1 | 2 | 3>(1);\r\n\r\n    // Cat√©gories uniques\r\n    const categories = [...new Set(REGION_PRESETS.map(r => r.category).filter(Boolean))] as string[];\r\n\r\n    // R√©gions filtr√©es par cat√©gorie\r\n    const filteredRegions = REGION_PRESETS.filter(r => r.category === selectedCategory);\r\n\r\n    // Charger routes existantes\r\n    useEffect(() => {\r\n        const saved = localStorage.getItem(STORAGE_KEY);\r\n        if (saved) {\r\n            try { setSavedRoutes(JSON.parse(saved)); } catch { }\r\n        }\r\n    }, []);\r\n\r\n    // Calculer la route quand les waypoints changent\r\n    useEffect(() => {\r\n        const calculateRoute = async () => {\r\n            if (waypoints.length < 2) {\r\n                setRouteGeometry([]);\r\n                setDistance(0);\r\n                return;\r\n            }\r\n\r\n            if (snapToRoad) {\r\n                setIsCalculating(true);\r\n                const result = await getRouteFromOSRM(waypoints);\r\n                setIsCalculating(false);\r\n\r\n                if (result) {\r\n                    setRouteGeometry(result.geometry);\r\n                    setDistance(result.distance);\r\n                } else {\r\n                    // Fallback: ligne droite\r\n                    setRouteGeometry(waypoints);\r\n                    setDistance(calculateStraightDistance(waypoints));\r\n                }\r\n            } else {\r\n                setRouteGeometry(waypoints);\r\n                setDistance(calculateStraightDistance(waypoints));\r\n            }\r\n        };\r\n\r\n        calculateRoute();\r\n    }, [waypoints, snapToRoad]);\r\n\r\n    // Calcul distance en ligne droite (Haversine)\r\n    const calculateStraightDistance = (pts: LatLng[]): number => {\r\n        if (pts.length < 2) return 0;\r\n\r\n        let total = 0;\r\n        for (let i = 1; i < pts.length; i++) {\r\n            const [lat1, lon1] = pts[i - 1];\r\n            const [lat2, lon2] = pts[i];\r\n\r\n            const R = 6371;\r\n            const dLat = (lat2 - lat1) * Math.PI / 180;\r\n            const dLon = (lon2 - lon1) * Math.PI / 180;\r\n            const a =\r\n                Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\r\n                Math.sin(dLon / 2) * Math.sin(dLon / 2);\r\n            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n            total += R * c;\r\n        }\r\n        return total;\r\n    };\r\n\r\n    // Ajouter un waypoint\r\n    const addWaypoint = useCallback((latlng: LatLng) => {\r\n        setWaypoints(prev => [...prev, latlng]);\r\n    }, []);\r\n\r\n    // Annuler dernier point\r\n    const undoLastWaypoint = () => {\r\n        if (waypoints.length === 0) return;\r\n        setWaypoints(prev => prev.slice(0, -1));\r\n    };\r\n\r\n    // Reset\r\n    const resetRoute = () => {\r\n        setWaypoints([]);\r\n        setRouteGeometry([]);\r\n        setDistance(0);\r\n    };\r\n\r\n    // Reset complet\r\n    const fullReset = () => {\r\n        resetRoute();\r\n        setRouteName(\"\");\r\n        setRouteType(\"DOWNHILL\");\r\n        setDifficulty(\"MEDIUM\");\r\n        setStep(1);\r\n        // Also reset GPS tracking\r\n        setGpsTrack([]);\r\n        setCurrentPosition(null);\r\n        setGpsError(null);\r\n    };\r\n\r\n    // === GPS TRACKING FUNCTIONS ===\r\n\r\n    // Start GPS tracking with high accuracy\r\n    const startGpsTracking = () => {\r\n        if (!navigator.geolocation) {\r\n            setGpsError(\"La g√©olocalisation n'est pas support√©e par ce navigateur.\");\r\n            return;\r\n        }\r\n\r\n        setGpsError(null);\r\n        setGpsTrack([]);\r\n        setIsRecording(true);\r\n\r\n        // High accuracy options for optimal precision\r\n        const options: PositionOptions = {\r\n            enableHighAccuracy: true, // Use GPS if available\r\n            timeout: 10000, // Wait up to 10s for position\r\n            maximumAge: 0 // Don't use cached position\r\n        };\r\n\r\n        // Success callback - called on each position update\r\n        const onSuccess = (position: GeolocationPosition) => {\r\n            const { latitude, longitude, accuracy } = position.coords;\r\n            const newPoint: LatLng = [latitude, longitude];\r\n\r\n            setCurrentPosition(newPoint);\r\n            setGpsAccuracy(accuracy);\r\n\r\n            // Add point to track (filter out duplicates)\r\n            setGpsTrack(prev => {\r\n                if (prev.length === 0) return [newPoint];\r\n\r\n                const lastPoint = prev[prev.length - 1];\r\n                // Only add if moved more than 3 meters (to avoid GPS noise)\r\n                const distance = calculatePointDistance(lastPoint, newPoint);\r\n                if (distance > 0.003) { // ~3 meters\r\n                    return [...prev, newPoint];\r\n                }\r\n                return prev;\r\n            });\r\n        };\r\n\r\n        // Error callback\r\n        const onError = (error: GeolocationPositionError) => {\r\n            switch (error.code) {\r\n                case error.PERMISSION_DENIED:\r\n                    setGpsError(\"Permission GPS refus√©e. Autorise l'acc√®s √† ta position.\");\r\n                    break;\r\n                case error.POSITION_UNAVAILABLE:\r\n                    setGpsError(\"Position GPS indisponible.\");\r\n                    break;\r\n                case error.TIMEOUT:\r\n                    setGpsError(\"D√©lai d√©pass√© pour obtenir la position.\");\r\n                    break;\r\n            }\r\n            setIsRecording(false);\r\n        };\r\n\r\n        // Start watching position\r\n        watchIdRef.current = navigator.geolocation.watchPosition(onSuccess, onError, options);\r\n    };\r\n\r\n    // Stop GPS tracking\r\n    const stopGpsTracking = () => {\r\n        if (watchIdRef.current !== null) {\r\n            navigator.geolocation.clearWatch(watchIdRef.current);\r\n            watchIdRef.current = null;\r\n        }\r\n        setIsRecording(false);\r\n\r\n        // Convert GPS track to waypoints\r\n        if (gpsTrack.length >= 2) {\r\n            setWaypoints(gpsTrack);\r\n            setRouteGeometry(gpsTrack);\r\n            setDistance(calculateStraightDistance(gpsTrack));\r\n            setStep(2); // Move to naming step\r\n        }\r\n    };\r\n\r\n    // Calculate distance between two points in km\r\n    const calculatePointDistance = (p1: LatLng, p2: LatLng): number => {\r\n        const R = 6371;\r\n        const dLat = (p2[0] - p1[0]) * Math.PI / 180;\r\n        const dLon = (p2[1] - p1[1]) * Math.PI / 180;\r\n        const a =\r\n            Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n            Math.cos(p1[0] * Math.PI / 180) * Math.cos(p2[0] * Math.PI / 180) *\r\n            Math.sin(dLon / 2) * Math.sin(dLon / 2);\r\n        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n        return R * c;\r\n    };\r\n\r\n    // Cleanup GPS tracking on unmount\r\n    useEffect(() => {\r\n        return () => {\r\n            if (watchIdRef.current !== null) {\r\n                navigator.geolocation.clearWatch(watchIdRef.current);\r\n            }\r\n        };\r\n    }, []);\r\n\r\n    // Sauvegarder\r\n    const saveRoute = () => {\r\n        if (waypoints.length < 2 || !routeName.trim()) return;\r\n\r\n        const newRoute: RouteData = {\r\n            id: Date.now().toString(),\r\n            name: routeName,\r\n            points: waypoints,\r\n            routeGeometry,\r\n            distance,\r\n            createdAt: new Date().toISOString().split('T')[0],\r\n            type: routeType,\r\n            difficulty,\r\n            region: selectedRegion.name,\r\n        };\r\n\r\n        const updated = [...savedRoutes, newRoute];\r\n        setSavedRoutes(updated);\r\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(updated));\r\n\r\n        fullReset();\r\n        router.push(\"/conquest\");\r\n    };\r\n\r\n    // GPX Import\r\n    const handleGPXUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (!file) return;\r\n\r\n        const fakePoints: LatLng[] = [\r\n            [43.9797, 7.3917],\r\n            [43.9820, 7.3950],\r\n            [43.9850, 7.4000],\r\n            [43.9880, 7.4050],\r\n        ];\r\n        setWaypoints(fakePoints);\r\n        setRouteName(file.name.replace(\".gpx\", \"\"));\r\n        setStep(3);\r\n    };\r\n\r\n    const difficultyColors = {\r\n        EASY: \"text-toxic-green border-toxic-green\",\r\n        MEDIUM: \"text-toxic-cyan border-toxic-cyan\",\r\n        HARD: \"text-toxic-magenta border-toxic-magenta\",\r\n        LEGENDARY: \"text-toxic-yellow border-toxic-yellow\",\r\n    };\r\n\r\n    return (\r\n        <div className=\"h-screen w-full bg-black relative overflow-hidden font-pixel\">\r\n\r\n            {/* MAP (Full screen) */}\r\n            <div className=\"absolute inset-0\">\r\n                <MapComponent\r\n                    waypoints={waypoints}\r\n                    routeGeometry={routeGeometry}\r\n                    onMapClick={mode === \"DRAW\" && step >= 2 ? addWaypoint : undefined}\r\n                    center={selectedRegion.center}\r\n                    zoom={selectedRegion.zoom}\r\n                />\r\n            </div>\r\n\r\n            {/* HUD OVERLAY - Top */}\r\n            <div className=\"absolute top-4 left-1/2 -translate-x-1/2 z-[1000]\">\r\n                <div className=\"bg-black/90 backdrop-blur-md border-2 border-zinc-800 px-6 py-3 hard-border shadow-[0_0_15px_rgba(0,0,0,0.8)]\">\r\n                    <h1 className=\"text-2xl font-bold text-toxic-magenta tracking-widest text-center uppercase text-shadow-neon glitch-hover\">\r\n                        ROUTE BUILDER\r\n                    </h1>\r\n                    <div className=\"flex items-center justify-center gap-2 mt-2\">\r\n                        {[1, 2, 3].map((s) => (\r\n                            <div\r\n                                key={s}\r\n                                className={`w-8 h-1 ${step >= s ? \"bg-toxic-cyan shadow-[0_0_10px_rgba(0,255,255,0.8)]\" : \"bg-zinc-800\"}`}\r\n                            />\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* HUD OVERLAY - Stats */}\r\n            <div className=\"absolute top-4 right-4 z-[1000]\">\r\n                <div className=\"bg-black/90 backdrop-blur-md border-2 border-zinc-800 p-4 hard-border shadow-[0_0_15px_rgba(0,0,0,0.8)] space-y-2\">\r\n                    <div className=\"flex items-center gap-2 text-zinc-500 font-bold tracking-widest uppercase text-xs\">\r\n                        <MapPin size={16} className=\"text-toxic-cyan\" />\r\n                        <span className=\"text-white\">{waypoints.length} WAYPOINTS</span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2 text-zinc-500 font-bold tracking-widest uppercase text-xs\">\r\n                        <Ruler size={16} className=\"text-toxic-magenta\" />\r\n                        <span className=\"text-toxic-yellow text-shadow-[0_0_10px_rgba(255,255,0,0.5)]\">\r\n                            {isCalculating ? \"...\" : `${distance.toFixed(2)} KM`}\r\n                        </span>\r\n                    </div>\r\n                    {snapToRoad && (\r\n                        <div className=\"flex items-center gap-2 text-toxic-green text-[10px] font-bold tracking-widest uppercase\">\r\n                            <Route size={12} />\r\n                            <span>SNAP TO ROAD</span>\r\n                        </div>\r\n                    )}\r\n                    <div className=\"border-t-2 border-zinc-800 pt-2 mt-2\">\r\n                        <div className=\"text-zinc-500 text-[10px] font-bold tracking-widest uppercase\">{selectedRegion.name}</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* SIDE PANEL */}\r\n            <AnimatePresence>\r\n                {isPanelOpen && (\r\n                    <motion.div\r\n                        initial={{ x: -400 }}\r\n                        animate={{ x: 0 }}\r\n                        exit={{ x: -400 }}\r\n                        transition={{ duration: 0.2 }}\r\n                        className=\"absolute top-14 md:top-20 left-0 md:left-4 bottom-0 md:bottom-4 w-full md:w-[340px] z-[1000] flex flex-col p-4 md:p-0\"\r\n                    >\r\n                        <div className=\"bg-black/95 backdrop-blur-md border-2 border-zinc-800 hard-border flex-1 flex flex-col overflow-hidden shadow-[0_0_20px_rgba(0,0,0,0.8)]\">\r\n\r\n                            {/* Mobile Close Button (inside panel) */}\r\n                            <button\r\n                                onClick={() => setIsPanelOpen(false)}\r\n                                className=\"md:hidden w-full py-3 bg-red-500/10 border-b-2 border-red-500/30 text-red-500 text-xs font-bold uppercase tracking-widest text-center hover:bg-red-500 hover:text-black transition-colors\"\r\n                            >\r\n                                ‚Üì FERMER LE PANNEAU ‚Üì\r\n                            </button>\r\n\r\n                            {/* Mode Tabs */}\r\n                            <div className=\"flex border-b-2 border-zinc-800\">\r\n                                <button\r\n                                    onClick={() => { setMode(\"DRAW\"); setStep(1); }}\r\n                                    className={`flex-1 flex items-center justify-center gap-1 py-3 text-sm font-bold tracking-widest uppercase transition-colors ${mode === \"DRAW\"\r\n                                        ? \"bg-toxic-cyan/20 text-toxic-cyan border-b-2 border-toxic-cyan shadow-[0_0_10px_rgba(0,255,255,0.2)]\"\r\n                                        : \"text-zinc-500 hover:text-zinc-300\"\r\n                                        }`}\r\n                                >\r\n                                    <Pencil size={14} /> TRACER\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => { setMode(\"TRACK\"); setStep(1); fullReset(); }}\r\n                                    className={`flex-1 flex items-center justify-center gap-1 py-3 text-sm font-bold tracking-widest uppercase transition-colors ${mode === \"TRACK\"\r\n                                        ? \"bg-toxic-green/20 text-toxic-green border-b-2 border-toxic-green shadow-[0_0_10px_rgba(0,255,65,0.2)]\"\r\n                                        : \"text-zinc-500 hover:text-zinc-300\"\r\n                                        }`}\r\n                                >\r\n                                    <Navigation2 size={14} /> GPS\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => { setMode(\"IMPORT\"); setStep(1); }}\r\n                                    className={`flex-1 flex items-center justify-center gap-1 py-3 text-sm font-bold tracking-widest uppercase transition-colors ${mode === \"IMPORT\"\r\n                                        ? \"bg-toxic-magenta/20 text-toxic-magenta border-b-2 border-toxic-magenta shadow-[0_0_10px_rgba(255,0,255,0.2)]\"\r\n                                        : \"text-zinc-500 hover:text-zinc-300\"\r\n                                        }`}\r\n                                >\r\n                                    <Upload size={14} /> IMPORT\r\n                                </button>\r\n                            </div>\r\n\r\n                            {/* Content */}\r\n                            <div className=\"flex-1 p-4 space-y-4 overflow-y-auto\">\r\n\r\n                                {/* STEP 1: Configuration */}\r\n                                {step === 1 && mode === \"DRAW\" && (\r\n                                    <motion.div\r\n                                        initial={{ opacity: 0 }}\r\n                                        animate={{ opacity: 1 }}\r\n                                        className=\"space-y-4\"\r\n                                    >\r\n                                        <div className=\"flex items-center gap-2 text-toxic-cyan font-bold tracking-widest uppercase text-shadow-[0_0_10px_rgba(0,255,255,0.5)]\">\r\n                                            <Flag size={16} />\r\n                                            √âTAPE 1 : CONFIGURATION\r\n                                        </div>\r\n\r\n                                        {/* R√©gion */}\r\n                                        <div>\r\n                                            <label className=\"text-zinc-500 text-[10px] block mb-2 font-bold tracking-widest uppercase\">R√âGION</label>\r\n\r\n                                            {/* Category Tabs */}\r\n                                            <div className=\"flex flex-wrap gap-2 mb-3\">\r\n                                                {categories.map((cat) => (\r\n                                                    <button\r\n                                                        key={cat}\r\n                                                        onClick={() => setSelectedCategory(cat)}\r\n                                                        className={`px-3 py-1.5 text-xs font-bold transition-colors hard-border border-2 ${selectedCategory === cat\r\n                                                            ? \"bg-toxic-cyan text-black border-toxic-cyan shadow-[0_0_10px_rgba(0,255,255,0.4)]\"\r\n                                                            : \"bg-black text-zinc-500 border-zinc-800 hover:border-zinc-500\"\r\n                                                            } uppercase tracking-wider`}\r\n                                                    >\r\n                                                        {cat}\r\n                                                    </button>\r\n                                                ))}\r\n                                            </div>\r\n\r\n                                            {/* Cols in selected category */}\r\n                                            <div className=\"bg-black border-2 border-zinc-800 hard-border p-2 max-h-40 overflow-y-auto space-y-1\">\r\n                                                {filteredRegions.map((region) => (\r\n                                                    <button\r\n                                                        key={region.name}\r\n                                                        onClick={() => setSelectedRegion(region)}\r\n                                                        className={`w-full text-left p-2 text-xs font-bold transition-colors flex items-center justify-between hard-border border-2 uppercase tracking-wide ${selectedRegion.name === region.name\r\n                                                            ? \"bg-toxic-cyan/20 border-toxic-cyan text-toxic-cyan shadow-[0_0_10px_rgba(0,255,255,0.2)]\"\r\n                                                            : \"border-transparent hover:border-zinc-800 text-zinc-400\"\r\n                                                            }`}\r\n                                                    >\r\n                                                        <span>{region.name}</span>\r\n                                                        {selectedRegion.name === region.name && (\r\n                                                            <span className=\"text-toxic-cyan\">‚úì</span>\r\n                                                        )}\r\n                                                    </button>\r\n                                                ))}\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {/* Mode Snap to Road */}\r\n                                        <div>\r\n                                            <label className=\"text-zinc-500 text-[10px] block mb-2 font-bold tracking-widest uppercase\">MODE TRAC√â</label>\r\n                                            <div className=\"flex gap-2\">\r\n                                                <button\r\n                                                    onClick={() => setSnapToRoad(true)}\r\n                                                    className={`flex-1 flex items-center justify-center gap-2 p-3 font-bold border-2 hard-border transition-colors uppercase tracking-widest ${snapToRoad\r\n                                                        ? \"bg-toxic-green/20 border-toxic-green text-toxic-green shadow-[0_0_10px_rgba(0,255,65,0.2)]\"\r\n                                                        : \"bg-black border-zinc-800 text-zinc-500 hover:border-zinc-500\"\r\n                                                        }`}\r\n                                                >\r\n                                                    <Route size={16} />\r\n                                                    <span className=\"text-xs font-bold\">SUIVRE LA ROUTE</span>\r\n                                                </button>\r\n                                                <button\r\n                                                    onClick={() => setSnapToRoad(false)}\r\n                                                    className={`flex-1 flex items-center justify-center gap-2 p-3 font-bold border-2 hard-border transition-colors uppercase tracking-widest ${!snapToRoad\r\n                                                        ? \"bg-toxic-yellow/20 border-toxic-yellow text-toxic-yellow shadow-[0_0_10px_rgba(255,255,0,0.2)]\"\r\n                                                        : \"bg-black border-zinc-800 text-zinc-500 hover:border-zinc-500\"\r\n                                                        }`}\r\n                                                >\r\n                                                    <Zap size={16} />\r\n                                                    <span className=\"text-xs font-bold\">LIGNE DROITE</span>\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {/* Type */}\r\n                                        <div>\r\n                                            <label className=\"text-zinc-500 text-[10px] block mb-2 font-bold tracking-widest uppercase\">TYPE</label>\r\n                                            <div className=\"flex gap-2\">\r\n                                                {[\r\n                                                    { value: \"DOWNHILL\", label: \"DESCENTE\", icon: TrendingDown },\r\n                                                    { value: \"UPHILL\", label: \"MONT√âE\", icon: TrendingUp },\r\n                                                    { value: \"MIXED\", label: \"MIXTE\", icon: Navigation },\r\n                                                ].map((t) => (\r\n                                                    <button\r\n                                                        key={t.value}\r\n                                                        onClick={() => setRouteType(t.value as typeof routeType)}\r\n                                                        className={`flex-1 flex flex-col items-center gap-1 p-3 font-bold border-2 hard-border transition-colors uppercase tracking-widest ${routeType === t.value\r\n                                                            ? \"bg-toxic-magenta/20 border-toxic-magenta text-toxic-magenta shadow-[0_0_10px_rgba(255,0,255,0.2)]\"\r\n                                                            : \"bg-black border-zinc-800 text-zinc-500 hover:border-zinc-500\"\r\n                                                            }`}\r\n                                                    >\r\n                                                        <t.icon size={18} />\r\n                                                        <span className=\"text-xs font-bold\">{t.label}</span>\r\n                                                    </button>\r\n                                                ))}\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {/* Difficult√© */}\r\n                                        <div>\r\n                                            <label className=\"text-zinc-500 text-[10px] block mb-2 font-bold tracking-widest uppercase\">DIFFICULT√â</label>\r\n                                            <div className=\"grid grid-cols-4 gap-2\">\r\n                                                {([\"EASY\", \"MEDIUM\", \"HARD\", \"LEGENDARY\"] as const).map((d) => (\r\n                                                    <button\r\n                                                        key={d}\r\n                                                        onClick={() => setDifficulty(d)}\r\n                                                        className={`p-2 text-xs font-bold border-2 hard-border transition-colors uppercase tracking-widest ${difficulty === d\r\n                                                            ? `bg-opacity-20 ${difficultyColors[d]} bg-current shadow-[0_0_10px_currentColor]`\r\n                                                            : \"bg-black border-zinc-800 text-zinc-500 hover:border-zinc-500\"\r\n                                                            }`}\r\n                                                    >\r\n                                                        {d.slice(0, 4)}\r\n                                                    </button>\r\n                                                ))}\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <button\r\n                                            onClick={() => setStep(2)}\r\n                                            className=\"w-full bg-toxic-cyan text-black hover:bg-white py-3 text-sm font-bold mt-4 hard-border transition-colors uppercase tracking-widest shadow-[0_0_15px_rgba(0,255,255,0.4)]\"\r\n                                        >\r\n                                            CONTINUER ‚Üí\r\n                                        </button>\r\n                                    </motion.div>\r\n                                )}\r\n\r\n                                {/* === GPS TRACK MODE === */}\r\n                                {mode === \"TRACK\" && (\r\n                                    <motion.div\r\n                                        initial={{ opacity: 0 }}\r\n                                        animate={{ opacity: 1 }}\r\n                                        className=\"space-y-4\"\r\n                                    >\r\n                                        <div className=\"flex items-center gap-2 text-green-500 font-bold\">\r\n                                            <Navigation2 size={16} />\r\n                                            MODE GPS EN DIRECT\r\n                                        </div>\r\n\r\n                                        <div className=\"bg-green-500/10 border border-green-500/30 rounded p-3 text-xs text-green-400\">\r\n                                            <p className=\"font-bold mb-1\">üìç Enregistrement GPS</p>\r\n                                            <p>Appuie sur D√âMARRER puis roule ! Le site enregistrera ton trajet en temps r√©el gr√¢ce au GPS de ton t√©l√©phone.</p>\r\n                                        </div>\r\n\r\n                                        {/* GPS Error */}\r\n                                        {gpsError && (\r\n                                            <div className=\"bg-red-500/10 border border-red-500/30 rounded p-3 text-xs text-red-400\">\r\n                                                ‚ö†Ô∏è {gpsError}\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {/* Recording Status */}\r\n                                        {isRecording && (\r\n                                            <div className=\"space-y-3\">\r\n                                                {/* Recording Indicator */}\r\n                                                <div className=\"flex items-center gap-3 bg-zinc-900 border border-green-500 rounded p-4\">\r\n                                                    <div className=\"relative\">\r\n                                                        <Disc size={24} className=\"text-red-500 animate-pulse\" />\r\n                                                        <span className=\"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-ping\"></span>\r\n                                                    </div>\r\n                                                    <div>\r\n                                                        <div className=\"text-red-500 font-bold text-sm\">ENREGISTREMENT EN COURS</div>\r\n                                                        <div className=\"text-zinc-500 text-xs\">Roule pour tracer ton touge !</div>\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                {/* Live Stats */}\r\n                                                <div className=\"grid grid-cols-3 gap-2\">\r\n                                                    <div className=\"bg-zinc-800/50 p-3 rounded text-center\">\r\n                                                        <div className=\"text-2xl font-bold text-green-500\">{gpsTrack.length}</div>\r\n                                                        <div className=\"text-zinc-500 text-xs\">Points</div>\r\n                                                    </div>\r\n                                                    <div className=\"bg-zinc-800/50 p-3 rounded text-center\">\r\n                                                        <div className=\"text-2xl font-bold text-yellow-500\">{calculateStraightDistance(gpsTrack).toFixed(2)}</div>\r\n                                                        <div className=\"text-zinc-500 text-xs\">km</div>\r\n                                                    </div>\r\n                                                    <div className=\"bg-zinc-800/50 p-3 rounded text-center\">\r\n                                                        <div className=\"text-2xl font-bold text-blue-500\">{gpsAccuracy.toFixed(0)}</div>\r\n                                                        <div className=\"text-zinc-500 text-xs\">Pr√©cision (m)</div>\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                {/* Current Position */}\r\n                                                {currentPosition && (\r\n                                                    <div className=\"text-xs text-zinc-500 font-mono text-center\">\r\n                                                        üìç {currentPosition[0].toFixed(6)}, {currentPosition[1].toFixed(6)}\r\n                                                    </div>\r\n                                                )}\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {/* Start/Stop Button */}\r\n                                        {!isRecording ? (\r\n                                            <button\r\n                                                onClick={startGpsTracking}\r\n                                                className=\"w-full flex items-center justify-center gap-3 py-4 bg-green-500 text-black font-bold text-lg rounded hover:bg-green-400 transition-colors\"\r\n                                            >\r\n                                                <Navigation2 size={24} />\r\n                                                D√âMARRER L'ENREGISTREMENT\r\n                                            </button>\r\n                                        ) : (\r\n                                            <button\r\n                                                onClick={stopGpsTracking}\r\n                                                disabled={gpsTrack.length < 2}\r\n                                                className=\"w-full flex items-center justify-center gap-3 py-4 bg-red-500 text-white font-bold text-lg rounded hover:bg-red-400 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                                            >\r\n                                                <StopCircle size={24} />\r\n                                                ARR√äTER ({gpsTrack.length} points)\r\n                                            </button>\r\n                                        )}\r\n\r\n                                        {/* Info */}\r\n                                        <div className=\"text-zinc-600 text-xs space-y-1\">\r\n                                            <p>üí° <strong>Conseils pour une meilleure pr√©cision :</strong></p>\r\n                                            <ul className=\"list-disc ml-4 space-y-0.5\">\r\n                                                <li>Active le GPS haute pr√©cision sur ton t√©l√©phone</li>\r\n                                                <li>Autorise l'acc√®s √† la position en \"pr√©cis\"</li>\r\n                                                <li>Attends que la pr√©cision soit &lt; 10m avant de d√©marrer</li>\r\n                                            </ul>\r\n                                        </div>\r\n                                    </motion.div>\r\n                                )}\r\n\r\n                                {/* STEP 2: Tracer */}\r\n                                {step === 2 && mode === \"DRAW\" && (\r\n                                    <motion.div\r\n                                        initial={{ opacity: 0 }}\r\n                                        animate={{ opacity: 1 }}\r\n                                        className=\"space-y-4\"\r\n                                    >\r\n                                        <div className=\"flex items-center gap-2 text-yellow-500 font-bold\">\r\n                                            <Pencil size={16} />\r\n                                            √âTAPE 2 : TRACER\r\n                                        </div>\r\n\r\n                                        {snapToRoad ? (\r\n                                            <div className=\"bg-green-500/10 border border-green-500/30 rounded p-3 text-xs text-green-400\">\r\n                                                <Route size={14} className=\"inline mr-2\" />\r\n                                                Mode <strong>SNAP TO ROAD</strong> activ√© ‚Äî le trac√© suit automatiquement les routes !\r\n                                            </div>\r\n                                        ) : (\r\n                                            <p className=\"text-zinc-500 text-xs\">\r\n                                                Mode ligne droite ‚Äî le trac√© relie les points directement.\r\n                                            </p>\r\n                                        )}\r\n\r\n                                        {isCalculating && (\r\n                                            <div className=\"text-yellow-500 text-xs animate-pulse\">\r\n                                                Calcul de l&apos;itin√©raire...\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {/* Actions */}\r\n                                        <div className=\"grid grid-cols-2 gap-2\">\r\n                                            <button\r\n                                                onClick={undoLastWaypoint}\r\n                                                disabled={waypoints.length === 0}\r\n                                                className=\"flex items-center justify-center gap-2 py-3 bg-black border-2 border-zinc-800 hover:bg-zinc-800 hover:text-white hover:border-zinc-500 disabled:opacity-50 disabled:cursor-not-allowed text-xs font-bold transition-colors hard-border uppercase tracking-widest text-zinc-400\"\r\n                                            >\r\n                                                <Undo2 size={16} /> ANNULER\r\n                                            </button>\r\n                                            <button\r\n                                                onClick={resetRoute}\r\n                                                disabled={waypoints.length === 0}\r\n                                                className=\"flex items-center justify-center gap-2 py-3 bg-black border-2 border-red-500/50 text-red-500 hover:bg-red-500 hover:text-black disabled:opacity-50 disabled:cursor-not-allowed text-xs font-bold transition-colors hard-border uppercase tracking-widest shadow-[0_0_10px_rgba(239,68,68,0.2)] disabled:shadow-none\"\r\n                                            >\r\n                                                <RotateCcw size={16} /> RESET\r\n                                            </button>\r\n                                        </div>\r\n\r\n                                        {/* Waypoints List */}\r\n                                        {waypoints.length > 0 && (\r\n                                            <div className=\"bg-black border-2 border-zinc-800 hard-border p-3 max-h-32 overflow-y-auto\">\r\n                                                <div className=\"text-zinc-500 text-[10px] font-bold tracking-widest uppercase mb-2\">WAYPOINTS</div>\r\n                                                {waypoints.map((pt, i) => (\r\n                                                    <div key={i} className=\"flex items-center gap-2 text-xs py-1.5 border-b border-zinc-800 last:border-0\">\r\n                                                        <span className={`w-5 h-5 flex items-center justify-center text-[10px] font-bold hard-border border-2 ${i === 0 ? \"bg-toxic-green/20 text-toxic-green border-toxic-green shadow-[0_0_5px_rgba(0,255,65,0.5)]\" : i === waypoints.length - 1 ? \"bg-red-500/20 text-red-500 border-red-500 shadow-[0_0_5px_rgba(239,68,68,0.5)]\" : \"bg-toxic-yellow/20 text-toxic-yellow border-toxic-yellow\"\r\n                                                            }`}>\r\n                                                            {i + 1}\r\n                                                        </span>\r\n                                                        <span className=\"text-zinc-400 font-pixel text-xs tracking-widest\">\r\n                                                            {pt[0].toFixed(4)}, {pt[1].toFixed(4)}\r\n                                                        </span>\r\n                                                    </div>\r\n                                                ))}\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        <div className=\"flex gap-2 mt-4\">\r\n                                            <button\r\n                                                onClick={() => setStep(1)}\r\n                                                className=\"flex-1 bg-black border-2 border-zinc-800 hover:bg-zinc-800 text-zinc-400 hover:text-white py-3 text-sm font-bold transition-colors hard-border uppercase tracking-widest\"\r\n                                            >\r\n                                                ‚Üê RETOUR\r\n                                            </button>\r\n                                            <button\r\n                                                onClick={() => setStep(3)}\r\n                                                disabled={waypoints.length < 2}\r\n                                                className=\"flex-1 bg-toxic-cyan text-black hover:bg-white disabled:bg-zinc-800 disabled:border-zinc-800 disabled:text-zinc-500 disabled:shadow-none py-3 text-sm font-bold transition-colors hard-border uppercase tracking-widest shadow-[0_0_15px_rgba(0,255,255,0.4)] border-2 border-toxic-cyan\"\r\n                                            >\r\n                                                CONTINUER ‚Üí\r\n                                            </button>\r\n                                        </div>\r\n                                    </motion.div>\r\n                                )}\r\n\r\n                                {/* STEP 3: Sauvegarder */}\r\n                                {step === 3 && (\r\n                                    <motion.div\r\n                                        initial={{ opacity: 0 }}\r\n                                        animate={{ opacity: 1 }}\r\n                                        className=\"space-y-4\"\r\n                                    >\r\n                                        <div className=\"flex items-center gap-2 text-toxic-green font-bold text-shadow-[0_0_10px_rgba(0,255,65,0.5)] uppercase tracking-widest\">\r\n                                            <Save size={16} />\r\n                                            √âTAPE 3 : FINALISER\r\n                                        </div>\r\n\r\n                                        {/* R√©sum√© */}\r\n                                        <div className=\"bg-black border-2 border-zinc-800 hard-border p-4 space-y-3 font-bold uppercase tracking-widest\">\r\n                                            <div className=\"flex justify-between text-xs\">\r\n                                                <span className=\"text-zinc-500\">DISTANCE</span>\r\n                                                <span className=\"text-toxic-yellow text-shadow-[0_0_5px_rgba(255,255,0,0.5)]\">{distance.toFixed(2)} KM</span>\r\n                                            </div>\r\n                                            <div className=\"flex justify-between text-xs\">\r\n                                                <span className=\"text-zinc-500\">WAYPOINTS</span>\r\n                                                <span className=\"text-white\">{waypoints.length}</span>\r\n                                            </div>\r\n                                            <div className=\"flex justify-between text-xs\">\r\n                                                <span className=\"text-zinc-500\">TYPE</span>\r\n                                                <span className=\"text-white uppercase px-2 bg-toxic-magenta/20 border border-toxic-magenta text-toxic-magenta\">{routeType}</span>\r\n                                            </div>\r\n                                            <div className=\"flex justify-between text-xs\">\r\n                                                <span className=\"text-zinc-500\">DIFFICULT√â</span>\r\n                                                <span className={`px-2 text-[10px] hard-border border-2 ${difficultyColors[difficulty].split(' ')[0]} ${difficultyColors[difficulty].split(' ')[1]}`}>{difficulty}</span>\r\n                                            </div>\r\n                                            <div className=\"flex justify-between text-xs\">\r\n                                                <span className=\"text-zinc-500\">R√âGION</span>\r\n                                                <span className=\"text-white bg-black border border-zinc-800 px-2\">{selectedRegion.name}</span>\r\n                                            </div>\r\n                                            <div className=\"flex justify-between text-xs\">\r\n                                                <span className=\"text-zinc-500\">MODE</span>\r\n                                                <span className={snapToRoad ? \"text-toxic-green\" : \"text-toxic-yellow\"}>\r\n                                                    {snapToRoad ? \"ROUTE R√âELLE\" : \"LIGNE DROITE\"}\r\n                                                </span>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            placeholder=\"NOM DU TRAC√â (EX: COL DE TURINI)\"\r\n                                            className=\"w-full bg-black border-2 border-zinc-800 p-3 text-white font-bold uppercase tracking-widest focus:border-toxic-cyan outline-none hard-border transition-colors\"\r\n                                            value={routeName}\r\n                                            onChange={(e) => setRouteName(e.target.value)}\r\n                                        />\r\n\r\n                                        <div className=\"flex gap-2\">\r\n                                            <button\r\n                                                onClick={() => setStep(2)}\r\n                                                className=\"flex-1 bg-black border-2 border-zinc-800 hover:bg-zinc-800 text-zinc-400 hover:text-white py-3 text-sm font-bold transition-colors hard-border uppercase tracking-widest\"\r\n                                            >\r\n                                                ‚Üê RETOUR\r\n                                            </button>\r\n                                            <button\r\n                                                onClick={saveRoute}\r\n                                                disabled={!routeName.trim()}\r\n                                                className=\"flex-1 bg-toxic-green text-black hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed py-3 text-sm font-bold flex items-center justify-center gap-2 hard-border uppercase tracking-widest transition-colors shadow-[0_0_15px_rgba(0,255,65,0.4)] disabled:shadow-none border-2 border-toxic-green disabled:border-zinc-800 disabled:bg-zinc-800 disabled:text-zinc-500\"\r\n                                            >\r\n                                                <Save size={16} /> SAUVEGARDER\r\n                                            </button>\r\n                                        </div>\r\n                                    </motion.div>\r\n                                )}\r\n\r\n                                {/* MODE IMPORT */}\r\n                                {mode === \"IMPORT\" && step === 1 && (\r\n                                    <motion.div\r\n                                        initial={{ opacity: 0 }}\r\n                                        animate={{ opacity: 1 }}\r\n                                        className=\"space-y-4\"\r\n                                    >\r\n                                        <p className=\"text-zinc-500 text-xs\">\r\n                                            Importe un fichier GPX pour charger un trac√© existant.\r\n                                        </p>\r\n\r\n                                        <label className=\"block\">\r\n                                            <div className=\"border-2 border-dashed border-zinc-700 hover:border-yellow-500 rounded p-8 text-center cursor-pointer transition-colors\">\r\n                                                <FileDown size={40} className=\"mx-auto mb-3 text-zinc-500\" />\r\n                                                <span className=\"text-zinc-400 text-sm block\">Cliquer pour uploader</span>\r\n                                                <span className=\"text-zinc-600 text-xs\">.GPX</span>\r\n                                            </div>\r\n                                            <input\r\n                                                type=\"file\"\r\n                                                accept=\".gpx\"\r\n                                                onChange={handleGPXUpload}\r\n                                                className=\"hidden\"\r\n                                            />\r\n                                        </label>\r\n                                    </motion.div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n\r\n            {/* Toggle Panel Button (Desktop) */}\r\n            <button\r\n                onClick={() => setIsPanelOpen(!isPanelOpen)}\r\n                className=\"hidden md:block absolute top-1/2 -translate-y-1/2 z-[1001] bg-black/90 border-2 border-zinc-800 p-2 hard-border hover:border-toxic-cyan transition-colors shadow-[0_0_15px_rgba(0,0,0,0.8)] text-white hover:text-toxic-cyan\"\r\n                style={{ left: isPanelOpen ? \"360px\" : \"16px\" }}\r\n            >\r\n                {isPanelOpen ? <ChevronLeft size={20} /> : <ChevronRight size={20} />}\r\n            </button>\r\n\r\n            {/* Toggle Panel Button (Mobile) */}\r\n            <button\r\n                onClick={() => setIsPanelOpen(true)}\r\n                className={`md:hidden absolute z-[1001] bg-black/90 border-2 border-zinc-800 p-3 hard-border hover:border-toxic-cyan transition-colors shadow-[0_0_15px_rgba(0,0,0,0.8)] text-white font-bold tracking-widest uppercase text-xs ${isPanelOpen ? 'hidden' : 'flex'} items-center gap-2`}\r\n                style={{ bottom: \"24px\", left: \"50%\", transform: \"translateX(-50%)\" }}\r\n            >\r\n                <Pencil size={16} /> OUVRIR LE PANNEAU\r\n            </button>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\conquest\\detail\\ConquestDetailClient.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Ruler' is defined but never used.","line":8,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Edit' is defined but never used.","line":9,"column":39,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":43},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\conquest\\detail\\ConquestDetailClient.tsx:54:21\n  52 |                 const found = routes.find(r => r.id === id);\n  53 |                 if (found) {\n> 54 |                     setRoute(found);\n     |                     ^^^^^^^^ Avoid calling setState() directly within an effect\n  55 |                 }\n  56 |             } catch { }\n  57 |         }","line":54,"column":21,"nodeType":null,"endLine":54,"endColumn":29}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport dynamic from \"next/dynamic\";\r\nimport Link from \"next/link\";\r\nimport {\r\n    ArrowLeft, MapPin, Ruler, Calendar, TrendingDown,\r\n    TrendingUp, Navigation, Mountain, Edit, Trash2\r\n} from \"lucide-react\";\r\nimport { motion } from \"framer-motion\";\r\n\r\ntype LatLng = [number, number];\r\n\r\ntype RouteData = {\r\n    id: string;\r\n    name: string;\r\n    points: LatLng[];\r\n    routeGeometry?: LatLng[];\r\n    distance: number;\r\n    createdAt: string;\r\n    type: \"DOWNHILL\" | \"UPHILL\" | \"MIXED\";\r\n    difficulty: \"EASY\" | \"MEDIUM\" | \"HARD\" | \"LEGENDARY\";\r\n    region: string;\r\n};\r\n\r\nconst STORAGE_KEY = \"projectd_routes\";\r\n\r\n// Map component (client-side only)\r\nconst RouteMapView = dynamic(() => import(\"./RouteMapView\"), {\r\n    ssr: false,\r\n    loading: () => (\r\n        <div className=\"w-full h-full bg-zinc-900 flex items-center justify-center\">\r\n            <div className=\"text-zinc-500 font-mono animate-pulse\">LOADING MAP...</div>\r\n        </div>\r\n    )\r\n});\r\n\r\ninterface ConquestDetailClientProps {\r\n    id: string;\r\n}\r\n\r\nexport default function ConquestDetailClient({ id }: ConquestDetailClientProps) {\r\n    const router = useRouter();\r\n    const [route, setRoute] = useState<RouteData | null>(null);\r\n\r\n    useEffect(() => {\r\n        const saved = localStorage.getItem(STORAGE_KEY);\r\n        if (saved) {\r\n            try {\r\n                const routes: RouteData[] = JSON.parse(saved);\r\n                const found = routes.find(r => r.id === id);\r\n                if (found) {\r\n                    setRoute(found);\r\n                }\r\n            } catch { }\r\n        }\r\n    }, [id]);\r\n\r\n    const deleteRoute = () => {\r\n        if (!route) return;\r\n        const saved = localStorage.getItem(STORAGE_KEY);\r\n        if (saved) {\r\n            try {\r\n                const routes: RouteData[] = JSON.parse(saved);\r\n                const updated = routes.filter(r => r.id !== route.id);\r\n                localStorage.setItem(STORAGE_KEY, JSON.stringify(updated));\r\n                router.push(\"/conquest\");\r\n            } catch { }\r\n        }\r\n    };\r\n\r\n    const difficultyColors = {\r\n        EASY: \"bg-toxic-green/20 text-toxic-green border-toxic-green shadow-[0_0_10px_rgba(0,255,65,0.2)]\",\r\n        MEDIUM: \"bg-toxic-cyan/20 text-toxic-cyan border-toxic-cyan shadow-[0_0_10px_rgba(0,255,255,0.2)]\",\r\n        HARD: \"bg-toxic-magenta/20 text-toxic-magenta border-toxic-magenta shadow-[0_0_10px_rgba(255,0,255,0.2)]\",\r\n        LEGENDARY: \"bg-toxic-yellow/20 text-toxic-yellow border-toxic-yellow shadow-[0_0_10px_rgba(255,255,0,0.2)]\",\r\n    };\r\n\r\n    const typeIcons = {\r\n        DOWNHILL: TrendingDown,\r\n        UPHILL: TrendingUp,\r\n        MIXED: Navigation,\r\n    };\r\n\r\n    if (!route) {\r\n        return (\r\n            <div className=\"min-h-screen bg-black text-zinc-100 flex items-center justify-center font-pixel\">\r\n                <div className=\"text-zinc-500 uppercase font-bold tracking-widest\">TRAC√â NON TROUV√â...</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const TypeIcon = typeIcons[route.type];\r\n    const displayPoints = route.routeGeometry && route.routeGeometry.length > 0\r\n        ? route.routeGeometry\r\n        : route.points;\r\n\r\n    return (\r\n        <div className=\"h-screen w-full bg-black relative overflow-hidden font-pixel\">\r\n\r\n            {/* MAP (Full screen) */}\r\n            <div className=\"absolute inset-0\">\r\n                <RouteMapView\r\n                    points={route.points}\r\n                    routeGeometry={displayPoints}\r\n                />\r\n            </div>\r\n\r\n            {/* HUD - Header */}\r\n            <motion.div\r\n                initial={{ y: -50, opacity: 0 }}\r\n                animate={{ y: 0, opacity: 1 }}\r\n                className=\"absolute top-4 left-4 right-4 z-[1000]\"\r\n            >\r\n                <div className=\"bg-black/90 backdrop-blur-md border-2 border-zinc-800 hard-border p-4 shadow-[0_0_20px_rgba(0,0,0,0.8)]\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <Link\r\n                                href=\"/conquest\"\r\n                                className=\"text-zinc-500 hover:text-toxic-cyan transition-colors\"\r\n                            >\r\n                                <ArrowLeft size={24} />\r\n                            </Link>\r\n                            <div>\r\n                                <h1 className=\"text-3xl font-bold text-toxic-magenta uppercase tracking-wider text-shadow-neon glitch-hover\">{route.name}</h1>\r\n                                <div className=\"flex items-center gap-3 mt-1 text-xs font-bold text-zinc-500 tracking-widest uppercase\">\r\n                                    <span className=\"flex items-center gap-1\">\r\n                                        <Mountain size={14} />\r\n                                        {route.region}\r\n                                    </span>\r\n                                    <span className=\"flex items-center gap-1\">\r\n                                        <Calendar size={14} />\r\n                                        {route.createdAt}\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <button\r\n                                onClick={deleteRoute}\r\n                                className=\"p-2 bg-black border-2 border-red-500/50 text-red-500 hover:bg-red-500 hover:text-black hard-border transition-colors shadow-[0_0_10px_rgba(239,68,68,0.2)]\"\r\n                            >\r\n                                <Trash2 size={18} />\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </motion.div>\r\n\r\n            {/* HUD - Stats Panel */}\r\n            <motion.div\r\n                initial={{ x: 50, opacity: 0 }}\r\n                animate={{ x: 0, opacity: 1 }}\r\n                className=\"absolute top-32 right-4 z-[1000]\"\r\n            >\r\n                <div className=\"bg-black/90 backdrop-blur-md border-2 border-zinc-800 hard-border p-4 space-y-4 w-64 shadow-[0_0_20px_rgba(0,0,0,0.8)]\">\r\n\r\n                    {/* Distance */}\r\n                    <div className=\"text-center bg-zinc-950 border-2 border-zinc-800 hard-border p-3\">\r\n                        <div className=\"text-4xl font-bold text-toxic-yellow text-shadow-[0_0_10px_rgba(255,255,0,0.3)]\">{route.distance.toFixed(2)}</div>\r\n                        <div className=\"text-zinc-500 text-[10px] font-bold tracking-widest uppercase mt-1\">KILOM√àTRES</div>\r\n                    </div>\r\n\r\n                    <div className=\"border-t-2 border-zinc-800\" />\r\n\r\n                    {/* Stats */}\r\n                    <div className=\"space-y-3\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <span className=\"text-zinc-500 text-xs font-bold tracking-widest uppercase flex items-center gap-2\">\r\n                                <MapPin size={14} className=\"text-toxic-cyan\" /> Waypoints\r\n                            </span>\r\n                            <span className=\"text-white font-bold text-lg\">{route.points.length}</span>\r\n                        </div>\r\n\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <span className=\"text-zinc-500 text-xs font-bold tracking-widest uppercase flex items-center gap-2\">\r\n                                <TypeIcon size={14} className=\"text-toxic-magenta\" /> Type\r\n                            </span>\r\n                            <span className=\"text-white font-bold text-sm tracking-wider uppercase\">{route.type}</span>\r\n                        </div>\r\n\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <span className=\"text-zinc-500 text-xs font-bold tracking-widest uppercase\">Difficult√©</span>\r\n                            <span className={`px-2 py-1 text-[10px] font-bold border-2 hard-border ${difficultyColors[route.difficulty]}`}>\r\n                                {route.difficulty}\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"border-t-2 border-zinc-800\" />\r\n\r\n                    {/* Start/End coordinates */}\r\n                    <div className=\"space-y-2 text-xs font-bold tracking-widest uppercase\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <span className=\"w-3 h-3 hard-border bg-toxic-green shadow-[0_0_5px_rgba(0,255,65,0.5)]\"></span>\r\n                            <span className=\"text-zinc-400\">\r\n                                {route.points[0][0].toFixed(4)}, {route.points[0][1].toFixed(4)}\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <span className=\"w-3 h-3 hard-border bg-toxic-magenta shadow-[0_0_5px_rgba(255,0,255,0.5)]\"></span>\r\n                            <span className=\"text-zinc-400\">\r\n                                {route.points[route.points.length - 1][0].toFixed(4)}, {route.points[route.points.length - 1][1].toFixed(4)}\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </motion.div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\conquest\\detail\\RouteMapView.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":3,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":28},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":21,"column":23,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":21,"endColumn":41}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø\"use client\";\r\n\r\nimport { useEffect, useMemo } from \"react\";\r\nimport { MapContainer, TileLayer, Polyline, CircleMarker, useMap } from \"react-leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport type { LatLngBounds } from \"leaflet\";\r\n\r\ntype LatLng = [number, number];\r\n\r\ninterface RouteMapViewProps {\r\n    points: LatLng[];\r\n    routeGeometry?: LatLng[];\r\n}\r\n\r\n// Fit map to route bounds\r\nfunction FitBounds({ points }: { points: LatLng[] }) {\r\n    const map = useMap();\r\n\r\n    useEffect(() => {\r\n        if (points.length > 0) {\r\n            const L = require(\"leaflet\");\r\n            const bounds: LatLngBounds = L.latLngBounds(points);\r\n            map.fitBounds(bounds, { padding: [50, 50] });\r\n        }\r\n    }, [map, points]);\r\n\r\n    return null;\r\n}\r\n\r\nexport default function RouteMapView({ points, routeGeometry }: RouteMapViewProps) {\r\n    const defaultCenter: LatLng = points.length > 0 ? points[0] : [46.2276, 2.2137];\r\n    const linePoints = routeGeometry && routeGeometry.length > 0 ? routeGeometry : points;\r\n\r\n    return (\r\n        <MapContainer\r\n            center={defaultCenter}\r\n            zoom={12}\r\n            className=\"w-full h-full\"\r\n            style={{ background: \"#0a0a0a\" }}\r\n            zoomControl={false}\r\n        >\r\n            <TileLayer\r\n                attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>'\r\n                url=\"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png\"\r\n            />\r\n\r\n            <FitBounds points={linePoints} />\r\n\r\n            {/* Glow effect */}\r\n            {linePoints.length >= 2 && (\r\n                <Polyline\r\n                    positions={linePoints}\r\n                    pathOptions={{\r\n                        color: \"#facc15\",\r\n                        weight: 16,\r\n                        opacity: 0.2,\r\n                        lineCap: \"round\",\r\n                        lineJoin: \"round\",\r\n                    }}\r\n                />\r\n            )}\r\n\r\n            {/* Main route line */}\r\n            {linePoints.length >= 2 && (\r\n                <Polyline\r\n                    positions={linePoints}\r\n                    pathOptions={{\r\n                        color: \"#facc15\",\r\n                        weight: 5,\r\n                        opacity: 0.95,\r\n                        lineCap: \"round\",\r\n                        lineJoin: \"round\",\r\n                    }}\r\n                />\r\n            )}\r\n\r\n            {/* Waypoint markers */}\r\n            {points.map((point, index) => (\r\n                <CircleMarker\r\n                    key={`glow-${index}`}\r\n                    center={point}\r\n                    radius={index === 0 ? 20 : index === points.length - 1 ? 20 : 12}\r\n                    pathOptions={{\r\n                        color: index === 0 ? \"#22c55e\" : index === points.length - 1 ? \"#ef4444\" : \"#facc15\",\r\n                        fillColor: \"transparent\",\r\n                        fillOpacity: 0,\r\n                        weight: 3,\r\n                        opacity: 0.3,\r\n                    }}\r\n                />\r\n            ))}\r\n\r\n            {points.map((point, index) => (\r\n                <CircleMarker\r\n                    key={index}\r\n                    center={point}\r\n                    radius={index === 0 ? 12 : index === points.length - 1 ? 12 : 7}\r\n                    pathOptions={{\r\n                        color: index === 0 ? \"#22c55e\" : index === points.length - 1 ? \"#ef4444\" : \"#facc15\",\r\n                        fillColor: index === 0 ? \"#22c55e\" : index === points.length - 1 ? \"#ef4444\" : \"#facc15\",\r\n                        fillOpacity: 0.9,\r\n                        weight: 3,\r\n                    }}\r\n                />\r\n            ))}\r\n        </MapContainer>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\conquest\\detail\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\conquest\\page.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\conquest\\page.tsx:24:19\n  22 |         const saved = localStorage.getItem(STORAGE_KEY);\n  23 |         if (saved) {\n> 24 |             try { setRoutes(JSON.parse(saved)); } catch { }\n     |                   ^^^^^^^^^ Avoid calling setState() directly within an effect\n  25 |         }\n  26 |     }, []);\n  27 |","line":24,"column":19,"nodeType":null,"endLine":24,"endColumn":28}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { Plus, MapPin, Ruler, Trash2, Calendar, Route } from \"lucide-react\";\r\nimport { motion } from \"framer-motion\";\r\n\r\ntype RouteData = {\r\n    id: string;\r\n    name: string;\r\n    points: [number, number][];\r\n    distance: number;\r\n    createdAt: string;\r\n};\r\n\r\nconst STORAGE_KEY = \"projectd_routes\";\r\n\r\nexport default function ConquestPage() {\r\n    const [routes, setRoutes] = useState<RouteData[]>([]);\r\n\r\n    useEffect(() => {\r\n        const saved = localStorage.getItem(STORAGE_KEY);\r\n        if (saved) {\r\n            try { setRoutes(JSON.parse(saved)); } catch { }\r\n        }\r\n    }, []);\r\n\r\n    const deleteRoute = (id: string) => {\r\n        const updated = routes.filter(r => r.id !== id);\r\n        setRoutes(updated);\r\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(updated));\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-black text-zinc-100 p-8 font-pixel\">\r\n\r\n            {/* HEADER */}\r\n            <header className=\"mb-12 border-b-2 border-zinc-800 pb-4\">\r\n                <h1 className=\"text-4xl font-bold italic tracking-tighter text-toxic-magenta glitch-hover text-shadow-neon\">\r\n                    PROJECT D // CONQUEST\r\n                </h1>\r\n                <p className=\"text-zinc-500 mt-2 font-bold tracking-widest\">MES TRAC√âS PERSONNALIS√âS</p>\r\n            </header>\r\n\r\n            {/* CREATE NEW BUTTON */}\r\n            <Link\r\n                href=\"/conquest/builder\"\r\n                className=\"inline-flex items-center gap-3 bg-toxic-green text-black hover:bg-white px-6 py-3 font-bold transition-colors mb-8 hard-border shadow-[0_0_15px_rgba(0,255,65,0.4)] uppercase\"\r\n            >\r\n                <Plus size={20} />\r\n                CR√âER UN NOUVEAU TRAC√â\r\n            </Link>\r\n\r\n            {/* ROUTES GRID */}\r\n            {routes.length === 0 ? (\r\n                <div className=\"bg-zinc-950/50 border-2 border-dashed border-zinc-800 p-12 text-center hard-border\">\r\n                    <Route size={48} className=\"mx-auto mb-4 text-zinc-700\" />\r\n                    <p className=\"text-zinc-500 font-bold uppercase tracking-widest mt-2\">Aucun trac√© enregistr√©.</p>\r\n                    <p className=\"text-zinc-600 text-sm mt-2 font-bold\">Utilise le Route Builder pour cr√©er ton premier circuit !</p>\r\n                </div>\r\n            ) : (\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                    {routes.map((route, index) => (\r\n                        <motion.div\r\n                            key={route.id}\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            transition={{ delay: index * 0.1 }}\r\n                            className=\"bg-zinc-950 border-2 border-zinc-800 hover:border-toxic-cyan transition-colors group hard-border\"\r\n                        >\r\n                            {/* Clickable preview area */}\r\n                            <Link href={`/conquest/detail?id=${route.id}`} className=\"block\">\r\n                                {/* Mini Map Preview Placeholder */}\r\n                                <div className=\"h-32 bg-black border-b-2 border-zinc-800 relative overflow-hidden cursor-pointer\">\r\n                                    <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                                        <Route size={32} className=\"text-zinc-800 group-hover:text-toxic-cyan transition-colors\" />\r\n                                    </div>\r\n                                    {/* Simple path visualization */}\r\n                                    <svg className=\"absolute inset-0 w-full h-full\">\r\n                                        <polyline\r\n                                            fill=\"none\"\r\n                                            stroke=\"#00ffff\"\r\n                                            strokeWidth=\"2\"\r\n                                            strokeOpacity=\"0.6\"\r\n                                            points={route.points.slice(0, 20).map((p, i) => {\r\n                                                const x = 20 + (i * 12);\r\n                                                const y = 60 + Math.sin(i * 0.5) * 20;\r\n                                                return `${x},${y}`;\r\n                                            }).join(\" \")}\r\n                                        />\r\n                                    </svg>\r\n                                    <div className=\"absolute inset-0 bg-toxic-cyan/0 group-hover:bg-toxic-cyan/10 transition-colors flex items-center justify-center\">\r\n                                        <span className=\"opacity-0 group-hover:opacity-100 text-toxic-cyan text-sm font-bold transition-opacity tracking-widest uppercase\">\r\n                                            VOIR LE TRAC√â ‚Üí\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n                            </Link>\r\n\r\n                            <div className=\"p-4\">\r\n                                <Link href={`/conquest/detail?id=${route.id}`}>\r\n                                    <h3 className=\"text-2xl font-bold text-white mb-2 hover:text-toxic-cyan transition-colors cursor-pointer uppercase tracking-wider\">\r\n                                        {route.name}\r\n                                    </h3>\r\n                                </Link>\r\n\r\n                                <div className=\"flex items-center gap-4 text-xs font-bold text-zinc-500 mb-4 tracking-widest uppercase\">\r\n                                    <div className=\"flex items-center gap-1\">\r\n                                        <MapPin size={12} className=\"text-toxic-magenta\" />\r\n                                        {route.points.length} pts\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-1\">\r\n                                        <Ruler size={12} className=\"text-toxic-cyan\" />\r\n                                        {route.distance.toFixed(2)} km\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-1\">\r\n                                        <Calendar size={12} className=\"text-toxic-yellow\" />\r\n                                        {route.createdAt}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"flex gap-2 font-bold tracking-widest uppercase text-sm\">\r\n                                    <Link\r\n                                        href={`/conquest/detail?id=${route.id}`}\r\n                                        className=\"flex-1 bg-toxic-cyan text-black hover:bg-white text-center py-2 transition-colors hard-border shadow-[0_0_10px_rgba(0,255,255,0.2)]\"\r\n                                    >\r\n                                        VOIR\r\n                                    </Link>\r\n                                    <button\r\n                                        onClick={() => deleteRoute(route.id)}\r\n                                        className=\"bg-black border-2 border-red-500 text-red-500 hover:bg-red-500 hover:text-black px-4 transition-colors hard-border shadow-[0_0_10px_rgba(239,68,68,0.2)]\"\r\n                                    >\r\n                                        <Trash2 size={16} />\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </motion.div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\garage\\page.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\garage\\page.tsx:53:19\n  51 |\n  52 |         if (savedGear) {\n> 53 |             try { setGearList(JSON.parse(savedGear)); } catch { }\n     |                   ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  54 |         }\n  55 |         if (savedSpecs) {\n  56 |             try { setCarSpecs(JSON.parse(savedSpecs)); } catch { }","line":53,"column":19,"nodeType":null,"endLine":53,"endColumn":30},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":163,"column":59,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[6347,6396],"text":" AJOUTER √Ä L&apos;INVENTAIRE\r\n                        "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[6347,6396],"text":" AJOUTER √Ä L&lsquo;INVENTAIRE\r\n                        "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[6347,6396],"text":" AJOUTER √Ä L&#39;INVENTAIRE\r\n                        "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[6347,6396],"text":" AJOUTER √Ä L&rsquo;INVENTAIRE\r\n                        "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"jsx-a11y/alt-text","severity":1,"message":"Image elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","line":250,"column":33,"nodeType":"JSXOpeningElement","endLine":250,"endColumn":92},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":297,"column":45,"nodeType":"JSXOpeningElement","endLine":304,"endColumn":47}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { Plus, Trash2, Car, Shirt, Image, Link2, Gamepad2, ExternalLink, Gauge } from \"lucide-react\";\r\nimport { motion } from \"framer-motion\";\r\n\r\n// --- TYPES ---\r\ntype GearItem = {\r\n    id: string;\r\n    category: string;\r\n    name: string;\r\n};\r\n\r\ntype CarSpec = {\r\n    id: string;\r\n    category: \"REAL\" | \"SIM-RACING\";\r\n    part: string;\r\n    value: string;\r\n    imageUrl?: string;\r\n    link?: string;\r\n};\r\n\r\n// --- CL√âS LOCALSTORAGE ---\r\nconst STORAGE_KEYS = {\r\n    GEAR: \"projectd_gear\",\r\n    CAR_SPECS: \"projectd_carspecs\",\r\n};\r\n\r\nexport default function GaragePage() {\r\n    // --- √âTATS (STATE) ---\r\n    const [gearList, setGearList] = useState<GearItem[]>([]);\r\n    const [carSpecs, setCarSpecs] = useState<CarSpec[]>([]);\r\n    const [activeCarTab, setActiveCarTab] = useState<\"REAL\" | \"SIM-RACING\">(\"REAL\");\r\n    const [isLoaded, setIsLoaded] = useState(false);\r\n\r\n    // Pour les formulaires d'ajout\r\n    const [newGear, setNewGear] = useState({ category: \"\", name: \"\" });\r\n    const [newSpec, setNewSpec] = useState({\r\n        part: \"\",\r\n        value: \"\",\r\n        imageUrl: \"\",\r\n        link: \"\",\r\n        category: \"REAL\" as \"REAL\" | \"SIM-RACING\"\r\n    });\r\n\r\n    // --- CHARGEMENT INITIAL DEPUIS LOCALSTORAGE ---\r\n    useEffect(() => {\r\n        const savedGear = localStorage.getItem(STORAGE_KEYS.GEAR);\r\n        const savedSpecs = localStorage.getItem(STORAGE_KEYS.CAR_SPECS);\r\n\r\n        if (savedGear) {\r\n            try { setGearList(JSON.parse(savedGear)); } catch { }\r\n        }\r\n        if (savedSpecs) {\r\n            try { setCarSpecs(JSON.parse(savedSpecs)); } catch { }\r\n        }\r\n        setIsLoaded(true);\r\n    }, []);\r\n\r\n    // --- SAUVEGARDE AUTOMATIQUE ---\r\n    useEffect(() => {\r\n        if (isLoaded) {\r\n            localStorage.setItem(STORAGE_KEYS.GEAR, JSON.stringify(gearList));\r\n        }\r\n    }, [gearList, isLoaded]);\r\n\r\n    useEffect(() => {\r\n        if (isLoaded) {\r\n            localStorage.setItem(STORAGE_KEYS.CAR_SPECS, JSON.stringify(carSpecs));\r\n        }\r\n    }, [carSpecs, isLoaded]);\r\n\r\n    // --- FONCTIONS ---\r\n\r\n    // Ajouter un v√™tement\r\n    const addGear = () => {\r\n        if (!newGear.category || !newGear.name) return;\r\n        const item: GearItem = {\r\n            id: Date.now().toString(),\r\n            category: newGear.category,\r\n            name: newGear.name,\r\n        };\r\n        setGearList([...gearList, item]);\r\n        setNewGear({ category: \"\", name: \"\" });\r\n    };\r\n\r\n    // Supprimer un v√™tement\r\n    const removeGear = (id: string) => {\r\n        setGearList(gearList.filter((item) => item.id !== id));\r\n    };\r\n\r\n    // Ajouter une pi√®ce auto\r\n    const addSpec = () => {\r\n        if (!newSpec.part || !newSpec.value) return;\r\n        const spec: CarSpec = {\r\n            id: Date.now().toString(),\r\n            category: activeCarTab,\r\n            part: newSpec.part,\r\n            value: newSpec.value,\r\n            imageUrl: newSpec.imageUrl || undefined,\r\n            link: newSpec.link || undefined,\r\n        };\r\n        setCarSpecs([...carSpecs, spec]);\r\n        setNewSpec({ part: \"\", value: \"\", imageUrl: \"\", link: \"\", category: activeCarTab });\r\n    };\r\n\r\n    // Filtrer les specs par cat√©gorie\r\n    const filteredSpecs = carSpecs.filter(spec => spec.category === activeCarTab);\r\n\r\n    // --- RENDU VISUEL (JSX) ---\r\n    return (\r\n        <div className=\"min-h-screen bg-black text-zinc-100 p-8 font-pixel\">\r\n\r\n            {/* HEADER */}\r\n            <header className=\"mb-8 border-b-2 border-zinc-800 pb-4\">\r\n                <h1 className=\"text-4xl font-bold italic tracking-tighter text-toxic-cyan glitch-hover\">\r\n                    PROJECT D // GARAGE\r\n                </h1>\r\n                <p className=\"text-zinc-500 mt-2 font-bold tracking-widest\">CONFIGURATION PILOTE & MACHINE</p>\r\n            </header>\r\n\r\n            {/* CARS LINK */}\r\n            <Link\r\n                href=\"/cars\"\r\n                className=\"inline-flex items-center gap-3 bg-toxic-cyan text-black hover:bg-white px-6 py-3 font-bold transition-colors mb-8 hard-border shadow-[0_0_15px_rgba(0,255,255,0.4)]\"\r\n            >\r\n                <Gauge size={20} />\r\n                ACCESS PARKING AREA\r\n            </Link>\r\n\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-12\">\r\n\r\n                {/* SECTION 1 : DRIVER LOADOUT */}\r\n                <section>\r\n                    <div className=\"flex items-center gap-2 mb-6 border-b-2 border-zinc-800 pb-2\">\r\n                        <Shirt className=\"text-toxic-magenta\" />\r\n                        <h2 className=\"text-2xl font-bold text-white\">DRIVER LOADOUT</h2>\r\n                    </div>\r\n\r\n                    {/* Formulaire d'ajout */}\r\n                    <div className=\"bg-zinc-950 p-4 border-2 border-zinc-800 mb-6 hard-border\">\r\n                        <div className=\"grid grid-cols-2 gap-4 mb-4\">\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Cat√©gorie (ex: Haut)\"\r\n                                className=\"bg-black border-2 border-zinc-700 p-2 text-sm focus:border-toxic-magenta outline-none hard-border text-white placeholder-zinc-600\"\r\n                                value={newGear.category}\r\n                                onChange={(e) => setNewGear({ ...newGear, category: e.target.value })}\r\n                            />\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Item (ex: Pull Satyn)\"\r\n                                className=\"bg-black border-2 border-zinc-700 p-2 text-sm focus:border-toxic-magenta outline-none hard-border text-white placeholder-zinc-600\"\r\n                                value={newGear.name}\r\n                                onChange={(e) => setNewGear({ ...newGear, name: e.target.value })}\r\n                            />\r\n                        </div>\r\n                        <button\r\n                            onClick={addGear}\r\n                            className=\"w-full bg-zinc-800 text-white hover:bg-toxic-magenta hover:text-black transition-colors py-2 text-sm font-bold flex items-center justify-center gap-2 hard-border\"\r\n                        >\r\n                            <Plus size={16} /> AJOUTER √Ä L'INVENTAIRE\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Liste des items */}\r\n                    <div className=\"space-y-2\">\r\n                        {gearList.length === 0 && (\r\n                            <p className=\"text-zinc-600 text-sm font-bold bg-zinc-950 p-4 border border-zinc-800 text-center\">DATA NOT FOUND...</p>\r\n                        )}\r\n\r\n                        {gearList.map((item) => (\r\n                            <motion.div\r\n                                initial={{ opacity: 0, x: -20 }}\r\n                                animate={{ opacity: 1, x: 0 }}\r\n                                key={item.id}\r\n                                className=\"flex justify-between items-center bg-zinc-950 p-3 border-l-4 border-zinc-800 hover:border-toxic-magenta transition-colors group hard-border\"\r\n                            >\r\n                                <div>\r\n                                    <span className=\"text-toxic-magenta text-xs font-bold uppercase block tracking-wider\">\r\n                                        {item.category}\r\n                                    </span>\r\n                                    <span className=\"text-white font-bold text-lg uppercase\">\r\n                                        {item.name}\r\n                                    </span>\r\n                                </div>\r\n                                <button\r\n                                    onClick={() => removeGear(item.id)}\r\n                                    className=\"text-zinc-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity\"\r\n                                >\r\n                                    <Trash2 size={18} />\r\n                                </button>\r\n                            </motion.div>\r\n                        ))}\r\n                    </div>\r\n                </section>\r\n\r\n                {/* SECTION 2 : CAR SPECS */}\r\n                <section>\r\n                    <div className=\"flex items-center gap-2 mb-6 border-b-2 border-zinc-800 pb-2\">\r\n                        <Car className=\"text-toxic-cyan\" />\r\n                        <h2 className=\"text-2xl font-bold text-white\">MACHINE SPECS</h2>\r\n                    </div>\r\n\r\n                    {/* TABS: REAL / SIM-RACING */}\r\n                    <div className=\"flex gap-2 mb-6\">\r\n                        <button\r\n                            onClick={() => setActiveCarTab(\"REAL\")}\r\n                            className={`flex items-center gap-2 px-6 py-2 text-sm font-bold border-2 transition-all hard-border flex-1 justify-center ${activeCarTab === \"REAL\"\r\n                                ? \"bg-toxic-cyan text-black border-toxic-cyan shadow-[0_0_10px_rgba(0,255,255,0.3)]\"\r\n                                : \"bg-transparent text-zinc-500 border-zinc-800 hover:border-zinc-600\"\r\n                                }`}\r\n                        >\r\n                            <Car size={16} /> REAL\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setActiveCarTab(\"SIM-RACING\")}\r\n                            className={`flex items-center gap-2 px-6 py-2 text-sm font-bold border-2 transition-all hard-border flex-1 justify-center ${activeCarTab === \"SIM-RACING\"\r\n                                ? \"bg-toxic-cyan text-black border-toxic-cyan shadow-[0_0_10px_rgba(0,255,255,0.3)]\"\r\n                                : \"bg-transparent text-zinc-500 border-zinc-800 hover:border-zinc-600\"\r\n                                }`}\r\n                        >\r\n                            <Gamepad2 size={16} /> SIM-RACING\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Formulaire Auto */}\r\n                    <div className=\"bg-zinc-950 p-4 border-2 border-zinc-800 mb-6 hard-border\">\r\n                        <div className=\"grid grid-cols-2 gap-4 mb-4\">\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Pi√®ce (ex: Moteur)\"\r\n                                className=\"bg-black border-2 border-zinc-700 p-2 text-sm focus:border-toxic-cyan outline-none hard-border text-white placeholder-zinc-600\"\r\n                                value={newSpec.part}\r\n                                onChange={(e) => setNewSpec({ ...newSpec, part: e.target.value })}\r\n                            />\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Valeur (ex: 4A-GE)\"\r\n                                className=\"bg-black border-2 border-zinc-700 p-2 text-sm focus:border-toxic-cyan outline-none hard-border text-white placeholder-zinc-600\"\r\n                                value={newSpec.value}\r\n                                onChange={(e) => setNewSpec({ ...newSpec, value: e.target.value })}\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Champs optionnels : Image & Lien */}\r\n                        <div className=\"grid grid-cols-1 gap-4 mb-4\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <Image size={16} className=\"text-zinc-600 flex-shrink-0\" />\r\n                                <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"URL de l'image (optionnel)\"\r\n                                    className=\"bg-black border-2 border-zinc-700 p-2 text-sm focus:border-toxic-cyan outline-none hard-border text-white placeholder-zinc-600 w-full\"\r\n                                    value={newSpec.imageUrl}\r\n                                    onChange={(e) => setNewSpec({ ...newSpec, imageUrl: e.target.value })}\r\n                                />\r\n                            </div>\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <Link2 size={16} className=\"text-zinc-600 flex-shrink-0\" />\r\n                                <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"Lien externe (optionnel)\"\r\n                                    className=\"bg-black border-2 border-zinc-700 p-2 text-sm focus:border-toxic-cyan outline-none hard-border text-white placeholder-zinc-600 w-full\"\r\n                                    value={newSpec.link}\r\n                                    onChange={(e) => setNewSpec({ ...newSpec, link: e.target.value })}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <button\r\n                            onClick={addSpec}\r\n                            className=\"w-full bg-zinc-800 text-white hover:bg-toxic-cyan hover:text-black transition-colors py-2 text-sm font-bold flex items-center justify-center gap-2 hard-border\"\r\n                        >\r\n                            <Plus size={16} /> {activeCarTab === \"SIM-RACING\" ? \"INSTALL SOFTWARE\" : \"INSTALL HARDWARE\"}\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Liste des Specs */}\r\n                    <div className=\"border-[1px] border-zinc-800 bg-zinc-950 hard-border p-2\">\r\n                        {filteredSpecs.length === 0 && (\r\n                            <p className=\"text-zinc-600 text-sm font-bold text-center py-4\">\r\n                                {activeCarTab === \"SIM-RACING\" ? \"NO SOFTWARE INSTALLED...\" : \"NO HARDWARE INSTALLED...\"}\r\n                            </p>\r\n                        )}\r\n                        {filteredSpecs.map((spec, index) => (\r\n                            <motion.div\r\n                                initial={{ opacity: 0, y: 10 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                key={spec.id}\r\n                                className={`p-4 border-b border-zinc-900 ${index % 2 === 0 ? 'bg-black' : 'bg-[#050505]'} hover:border-toxic-cyan transition-colors group`}\r\n                            >\r\n                                <div className=\"flex justify-between items-start gap-4\">\r\n                                    {/* Image si pr√©sente */}\r\n                                    {spec.imageUrl && (\r\n                                        <div className=\"w-16 h-16 flex-shrink-0 bg-black border border-zinc-800 hard-border overflow-hidden\">\r\n                                            <img\r\n                                                src={spec.imageUrl}\r\n                                                alt={spec.part}\r\n                                                className=\"w-full h-full object-cover opacity-80 group-hover:opacity-100 grayscale group-hover:grayscale-0 transition-all\"\r\n                                                onError={(e) => {\r\n                                                    (e.target as HTMLImageElement).style.display = 'none';\r\n                                                }}\r\n                                            />\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {/* Infos */}\r\n                                    <div className=\"flex-1\">\r\n                                        <span className=\"text-zinc-500 text-xs font-bold uppercase tracking-widest block\">{spec.part}</span>\r\n                                        <span className=\"text-toxic-cyan font-bold text-xl uppercase\">{spec.value}</span>\r\n\r\n                                        {/* Lien si pr√©sent */}\r\n                                        {spec.link && (\r\n                                            <a\r\n                                                href={spec.link}\r\n                                                target=\"_blank\"\r\n                                                rel=\"noopener noreferrer\"\r\n                                                className=\"flex items-center gap-1 text-xs font-bold text-zinc-600 hover:text-toxic-cyan mt-1 transition-colors uppercase\"\r\n                                            >\r\n                                                <ExternalLink size={12} />\r\n                                                READ DATA\r\n                                            </a>\r\n                                        )}\r\n                                    </div>\r\n\r\n                                    {/* Delete */}\r\n                                    <button\r\n                                        onClick={() => setCarSpecs(carSpecs.filter(s => s.id !== spec.id))}\r\n                                        className=\"text-zinc-700 hover:text-red-500 transition-colors\"\r\n                                    >\r\n                                        <Trash2 size={14} />\r\n                                    </button>\r\n                                </div>\r\n                            </motion.div>\r\n                        ))}\r\n                    </div>\r\n                </section>\r\n\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\ghosts\\detail\\GhostDetailClient.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Timer' is defined but never used.","line":9,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Cloud' is defined but never used.","line":9,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":29,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":17},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\ghosts\\detail\\GhostDetailClient.tsx:44:24\n  42 |             const ghosts: GhostRun[] = JSON.parse(savedGhosts);\n  43 |             const found = ghosts.find(g => g.id === id);\n> 44 |             if (found) setGhost(found);\n     |                        ^^^^^^^^ Avoid calling setState() directly within an effect\n  45 |         }\n  46 |     }, [id]);\n  47 |","line":44,"column":24,"nodeType":null,"endLine":44,"endColumn":32},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\ghosts\\detail\\GhostDetailClient.tsx:53:17\n  51 |             const points = ghost.points;\n  52 |             if (currentIndex >= points.length - 1) {\n> 53 |                 setIsPlaying(false);\n     |                 ^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  54 |                 return;\n  55 |             }\n  56 |","line":53,"column":17,"nodeType":null,"endLine":53,"endColumn":29}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"Ôªø\"use client\";\r\n\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport dynamic from \"next/dynamic\";\r\nimport Link from \"next/link\";\r\nimport {\r\n    ArrowLeft, Play, Pause, RotateCcw, Car as CarIcon,\r\n    MapPin, Timer, Gauge, Trophy, Cloud\r\n} from \"lucide-react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { GhostRun, WEATHER_INFO, LatLng } from \"../../lib/types\";\r\n\r\n// Dynamic map import\r\nconst GhostReplayMap = dynamic(() => import(\"./GhostReplayMap\"), {\r\n    ssr: false,\r\n    loading: () => (\r\n        <div className=\"w-full h-full bg-black flex items-center justify-center font-pixel\">\r\n            <div className=\"text-toxic-cyan text-xl animate-pulse glitch-hover\">LOADING REPLAY...</div>\r\n        </div>\r\n    )\r\n});\r\n\r\ninterface GhostDetailClientProps {\r\n    id: string;\r\n}\r\n\r\nexport default function GhostDetailClient({ id }: GhostDetailClientProps) {\r\n    const router = useRouter();\r\n    const [ghost, setGhost] = useState<GhostRun | null>(null);\r\n\r\n    // Replay state\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [currentIndex, setCurrentIndex] = useState(0);\r\n    const [playbackSpeed, setPlaybackSpeed] = useState(1);\r\n    const animationRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n    // Load ghost\r\n    useEffect(() => {\r\n        const savedGhosts = localStorage.getItem(\"projectd_ghosts\");\r\n        if (savedGhosts) {\r\n            const ghosts: GhostRun[] = JSON.parse(savedGhosts);\r\n            const found = ghosts.find(g => g.id === id);\r\n            if (found) setGhost(found);\r\n        }\r\n    }, [id]);\r\n\r\n    // Playback animation\r\n    useEffect(() => {\r\n        if (isPlaying && ghost) {\r\n            const points = ghost.points;\r\n            if (currentIndex >= points.length - 1) {\r\n                setIsPlaying(false);\r\n                return;\r\n            }\r\n\r\n            const currentPoint = points[currentIndex];\r\n            const nextPoint = points[currentIndex + 1];\r\n            const timeDiff = (nextPoint.timestamp - currentPoint.timestamp) / playbackSpeed;\r\n\r\n            animationRef.current = setTimeout(() => {\r\n                setCurrentIndex(prev => prev + 1);\r\n            }, Math.max(timeDiff, 50)); // Min 50ms between updates\r\n        }\r\n\r\n        return () => {\r\n            if (animationRef.current) clearTimeout(animationRef.current);\r\n        };\r\n    }, [isPlaying, currentIndex, ghost, playbackSpeed]);\r\n\r\n    const formatTime = (ms: number): string => {\r\n        const minutes = Math.floor(ms / 60000);\r\n        const seconds = Math.floor((ms % 60000) / 1000);\r\n        const milliseconds = Math.floor((ms % 1000) / 10);\r\n        return `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}.${milliseconds.toString().padStart(2, '0')}`;\r\n    };\r\n\r\n    const togglePlay = () => {\r\n        if (currentIndex >= (ghost?.points.length || 1) - 1) {\r\n            setCurrentIndex(0);\r\n        }\r\n        setIsPlaying(!isPlaying);\r\n    };\r\n\r\n    const restart = () => {\r\n        setCurrentIndex(0);\r\n        setIsPlaying(false);\r\n    };\r\n\r\n    if (!ghost) {\r\n        return (\r\n            <div className=\"min-h-screen bg-black text-red-500 flex items-center justify-center font-pixel uppercase tracking-widest text-xl\">\r\n                <div className=\"animate-pulse\">Ghost introuvable...</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const currentPoint = ghost.points[currentIndex];\r\n    const currentPosition: LatLng = [currentPoint.lat, currentPoint.lng];\r\n    const ghostPath: LatLng[] = ghost.points.slice(0, currentIndex + 1).map(p => [p.lat, p.lng]);\r\n    const progress = (currentIndex / (ghost.points.length - 1)) * 100;\r\n\r\n    return (\r\n        <div className=\"h-[100dvh] w-full bg-black relative overflow-hidden font-pixel\">\r\n\r\n            {/* Map (full screen) */}\r\n            <div className=\"absolute inset-0 top-24 md:top-24 bottom-32 md:bottom-24\">\r\n                <GhostReplayMap\r\n                    ghostPath={ghostPath}\r\n                    fullPath={ghost.points.map(p => [p.lat, p.lng] as LatLng)}\r\n                    currentPosition={currentPosition}\r\n                />\r\n            </div>\r\n\r\n            {/* HUD - Top Info Bar */}\r\n            <motion.div\r\n                initial={{ y: -50, opacity: 0 }}\r\n                animate={{ y: 0, opacity: 1 }}\r\n                className=\"absolute top-0 left-0 right-0 z-[1000]\"\r\n            >\r\n                <div className=\"bg-black/95 backdrop-blur-md border-b-2 border-zinc-800 p-3 md:p-4 shadow-[0_10px_30px_rgba(0,0,0,0.8)]\">\r\n                    <div className=\"flex flex-col md:flex-row items-start md:items-center justify-between gap-2 md:gap-4 max-w-7xl mx-auto\">\r\n\r\n                        <div className=\"flex items-center gap-3 w-full md:w-auto overflow-hidden\">\r\n                            <Link href=\"/ghosts\" className=\"text-zinc-500 hover:text-toxic-cyan transition-colors border-2 border-transparent hover:border-toxic-cyan p-1 hard-border shrink-0\">\r\n                                <ArrowLeft size={20} />\r\n                            </Link>\r\n                            <div className=\"truncate\">\r\n                                <h1 className=\"text-lg md:text-xl font-bold text-toxic-yellow flex items-center gap-2 uppercase tracking-widest text-shadow-[0_0_10px_rgba(255,255,0,0.4)] glitch-hover\">\r\n                                    <Trophy size={16} />\r\n                                    REPLAY\r\n                                </h1>\r\n                                <div className=\"text-zinc-500 text-[10px] md:text-xs uppercase tracking-widest truncate\">\r\n                                    {ghost.driverName} ‚Ä¢ {ghost.date}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex items-center justify-between w-full md:w-auto gap-4 text-[10px] md:text-xs font-bold tracking-widest uppercase border-t-2 md:border-t-0 border-zinc-800 pt-2 md:pt-0\">\r\n                            <div className=\"flex items-center gap-2 text-toxic-cyan\">\r\n                                <CarIcon size={14} />\r\n                                <span className=\"truncate max-w-[100px] md:max-w-none\">{ghost.carName}</span>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-2 text-toxic-magenta\">\r\n                                <MapPin size={14} />\r\n                                <span className=\"truncate max-w-[100px] md:max-w-none\">{ghost.tougeName}</span>\r\n                            </div>\r\n                            <div className=\"text-lg md:text-2xl\">{WEATHER_INFO[ghost.weather].icon}</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </motion.div>\r\n\r\n            {/* HUD - Data Overlays (Mobile absolute) */}\r\n            <div className=\"absolute top-28 md:top-32 left-4 right-4 flex justify-between pointer-events-none z-[1000]\">\r\n                {/* Timer Display */}\r\n                <div className=\"bg-black/90 backdrop-blur-md border-2 border-toxic-yellow hard-border px-4 py-2 text-center shadow-[0_0_15px_rgba(255,255,0,0.3)] pointer-events-auto\">\r\n                    <div className=\"text-2xl md:text-4xl font-bold text-toxic-yellow text-shadow-[0_0_10px_rgba(255,255,0,0.4)]\">\r\n                        {formatTime(currentPoint.timestamp)}\r\n                    </div>\r\n                    <div className=\"text-zinc-500 text-[10px] md:text-xs mt-1 uppercase tracking-widest\">\r\n                        / {formatTime(ghost.totalTime)}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Speed Display */}\r\n                <div className=\"bg-black/90 backdrop-blur-md border-2 border-zinc-800 hard-border p-2 md:p-4 text-center w-24 md:w-32 shadow-[0_0_15px_rgba(0,0,0,0.8)] pointer-events-auto\">\r\n                    <Gauge size={16} className=\"mx-auto text-toxic-green mb-1\" />\r\n                    <div className=\"text-xl md:text-3xl font-bold text-toxic-green text-shadow-[0_0_10px_rgba(0,255,65,0.4)]\">\r\n                        {(currentPoint.speed || 0).toFixed(0)}\r\n                    </div>\r\n                    <div className=\"text-zinc-500 text-[10px] md:text-xs uppercase tracking-widest\">KM/H</div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* HUD - Stats Panel */}\r\n            <div className=\"absolute top-52 md:top-64 left-4 z-[1000] pointer-events-none hidden md:block\">\r\n                <div className=\"bg-black/90 backdrop-blur-md border-2 border-zinc-800 hard-border p-4 space-y-3 w-40 shadow-[0_0_20px_rgba(0,0,0,0.8)] pointer-events-auto\">\r\n                    <div className=\"text-center font-bold uppercase tracking-widest\">\r\n                        <div className=\"text-xl text-toxic-yellow\">{ghost.maxSpeed.toFixed(0)}</div>\r\n                        <div className=\"text-zinc-600 text-[10px]\">VMAX (KM/H)</div>\r\n                    </div>\r\n                    <div className=\"text-center border-t-2 border-zinc-800 pt-3 font-bold uppercase tracking-widest\">\r\n                        <div className=\"text-xl text-toxic-cyan\">{ghost.avgSpeed.toFixed(0)}</div>\r\n                        <div className=\"text-zinc-600 text-[10px]\">MOY (KM/H)</div>\r\n                    </div>\r\n                    <div className=\"text-center border-t-2 border-zinc-800 pt-3 font-bold uppercase tracking-widest\">\r\n                        <div className=\"text-xl text-toxic-magenta\">{ghost.totalDistance.toFixed(2)}</div>\r\n                        <div className=\"text-zinc-600 text-[10px]\">DISTANCE (KM)</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* HUD - Bottom Controls */}\r\n            <motion.div\r\n                initial={{ y: 50, opacity: 0 }}\r\n                animate={{ y: 0, opacity: 1 }}\r\n                className=\"absolute bottom-4 left-4 right-4 z-[1000]\"\r\n            >\r\n                <div className=\"bg-black/95 backdrop-blur-xl border-2 border-zinc-800 hard-border p-4 shadow-[0_10px_30px_rgba(0,0,0,0.8)] max-w-2xl mx-auto\">\r\n\r\n                    {/* Progress bar */}\r\n                    <div className=\"w-full mb-4 md:mb-6\">\r\n                        <div className=\"h-4 bg-zinc-900 hard-border border border-zinc-800 overflow-hidden relative\">\r\n                            <div\r\n                                className=\"h-full bg-toxic-yellow transition-all duration-100 shadow-[0_0_10px_rgba(255,255,0,0.8)] relative\"\r\n                                style={{ width: `${progress}%` }}\r\n                            >\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Controls Row */}\r\n                    <div className=\"flex flex-col md:flex-row items-center justify-between gap-4\">\r\n\r\n                        <div className=\"flex items-center gap-4 w-full md:w-auto\">\r\n                            <button\r\n                                onClick={restart}\r\n                                className=\"flex-1 md:flex-none p-3 md:p-4 bg-black border-2 border-zinc-800 text-zinc-500 hover:text-white hover:border-white hard-border transition-colors flex justify-center items-center\"\r\n                            >\r\n                                <RotateCcw size={20} />\r\n                            </button>\r\n\r\n                            <button\r\n                                onClick={togglePlay}\r\n                                className=\"flex-[2] md:flex-none p-3 md:p-4 bg-toxic-yellow border-2 border-toxic-yellow text-black hover:bg-white hover:text-black hover:border-white hard-border transition-colors shadow-[0_0_15px_rgba(255,255,0,0.4)] glitch-hover flex justify-center items-center gap-2 font-bold uppercase tracking-widest\"\r\n                            >\r\n                                {isPlaying ? (\r\n                                    <><Pause size={24} /> <span className=\"hidden md:inline\">PAUSE</span></>\r\n                                ) : (\r\n                                    <><Play size={24} /> <span className=\"hidden md:inline\">PLAY</span></>\r\n                                )}\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* Speed selector */}\r\n                        <div className=\"flex w-full md:w-auto border-2 border-zinc-800 hard-border\">\r\n                            {[0.5, 1, 2, 4].map((speed, i) => (\r\n                                <button\r\n                                    key={speed}\r\n                                    onClick={() => setPlaybackSpeed(speed)}\r\n                                    className={`flex-1 md:w-16 py-2 md:py-3 text-[10px] md:text-xs uppercase tracking-widest font-bold transition-colors ${i < 3 ? 'border-r-2 border-zinc-800' : ''} ${playbackSpeed === speed\r\n                                        ? \"bg-toxic-cyan text-black shadow-[0_0_10px_rgba(0,255,255,0.4)]\"\r\n                                        : \"bg-black text-zinc-500 hover:text-white hover:bg-zinc-900\"\r\n                                        }`}\r\n                                >\r\n                                    {speed}X\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n            </motion.div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\ghosts\\detail\\GhostReplayMap.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\ghosts\\detail\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\ghosts\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Timer' is defined but never used.","line":6,"column":48,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":53},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Gauge' is defined but never used.","line":7,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Cloud' is defined but never used.","line":7,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":37},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\ghosts\\page.tsx:22:17\n  20 |                 const parsed = JSON.parse(saved);\n  21 |                 // Sort by date (newest first)\n> 22 |                 setGhosts(parsed.sort((a: GhostRun, b: GhostRun) =>\n     |                 ^^^^^^^^^ Avoid calling setState() directly within an effect\n  23 |                     new Date(b.date).getTime() - new Date(a.date).getTime()\n  24 |                 ));\n  25 |             } catch { }","line":22,"column":17,"nodeType":null,"endLine":22,"endColumn":26},{"ruleId":"react/jsx-no-comment-textnodes","severity":2,"message":"Comments inside children section of tag should be placed inside braces","line":106,"column":103,"nodeType":"JSXText","messageId":"putCommentInBraces","endLine":107,"endColumn":40}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport {\r\n    ArrowLeft, Trophy, Car as CarIcon, MapPin, Timer,\r\n    Gauge, Play, Trash2, Plus, Cloud\r\n} from \"lucide-react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { GhostRun, WEATHER_INFO } from \"../lib/types\";\r\n\r\nexport default function GhostsPage() {\r\n    const [ghosts, setGhosts] = useState<GhostRun[]>([]);\r\n\r\n    // Load ghosts\r\n    useEffect(() => {\r\n        const saved = localStorage.getItem(\"projectd_ghosts\");\r\n        if (saved) {\r\n            try {\r\n                const parsed = JSON.parse(saved);\r\n                // Sort by date (newest first)\r\n                setGhosts(parsed.sort((a: GhostRun, b: GhostRun) =>\r\n                    new Date(b.date).getTime() - new Date(a.date).getTime()\r\n                ));\r\n            } catch { }\r\n        }\r\n    }, []);\r\n\r\n    const formatTime = (ms: number): string => {\r\n        const minutes = Math.floor(ms / 60000);\r\n        const seconds = Math.floor((ms % 60000) / 1000);\r\n        const milliseconds = Math.floor((ms % 1000) / 10);\r\n        return `${minutes}:${seconds.toString().padStart(2, '0')}.${milliseconds.toString().padStart(2, '0')}`;\r\n    };\r\n\r\n    const deleteGhost = (id: string) => {\r\n        const updated = ghosts.filter(g => g.id !== id);\r\n        setGhosts(updated);\r\n        localStorage.setItem(\"projectd_ghosts\", JSON.stringify(updated));\r\n    };\r\n\r\n    // Group by touge\r\n    const groupedByTouge = ghosts.reduce((acc, ghost) => {\r\n        if (!acc[ghost.tougeName]) {\r\n            acc[ghost.tougeName] = [];\r\n        }\r\n        acc[ghost.tougeName].push(ghost);\r\n        return acc;\r\n    }, {} as Record<string, GhostRun[]>);\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-black text-white p-4 md:p-8 font-pixel\">\r\n\r\n            {/* Header */}\r\n            <header className=\"mb-8 border-b-2 border-zinc-800 pb-4\">\r\n                <Link href=\"/\" className=\"inline-flex text-zinc-500 hover:text-toxic-cyan text-sm items-center gap-2 mb-4 uppercase tracking-widest hard-border px-3 py-1 border-2 border-transparent hover:border-toxic-cyan transition-colors\">\r\n                    <ArrowLeft size={14} /> Accueil\r\n                </Link>\r\n                <h1 className=\"text-3xl md:text-5xl font-bold uppercase tracking-widest text-toxic-yellow flex items-center gap-3 text-shadow-[0_0_15px_rgba(255,255,0,0.5)] glitch-hover\">\r\n                    <Trophy size={36} className=\"md:w-12 md:h-12\" />\r\n                    GHOSTS\r\n                </h1>\r\n                <p className=\"text-zinc-500 mt-2 uppercase tracking-widest text-xs\">Tes runs enregistr√©s et leurs temps</p>\r\n            </header>\r\n\r\n            {/* Menu Actions */}\r\n            <div className=\"flex flex-col md:flex-row gap-4 mb-8\">\r\n                <Link\r\n                    href=\"/run\"\r\n                    className=\"flex-1 md:flex-none flex items-center justify-center gap-2 bg-toxic-green text-black border-2 border-toxic-green px-8 py-4 font-bold hover:bg-white hover:border-white transition-colors hard-border uppercase tracking-widest shadow-[0_0_15px_rgba(0,255,65,0.4)] glitch-hover\"\r\n                >\r\n                    <Plus size={18} />\r\n                    NOUVEAU RUN\r\n                </Link>\r\n                <Link\r\n                    href=\"/conquest\"\r\n                    className=\"flex-1 md:flex-none flex items-center justify-center gap-2 bg-black text-zinc-400 border-2 border-zinc-800 px-8 py-4 font-bold hover:text-toxic-cyan hover:border-toxic-cyan transition-colors hard-border uppercase tracking-widest\"\r\n                >\r\n                    <MapPin size={18} />\r\n                    VOIR MAP OUT√âTERRE\r\n                </Link>\r\n            </div>\r\n\r\n            {/* Empty State */}\r\n            {ghosts.length === 0 ? (\r\n                <div className=\"text-center py-16 border-2 border-dashed border-zinc-800 hard-border\">\r\n                    <Trophy size={48} className=\"mx-auto text-zinc-700 mb-4\" />\r\n                    <h2 className=\"text-xl md:text-2xl font-bold uppercase tracking-widest text-zinc-500 mb-2\">AUCUN GHOST ENREGISTR√â</h2>\r\n                    <p className=\"text-zinc-600 mb-6 uppercase text-xs tracking-widest border-b-2 border-zinc-800 pb-6 max-w-xs mx-auto\">Lance ton premier run pour cr√©er un ghost !</p>\r\n                    <Link\r\n                        href=\"/run\"\r\n                        className=\"inline-flex items-center justify-center gap-2 bg-toxic-green text-black border-2 border-toxic-green px-6 py-3 font-bold hover:bg-white hover:border-white transition-colors hard-border uppercase tracking-widest shadow-[0_0_15px_rgba(0,255,65,0.4)] glitch-hover mt-4\"\r\n                    >\r\n                        <Play size={18} />\r\n                        LANCER UN RUN\r\n                    </Link>\r\n                </div>\r\n            ) : (\r\n                <div className=\"space-y-12\">\r\n                    {Object.entries(groupedByTouge).map(([tougeName, tougeGhosts]) => (\r\n                        <div key={tougeName}>\r\n                            {/* Touge Header */}\r\n                            <h2 className=\"text-xl md:text-2xl font-bold text-white flex items-center gap-2 mb-4 uppercase tracking-widest border-l-4 border-toxic-yellow pl-3\">\r\n                                <MapPin size={24} className=\"text-toxic-yellow\" />\r\n                                {tougeName}\r\n                                <span className=\"text-zinc-500 text-sm md:text-base font-normal ml-2\">\r\n                                    // {tougeGhosts.length} RUNS\r\n                                </span>\r\n                            </h2>\r\n\r\n                            {/* Ghost List */}\r\n                            <div className=\"space-y-4\">\r\n                                {tougeGhosts.map((ghost, index) => (\r\n                                    <motion.div\r\n                                        key={ghost.id}\r\n                                        initial={{ opacity: 0, x: -20 }}\r\n                                        animate={{ opacity: 1, x: 0 }}\r\n                                        transition={{ delay: index * 0.05 }}\r\n                                        className=\"bg-black border-2 border-zinc-800 hard-border hover:border-toxic-yellow transition-colors shadow-[0_0_10px_rgba(0,0,0,0.5)] hover:shadow-[0_0_15px_rgba(255,255,0,0.2)]\"\r\n                                    >\r\n                                        <div className=\"p-4 flex flex-col md:flex-row items-stretch md:items-center justify-between gap-4\">\r\n\r\n                                            {/* Rank & Driver Info */}\r\n                                            <div className=\"flex items-center gap-4\">\r\n                                                {/* Rank Badge */}\r\n                                                <div className={`w-12 h-12 flex items-center justify-center font-bold text-xl hard-border border-2 ${index === 0 ? \"bg-toxic-yellow/20 text-toxic-yellow border-toxic-yellow shadow-[0_0_10px_rgba(255,255,0,0.4)]\" :\r\n                                                        index === 1 ? \"bg-zinc-400/20 text-zinc-300 border-zinc-400\" :\r\n                                                            index === 2 ? \"bg-orange-600/20 text-orange-500 border-orange-600\" :\r\n                                                                \"bg-black text-zinc-600 border-zinc-800\"\r\n                                                    }`}>\r\n                                                    #{index + 1}\r\n                                                </div>\r\n\r\n                                                <div className=\"flex-1\">\r\n                                                    <div className=\"font-bold text-xl text-white uppercase tracking-widest\">{ghost.driverName}</div>\r\n                                                    <div className=\"text-xs text-toxic-cyan flex items-center gap-2 uppercase tracking-widest mt-1 font-bold\">\r\n                                                        <CarIcon size={12} />\r\n                                                        {ghost.carName}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            {/* Stats & Time */}\r\n                                            <div className=\"flex flex-row md:flex-col items-center justify-between md:justify-center bg-zinc-950 border-2 border-zinc-800 p-3 hard-border gap-4 md:gap-2\">\r\n                                                <div className=\"text-center md:text-right flex-1 md:flex-none\">\r\n                                                    <div className=\"text-3xl font-bold text-toxic-yellow text-shadow-[0_0_10px_rgba(255,255,0,0.3)]\">\r\n                                                        {formatTime(ghost.totalTime)}\r\n                                                    </div>\r\n                                                    <div className=\"text-[10px] text-zinc-500 uppercase tracking-widest\">{ghost.date}</div>\r\n                                                </div>\r\n\r\n                                                <div className=\"hidden md:block w-full h-[2px] bg-zinc-800\"></div>\r\n\r\n                                                <div className=\"flex items-center gap-3\">\r\n                                                    <span className=\"text-2xl\">{WEATHER_INFO[ghost.weather].icon}</span>\r\n                                                    <div className=\"text-right text-[10px] uppercase tracking-widest font-bold\">\r\n                                                        <div className=\"text-toxic-green w-24\">\r\n                                                            {ghost.maxSpeed.toFixed(0)} KM/H MAX\r\n                                                        </div>\r\n                                                        <div className=\"text-zinc-500 w-24\">\r\n                                                            {ghost.avgSpeed.toFixed(0)} KM/H AVG\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            {/* Actions */}\r\n                                            <div className=\"flex gap-2 w-full md:w-auto mt-2 md:mt-0\">\r\n                                                <Link\r\n                                                    href={`/ghosts/detail?id=${ghost.id}`}\r\n                                                    className=\"flex-1 md:flex-none flex items-center justify-center gap-2 px-6 py-4 bg-toxic-yellow border-2 border-toxic-yellow text-black font-bold text-sm hover:bg-white hard-border transition-colors uppercase tracking-widest shadow-[0_0_15px_rgba(255,255,0,0.2)]\"\r\n                                                >\r\n                                                    <Play size={14} />\r\n                                                    REPLAY\r\n                                                </Link>\r\n                                                <button\r\n                                                    onClick={() => deleteGhost(ghost.id)}\r\n                                                    className=\"px-4 py-4 bg-black border-2 border-zinc-800 text-zinc-500 hover:bg-red-500/20 hover:text-red-500 hover:border-red-500 transition-colors hard-border\"\r\n                                                >\r\n                                                    <Trash2 size={16} />\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n                                    </motion.div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n\r\n            {/* Stats Footer */}\r\n            {ghosts.length > 0 && (\r\n                <div className=\"mt-16 pt-8 border-t-2 border-zinc-800 flex flex-col md:flex-row gap-4 md:gap-12 uppercase tracking-widest font-bold\">\r\n                    <div className=\"bg-black border-2 border-zinc-800 p-4 hard-border flex justify-between md:block items-center md:items-start text-sm\">\r\n                        <span className=\"text-zinc-500 block text-xs mb-1\">TOTAL RUNS</span>\r\n                        <span className=\"text-toxic-cyan text-xl md:text-2xl\">{ghosts.length}</span>\r\n                    </div>\r\n                    <div className=\"bg-black border-2 border-zinc-800 p-4 hard-border flex justify-between md:block items-center md:items-start text-sm\">\r\n                        <span className=\"text-zinc-500 block text-xs mb-1\">TOUGES EXPLOR√âS</span>\r\n                        <span className=\"text-toxic-magenta text-xl md:text-2xl\">{Object.keys(groupedByTouge).length}</span>\r\n                    </div>\r\n                    <div className=\"bg-black border-2 border-zinc-800 p-4 hard-border flex justify-between md:block items-center md:items-start text-sm\">\r\n                        <span className=\"text-zinc-500 block text-xs mb-1\">MEILLEUR TEMPS</span>\r\n                        <span className=\"text-toxic-green text-xl md:text-2xl text-shadow-[0_0_10px_rgba(0,255,65,0.4)]\">\r\n                            {formatTime(Math.min(...ghosts.map(g => g.totalTime)))}\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\icon.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\lib\\profile.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\lib\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\manifest.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\page.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\page.tsx:12:5\n  10 |\n  11 |   useEffect(() => {\n> 12 |     setProfile(getProfile());\n     |     ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  13 |   }, []);\n  14 |\n  15 |   // XP Progress Calculation","line":12,"column":5,"nodeType":null,"endLine":12,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport Link from \"next/link\";\nimport { Car, Mountain, User, Route, Trophy } from \"lucide-react\";\nimport { getProfile, PlayerProfile, getXpForNextLevel, getXpForCurrentLevel } from \"./lib/profile\";\n\nexport default function Home() {\n  const [profile, setProfile] = useState<PlayerProfile | null>(null);\n\n  useEffect(() => {\n    setProfile(getProfile());\n  }, []);\n\n  // XP Progress Calculation\n  const currentLevelXp = profile ? getXpForCurrentLevel(profile.level) : 0;\n  const nextLevelXp = profile ? getXpForNextLevel(profile.level) : 100;\n  const xpInCurrentLevel = profile ? profile.xp - currentLevelXp : 0;\n  const xpNeededForNext = nextLevelXp - currentLevelXp;\n  const progressPercent = Math.min(100, Math.max(0, (xpInCurrentLevel / xpNeededForNext) * 100));\n\n  return (\n    <div className=\"min-h-screen bg-zinc-950 text-zinc-100 font-mono flex flex-col items-center justify-center p-8\">\n\n      {/* LOGO / TITLE */}\n      <header className=\"text-center mb-10 mt-8\">\n        <h1 className=\"text-6xl md:text-8xl font-bold italic tracking-tighter text-toxic-magenta mb-2 glitch-hover\" style={{ textShadow: \"4px 0 var(--color-toxic-cyan), -4px 0 var(--color-toxic-yellow)\" }}>\n          PROJECT D\n        </h1>\n        <p className=\"text-zinc-500 text-lg tracking-widest uppercase font-bold\">\n          BATTLE STAGE V3 // NIGHT RUNNERS\n        </p>\n        <div className=\"w-full max-w-md h-1 bg-toxic-green mx-auto mt-6 shadow-[0_0_15px_rgba(0,255,65,0.5)] leading-none\" />\n      </header>\n\n      {/* GLOBAL HUD (PROGRESSION) */}\n      <div className=\"w-full max-w-3xl mb-12 bg-black border-2 border-toxic-cyan p-6 shadow-[0_0_20px_rgba(0,255,255,0.1)] relative overflow-hidden group\">\n        <div className=\"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity\">\n          <Trophy size={100} />\n        </div>\n\n        <div className=\"relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-6\">\n          {/* Driver Info */}\n          <div className=\"border-[1px] border-zinc-800 p-3 bg-zinc-950\">\n            <div className=\"text-toxic-cyan text-xs mb-1 font-bold tracking-widest\">CURRENT DRIVER</div>\n            <div className=\"text-3xl font-bold text-white uppercase glitch-hover\">{profile?.driverName || \"ANONYME\"}</div>\n          </div>\n\n          {/* Level & XP Bar */}\n          <div className=\"flex-1 max-w-md border-[1px] border-zinc-800 p-3 bg-zinc-950\">\n            <div className=\"flex justify-between items-end mb-2\">\n              <div className=\"text-toxic-magenta font-bold italic text-xl\">\n                LVL <span className=\"text-4xl shadow-toxic-magenta\">{profile?.level || 1}</span>\n              </div>\n              <div className=\"text-zinc-500 text-sm font-bold\">\n                EXP: <span className=\"text-white\">{profile?.xp || 0}</span> / {nextLevelXp}\n              </div>\n            </div>\n            {/* Progress Bar Container */}\n            <div className=\"h-4 w-full bg-black border border-zinc-700 overflow-hidden\">\n              <div\n                className=\"h-full bg-toxic-magenta shadow-[0_0_10px_rgba(255,0,255,0.8)] transition-all duration-1000 ease-out flex items-center justify-end px-1\"\n                style={{ width: `${progressPercent}%` }}\n              >\n                {progressPercent > 10 && <span className=\"text-[10px] text-white font-bold leading-none\">{Math.round(progressPercent)}%</span>}\n              </div>\n            </div>\n          </div>\n\n          {/* Currencies & Stats */}\n          <div className=\"flex flex-row md:flex-col gap-4 text-right\">\n            <div className=\"border-[1px] border-zinc-800 p-2 bg-zinc-950 min-w-[120px]\">\n              <div className=\"text-zinc-500 text-xs font-bold\">CREDITS</div>\n              <div className=\"text-toxic-green font-bold text-2xl\">{profile?.credits.toLocaleString() || 0} <span className=\"text-sm\">CR</span></div>\n            </div>\n            <div className=\"border-[1px] border-zinc-800 p-2 bg-zinc-950 min-w-[120px]\">\n              <div className=\"text-zinc-500 text-xs font-bold\">ODOMETER</div>\n              <div className=\"text-white font-bold text-xl\">{profile?.totalDistance.toFixed(1) || \"0.0\"} <span className=\"text-sm text-zinc-500\">km</span></div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* NAVIGATION CARDS */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 w-full max-w-3xl\">\n\n        {/* PROFILE LINK */}\n        <Link\n          href=\"/profile\"\n          className=\"group bg-black border-2 border-zinc-800 p-8 hover:border-toxic-magenta transition-all duration-300 relative overflow-hidden\"\n        >\n          <div className=\"absolute inset-0 bg-toxic-magenta/5 translate-y-full group-hover:translate-y-0 transition-transform duration-300\" />\n          <div className=\"relative z-10 flex items-center gap-4 mb-4\">\n            <User size={32} className=\"text-zinc-600 group-hover:text-toxic-magenta transition-colors\" />\n            <h2 className=\"text-3xl font-bold group-hover:text-white glitch-hover\">PROFILE</h2>\n          </div>\n          <p className=\"relative z-10 text-zinc-500 text-sm\">\n            Save management, settings & driver stats.\n          </p>\n          <div className=\"relative z-10 mt-6 text-sm font-bold text-zinc-700 group-hover:text-toxic-magenta transition-colors\">\n            ACCESS CARD &gt;\n          </div>\n        </Link>\n\n        {/* GARAGE LINK */}\n        <Link\n          href=\"/garage\"\n          className=\"group bg-black border-2 border-zinc-800 p-8 hover:border-toxic-cyan transition-all duration-300 relative overflow-hidden\"\n        >\n          <div className=\"absolute inset-0 bg-toxic-cyan/5 translate-y-full group-hover:translate-y-0 transition-transform duration-300\" />\n          <div className=\"relative z-10 flex items-center gap-4 mb-4\">\n            <Car size={32} className=\"text-zinc-600 group-hover:text-toxic-cyan transition-colors\" />\n            <h2 className=\"text-3xl font-bold group-hover:text-white glitch-hover\">GARAGE</h2>\n          </div>\n          <p className=\"relative z-10 text-zinc-500 text-sm\">\n            Configure your loadout and view machines.\n          </p>\n          <div className=\"relative z-10 mt-6 text-sm font-bold text-zinc-700 group-hover:text-toxic-cyan transition-colors\">\n            ACCESS PARKING AREA &gt;\n          </div>\n        </Link>\n\n        {/* TOUGE LINK */}\n        <Link\n          href=\"/touge\"\n          className=\"group bg-black border-2 border-zinc-800 p-8 hover:border-toxic-green transition-all duration-300 relative overflow-hidden\"\n        >\n          <div className=\"absolute inset-0 bg-toxic-green/5 translate-y-full group-hover:translate-y-0 transition-transform duration-300\" />\n          <div className=\"relative z-10 flex items-center gap-4 mb-4\">\n            <Mountain size={32} className=\"text-zinc-600 group-hover:text-toxic-green transition-colors\" />\n            <h2 className=\"text-3xl font-bold group-hover:text-white glitch-hover\">TOUGE</h2>\n          </div>\n          <p className=\"relative z-10 text-zinc-500 text-sm\">\n            Select legendary mountain pass circuits.\n          </p>\n          <div className=\"relative z-10 mt-6 text-sm font-bold text-zinc-700 group-hover:text-toxic-green transition-colors\">\n            ACCESS COURSE &gt;\n          </div>\n        </Link>\n\n        {/* CONQUEST LINK */}\n        <Link\n          href=\"/conquest\"\n          className=\"group bg-black border-2 border-zinc-800 p-8 hover:border-toxic-yellow transition-all duration-300 relative overflow-hidden\"\n        >\n          <div className=\"absolute inset-0 bg-toxic-yellow/5 translate-y-full group-hover:translate-y-0 transition-transform duration-300\" />\n          <div className=\"relative z-10 flex items-center gap-4 mb-4\">\n            <Route size={32} className=\"text-zinc-600 group-hover:text-toxic-yellow transition-colors\" />\n            <h2 className=\"text-3xl font-bold group-hover:text-white glitch-hover\">CONQUEST</h2>\n          </div>\n          <p className=\"relative z-10 text-zinc-500 text-sm\">\n            Build custom circuits and rival territory.\n          </p>\n          <div className=\"relative z-10 mt-6 text-sm font-bold text-zinc-700 group-hover:text-toxic-yellow transition-colors\">\n            MAP EDITOR &gt;\n          </div>\n        </Link>\n\n      </div>\n\n      {/* FOOTER */}\n      <footer className=\"mt-16 mb-8 text-zinc-600 text-sm font-bold tracking-widest flex items-center gap-4\">\n        <span className=\"animate-pulse w-2 h-2 bg-toxic-green shadow-[0_0_10px_#00ff41]\" />\n        SYSTEM v3.0 // CONNECTED\n      </footer>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\profile\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used.","line":5,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Zap' is defined but never used.","line":5,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Crown' is defined but never used.","line":6,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Star' is defined but never used.","line":6,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Medal' is defined but never used.","line":6,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Check' is defined but never used.","line":6,"column":46,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":51},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":6,"column":53,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":54},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\profile\\page.tsx:144:19\n  142 |\n  143 |         if (savedProfile) {\n> 144 |             try { setProfile(JSON.parse(savedProfile)); } catch { }\n      |                   ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  145 |         }\n  146 |         if (savedBattles) {\n  147 |             try { setBattles(JSON.parse(savedBattles)); } catch { }","line":144,"column":19,"nodeType":null,"endLine":144,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":237,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":237,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'index' is defined but never used.","line":449,"column":66,"nodeType":null,"messageId":"unusedVar","endLine":449,"endColumn":71}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport {\r\n    User, Trophy, Mountain, Flame, Target, Zap,\r\n    Crown, Star, Medal, Award, Plus, Trash2, Check, X,\r\n    TrendingUp, TrendingDown, Download, Upload\r\n} from \"lucide-react\";\r\nimport { motion } from \"framer-motion\";\r\n\r\n// --- TYPES ---\r\ntype BattleRecord = {\r\n    id: string;\r\n    opponent: string;\r\n    location: string;\r\n    result: \"WIN\" | \"LOSS\";\r\n    date: string;\r\n    technique?: string;\r\n};\r\n\r\ntype DriverProfile = {\r\n    name: string;\r\n    specialty: \"DOWNHILL\" | \"UPHILL\" | \"BOTH\";\r\n    homeMountain: string;\r\n    avatar: string;\r\n};\r\n\r\ntype Badge = {\r\n    id: string;\r\n    name: string;\r\n    description: string;\r\n    icon: string;\r\n    unlocked: boolean;\r\n    condition: (battles: BattleRecord[]) => boolean;\r\n};\r\n\r\n// --- BADGES D√âFINITIONS ---\r\nconst BADGE_DEFINITIONS: Omit<Badge, \"unlocked\">[] = [\r\n    {\r\n        id: \"first_blood\",\r\n        name: \"FIRST BLOOD\",\r\n        description: \"Remporter ta premi√®re victoire\",\r\n        icon: \"ü©∏\",\r\n        condition: (battles) => battles.filter(b => b.result === \"WIN\").length >= 1,\r\n    },\r\n    {\r\n        id: \"downhill_king\",\r\n        name: \"DOWNHILL KING\",\r\n        description: \"Gagner 5 courses\",\r\n        icon: \"üëë\",\r\n        condition: (battles) => battles.filter(b => b.result === \"WIN\").length >= 5,\r\n    },\r\n    {\r\n        id: \"akina_legend\",\r\n        name: \"AKINA LEGEND\",\r\n        description: \"Gagner 3 fois sur Akina\",\r\n        icon: \"üèîÔ∏è\",\r\n        condition: (battles) => battles.filter(b => b.result === \"WIN\" && b.location.toLowerCase().includes(\"akina\")).length >= 3,\r\n    },\r\n    {\r\n        id: \"undefeated\",\r\n        name: \"UNDEFEATED\",\r\n        description: \"10 victoires cons√©cutives\",\r\n        icon: \"üî•\",\r\n        condition: (battles) => {\r\n            const last10 = battles.slice(-10);\r\n            return last10.length >= 10 && last10.every(b => b.result === \"WIN\");\r\n        },\r\n    },\r\n    {\r\n        id: \"gutter_master\",\r\n        name: \"GUTTER MASTER\",\r\n        description: \"Utiliser la technique Gutter Run\",\r\n        icon: \"‚ö°\",\r\n        condition: (battles) => battles.some(b => b.technique?.toLowerCase().includes(\"gutter\")),\r\n    },\r\n    {\r\n        id: \"drift_king\",\r\n        name: \"DRIFT KING\",\r\n        description: \"20 courses au total\",\r\n        icon: \"üèéÔ∏è\",\r\n        condition: (battles) => battles.length >= 20,\r\n    },\r\n    {\r\n        id: \"comeback_kid\",\r\n        name: \"COMEBACK KID\",\r\n        description: \"Gagner apr√®s 3 d√©faites\",\r\n        icon: \"üí™\",\r\n        condition: (battles) => {\r\n            for (let i = 3; i < battles.length; i++) {\r\n                if (battles[i].result === \"WIN\" &&\r\n                    battles[i - 1].result === \"LOSS\" &&\r\n                    battles[i - 2].result === \"LOSS\" &&\r\n                    battles[i - 3].result === \"LOSS\") {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n    },\r\n    {\r\n        id: \"night_racer\",\r\n        name: \"NIGHT RACER\",\r\n        description: \"10 victoires total\",\r\n        icon: \"üåô\",\r\n        condition: (battles) => battles.filter(b => b.result === \"WIN\").length >= 10,\r\n    },\r\n];\r\n\r\n// --- CL√âS LOCALSTORAGE ---\r\nconst STORAGE_KEYS = {\r\n    PROFILE: \"projectd_profile\",\r\n    BATTLES: \"projectd_battles\",\r\n};\r\n\r\nconst DEFAULT_PROFILE: DriverProfile = {\r\n    name: \"DRIVER\",\r\n    specialty: \"DOWNHILL\",\r\n    homeMountain: \"AKINA\",\r\n    avatar: \"üèéÔ∏è\",\r\n};\r\n\r\nexport default function ProfilePage() {\r\n    // --- √âTATS ---\r\n    const [profile, setProfile] = useState<DriverProfile>(DEFAULT_PROFILE);\r\n    const [battles, setBattles] = useState<BattleRecord[]>([]);\r\n    const [isLoaded, setIsLoaded] = useState(false);\r\n    const [isEditingProfile, setIsEditingProfile] = useState(false);\r\n\r\n    // Formulaire battle\r\n    const [newBattle, setNewBattle] = useState({\r\n        opponent: \"\",\r\n        location: \"\",\r\n        result: \"WIN\" as \"WIN\" | \"LOSS\",\r\n        technique: \"\",\r\n    });\r\n\r\n    // --- CHARGEMENT LOCALSTORAGE ---\r\n    useEffect(() => {\r\n        const savedProfile = localStorage.getItem(STORAGE_KEYS.PROFILE);\r\n        const savedBattles = localStorage.getItem(STORAGE_KEYS.BATTLES);\r\n\r\n        if (savedProfile) {\r\n            try { setProfile(JSON.parse(savedProfile)); } catch { }\r\n        }\r\n        if (savedBattles) {\r\n            try { setBattles(JSON.parse(savedBattles)); } catch { }\r\n        }\r\n        setIsLoaded(true);\r\n    }, []);\r\n\r\n    // --- SAUVEGARDE AUTO ---\r\n    useEffect(() => {\r\n        if (isLoaded) {\r\n            localStorage.setItem(STORAGE_KEYS.PROFILE, JSON.stringify(profile));\r\n        }\r\n    }, [profile, isLoaded]);\r\n\r\n    useEffect(() => {\r\n        if (isLoaded) {\r\n            localStorage.setItem(STORAGE_KEYS.BATTLES, JSON.stringify(battles));\r\n        }\r\n    }, [battles, isLoaded]);\r\n\r\n    // --- CALCULS STATS ---\r\n    const wins = battles.filter(b => b.result === \"WIN\").length;\r\n    const losses = battles.filter(b => b.result === \"LOSS\").length;\r\n    const winRate = battles.length > 0 ? Math.round((wins / battles.length) * 100) : 0;\r\n\r\n    // --- BADGES CHECK ---\r\n    const unlockedBadges = BADGE_DEFINITIONS.map(badge => ({\r\n        ...badge,\r\n        unlocked: badge.condition(battles),\r\n    }));\r\n\r\n    // --- FONCTIONS ---\r\n    const addBattle = () => {\r\n        if (!newBattle.opponent || !newBattle.location) return;\r\n        const battle: BattleRecord = {\r\n            id: Date.now().toString(),\r\n            opponent: newBattle.opponent,\r\n            location: newBattle.location,\r\n            result: newBattle.result,\r\n            date: new Date().toISOString().split('T')[0],\r\n            technique: newBattle.technique || undefined,\r\n        };\r\n        setBattles([...battles, battle]);\r\n        setNewBattle({ opponent: \"\", location: \"\", result: \"WIN\", technique: \"\" });\r\n    };\r\n\r\n    const removeBattle = (id: string) => {\r\n        setBattles(battles.filter(b => b.id !== id));\r\n    };\r\n\r\n    // --- SAVE MANAGEMENT ---\r\n    const handleExport = () => {\r\n        const exportData: Record<string, string> = {};\r\n        for (let i = 0; i < localStorage.length; i++) {\r\n            const key = localStorage.key(i);\r\n            if (key && key.startsWith(\"projectd_\")) {\r\n                const val = localStorage.getItem(key);\r\n                if (val) exportData[key] = val;\r\n            }\r\n        }\r\n\r\n        const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: \"application/json\" });\r\n        const url = URL.createObjectURL(blob);\r\n        const a = document.createElement(\"a\");\r\n        a.href = url;\r\n        a.download = `projectd_save_${new Date().toISOString().split('T')[0]}.json`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n        URL.revokeObjectURL(url);\r\n    };\r\n\r\n    const handleImport = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (!file) return;\r\n\r\n        const reader = new FileReader();\r\n        reader.onload = (event) => {\r\n            try {\r\n                const content = event.target?.result as string;\r\n                const data = JSON.parse(content);\r\n\r\n                let imported = 0;\r\n                for (const key in data) {\r\n                    if (key.startsWith(\"projectd_\")) {\r\n                        localStorage.setItem(key, data[key]);\r\n                        imported++;\r\n                    }\r\n                }\r\n\r\n                alert(`Succ√®s : ${imported} types de donn√©es import√©es ! L'application va recharger.`);\r\n                window.location.reload();\r\n            } catch (error) {\r\n                alert(\"Erreur lors de l'importation. Fichier invalide.\");\r\n            }\r\n        };\r\n        reader.readAsText(file);\r\n    };\r\n\r\n    // --- RENDU ---\r\n    return (\r\n        <div className=\"min-h-screen bg-black text-zinc-100 p-8 font-pixel\">\r\n\r\n            {/* HEADER */}\r\n            <header className=\"mb-12 border-b-2 border-zinc-800 pb-4\">\r\n                <h1 className=\"text-4xl font-bold italic tracking-tighter text-toxic-magenta glitch-hover\">\r\n                    PROJECT D // PROFILE\r\n                </h1>\r\n                <p className=\"text-zinc-500 mt-2 font-bold tracking-widest\">DRIVER STATUS & BATTLE RECORDS</p>\r\n            </header>\r\n\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n\r\n                {/* COLONNE 1 : PROFIL */}\r\n                <div className=\"space-y-6\">\r\n\r\n                    {/* DRIVER CARD */}\r\n                    <div className=\"bg-zinc-950 border-2 border-zinc-800 p-6 hard-border\">\r\n                        <div className=\"flex items-center gap-4 mb-6\">\r\n                            <div className=\"w-16 h-16 border-2 border-toxic-magenta bg-black flex items-center justify-center text-3xl hard-border shadow-[0_0_15px_rgba(255,0,255,0.3)]\">\r\n                                {profile.avatar}\r\n                            </div>\r\n                            <div>\r\n                                {isEditingProfile ? (\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={profile.name}\r\n                                        onChange={(e) => setProfile({ ...profile, name: e.target.value })}\r\n                                        className=\"bg-black border-2 border-zinc-700 p-1 text-xl font-bold focus:border-toxic-magenta outline-none hard-border text-white uppercase w-full\"\r\n                                    />\r\n                                ) : (\r\n                                    <h2 className=\"text-3xl font-bold text-white uppercase glitch-hover\">{profile.name}</h2>\r\n                                )}\r\n                                <p className=\"text-toxic-magenta font-bold text-sm tracking-widest\">PROJECT D MEMBER</p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Edit Mode */}\r\n                        {isEditingProfile ? (\r\n                            <div className=\"space-y-3 mb-4\">\r\n                                <div>\r\n                                    <label className=\"text-zinc-500 text-xs font-bold block mb-1\">SP√âCIALIT√â</label>\r\n                                    <select\r\n                                        value={profile.specialty}\r\n                                        onChange={(e) => setProfile({ ...profile, specialty: e.target.value as DriverProfile[\"specialty\"] })}\r\n                                        className=\"w-full bg-black border-2 border-zinc-700 p-2 text-sm focus:border-toxic-magenta outline-none hard-border text-white\"\r\n                                    >\r\n                                        <option value=\"DOWNHILL\">DOWNHILL</option>\r\n                                        <option value=\"UPHILL\">UPHILL</option>\r\n                                        <option value=\"BOTH\">BOTH</option>\r\n                                    </select>\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"text-zinc-500 text-xs font-bold block mb-1\">HOME MOUNTAIN</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={profile.homeMountain}\r\n                                        onChange={(e) => setProfile({ ...profile, homeMountain: e.target.value })}\r\n                                        className=\"w-full bg-black border-2 border-zinc-700 p-2 text-sm focus:border-toxic-magenta outline-none hard-border text-white uppercase\"\r\n                                    />\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"text-zinc-500 text-xs font-bold block mb-1\">AVATAR (emoji)</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={profile.avatar}\r\n                                        onChange={(e) => setProfile({ ...profile, avatar: e.target.value })}\r\n                                        className=\"w-full bg-black border-2 border-zinc-700 p-2 text-sm focus:border-toxic-magenta outline-none hard-border text-center text-2xl\"\r\n                                        maxLength={2}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"space-y-3 mb-4 border-y-2 border-zinc-800 py-4\">\r\n                                <div className=\"flex justify-between items-center\">\r\n                                    <span className=\"text-zinc-500 text-xs font-bold tracking-widest\">SPECIALTY</span>\r\n                                    <span className=\"text-toxic-cyan font-bold text-xl\">{profile.specialty}</span>\r\n                                </div>\r\n                                <div className=\"flex justify-between items-center\">\r\n                                    <span className=\"text-zinc-500 text-xs font-bold tracking-widest\">HOME REGION</span>\r\n                                    <span className=\"text-white font-bold text-xl uppercase\">{profile.homeMountain}</span>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        <button\r\n                            onClick={() => setIsEditingProfile(!isEditingProfile)}\r\n                            className=\"w-full bg-zinc-800 hover:bg-toxic-magenta hover:text-black text-white py-3 text-sm font-bold transition-colors mb-6 hard-border\"\r\n                        >\r\n                            {isEditingProfile ? \"SAVE PROFILE DATA\" : \"EDIT PROFILE DATA\"}\r\n                        </button>\r\n\r\n                        {/* SAVE MANAGEMENT BUTTONS */}\r\n                        <div className=\"border-t-2 border-zinc-800 pt-6\">\r\n                            <h3 className=\"text-xs font-bold text-zinc-500 mb-3 uppercase tracking-widest\">SYSTEM DATA MANAGEMENT</h3>\r\n                            <div className=\"flex gap-2\">\r\n                                <button\r\n                                    onClick={handleExport}\r\n                                    className=\"flex-1 bg-black border-2 border-zinc-700 hover:border-toxic-green text-zinc-300 hover:text-toxic-green py-2 text-xs font-bold transition-colors flex items-center justify-center gap-2 hard-border\"\r\n                                >\r\n                                    <Download size={14} /> EXPORT SAVE\r\n                                </button>\r\n\r\n                                <label className=\"flex-1 bg-black border-2 border-zinc-700 hover:border-toxic-cyan text-zinc-300 hover:text-toxic-cyan py-2 text-xs font-bold transition-colors cursor-pointer flex items-center justify-center gap-2 hard-border\">\r\n                                    <Upload size={14} /> IMPORT SAVE\r\n                                    <input\r\n                                        type=\"file\"\r\n                                        accept=\".json\"\r\n                                        onChange={handleImport}\r\n                                        className=\"hidden\"\r\n                                    />\r\n                                </label>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* STATS */}\r\n                    <div className=\"bg-zinc-950 border-2 border-zinc-800 p-6 hard-border\">\r\n                        <h3 className=\"text-lg font-bold mb-4 flex items-center gap-2 text-white\">\r\n                            <Trophy className=\"text-toxic-yellow\" size={20} />\r\n                            RACING STATISTICS\r\n                        </h3>\r\n\r\n                        <div className=\"grid grid-cols-3 gap-4 text-center\">\r\n                            <div className=\"border border-zinc-800 bg-black p-2\">\r\n                                <div className=\"text-4xl font-bold text-toxic-green glitch-hover\">{wins}</div>\r\n                                <div className=\"text-zinc-500 text-xs font-bold\">WINS</div>\r\n                            </div>\r\n                            <div className=\"border border-zinc-800 bg-black p-2\">\r\n                                <div className=\"text-4xl font-bold text-red-500 glitch-hover\">{losses}</div>\r\n                                <div className=\"text-zinc-500 text-xs font-bold\">LOSSES</div>\r\n                            </div>\r\n                            <div className=\"border border-zinc-800 bg-black p-2\">\r\n                                <div className=\"text-4xl font-bold text-toxic-yellow glitch-hover\">{winRate}%</div>\r\n                                <div className=\"text-zinc-500 text-xs font-bold\">WIN RATE</div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* COLONNE 2 : BATTLE RECORDS */}\r\n                <div className=\"lg:col-span-2 space-y-6\">\r\n\r\n                    {/* ADD BATTLE FORM */}\r\n                    <div className=\"bg-zinc-950 border-2 border-zinc-800 p-4 hard-border\">\r\n                        <h3 className=\"text-lg font-bold mb-4 flex items-center gap-2 text-white\">\r\n                            <Flame className=\"text-orange-500 animate-pulse\" size={20} />\r\n                            NEW BATTLE RECORD\r\n                        </h3>\r\n\r\n                        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4\">\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Adversaire\"\r\n                                className=\"bg-black border-2 border-zinc-700 p-2 text-sm focus:border-toxic-red outline-none hard-border text-white placeholder-zinc-600\"\r\n                                value={newBattle.opponent}\r\n                                onChange={(e) => setNewBattle({ ...newBattle, opponent: e.target.value })}\r\n                            />\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Location (ex: Akina)\"\r\n                                className=\"bg-black border-2 border-zinc-700 p-2 text-sm focus:border-toxic-red outline-none hard-border text-white placeholder-zinc-600 uppercase\"\r\n                                value={newBattle.location}\r\n                                onChange={(e) => setNewBattle({ ...newBattle, location: e.target.value })}\r\n                            />\r\n                            <select\r\n                                className=\"bg-black border-2 border-zinc-700 p-2 text-sm focus:border-toxic-red outline-none hard-border text-white\"\r\n                                value={newBattle.result}\r\n                                onChange={(e) => setNewBattle({ ...newBattle, result: e.target.value as \"WIN\" | \"LOSS\" })}\r\n                            >\r\n                                <option value=\"WIN\">‚úì VICTORY</option>\r\n                                <option value=\"LOSS\">‚úó DEFEAT</option>\r\n                            </select>\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Technique (optionnel)\"\r\n                                className=\"bg-black border-2 border-zinc-700 p-2 text-sm focus:border-toxic-red outline-none hard-border text-white placeholder-zinc-600\"\r\n                                value={newBattle.technique}\r\n                                onChange={(e) => setNewBattle({ ...newBattle, technique: e.target.value })}\r\n                            />\r\n                        </div>\r\n\r\n                        <button\r\n                            onClick={addBattle}\r\n                            className=\"w-full bg-zinc-800 text-white hover:bg-orange-500 hover:text-black transition-colors py-2 text-sm font-bold flex items-center justify-center gap-2 hard-border\"\r\n                        >\r\n                            <Plus size={16} /> ENREGISTRER LE LOG\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* BATTLE HISTORY */}\r\n                    <div className=\"bg-zinc-950 border-2 border-zinc-800 hard-border overflow-hidden\">\r\n                        <div className=\"p-4 border-b-2 border-zinc-800 bg-black\">\r\n                            <h3 className=\"text-xl font-bold flex items-center gap-2 text-white\">\r\n                                <Target size={20} className=\"text-zinc-600\" />\r\n                                BATTLE LOGS <span className=\"text-zinc-600 text-sm\">[{battles.length}]</span>\r\n                            </h3>\r\n                        </div>\r\n\r\n                        <div className=\"max-h-96 overflow-y-auto bg-black p-2 space-y-2\">\r\n                            {battles.length === 0 && (\r\n                                <p className=\"text-zinc-600 text-sm font-bold text-center py-8\">NO DATA FOUND IN SYSTEM...</p>\r\n                            )}\r\n\r\n                            {[...battles].reverse().map((battle, index) => (\r\n                                <motion.div\r\n                                    initial={{ opacity: 0, x: -20 }}\r\n                                    animate={{ opacity: 1, x: 0 }}\r\n                                    key={battle.id}\r\n                                    className={`flex items-center justify-between p-4 border-2 border-zinc-800 bg-zinc-950 hover:border-zinc-600 transition-colors hard-border`}\r\n                                >\r\n                                    <div className=\"flex items-center gap-4\">\r\n                                        {battle.result === \"WIN\" ? (\r\n                                            <div className=\"w-12 h-12 border-2 border-toxic-green bg-toxic-green/10 flex items-center justify-center hard-border\">\r\n                                                <TrendingUp className=\"text-toxic-green\" size={24} />\r\n                                            </div>\r\n                                        ) : (\r\n                                            <div className=\"w-12 h-12 border-2 border-red-500 bg-red-500/10 flex items-center justify-center hard-border\">\r\n                                                <TrendingDown className=\"text-red-500\" size={24} />\r\n                                            </div>\r\n                                        )}\r\n                                        <div>\r\n                                            <div className=\"font-bold text-xl text-white uppercase\">vs {battle.opponent}</div>\r\n                                            <div className=\"text-zinc-500 text-sm font-bold flex items-center gap-2 uppercase tracking-wider\">\r\n                                                <Mountain size={14} />\r\n                                                {battle.location}\r\n                                                {battle.technique && (\r\n                                                    <span className=\"text-toxic-cyan text-xs font-bold\">‚Ä¢ {battle.technique}</span>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"flex items-center gap-4\">\r\n                                        <span className=\"text-zinc-600 text-sm font-bold tracking-widest\">{battle.date}</span>\r\n                                        <span className={`px-3 py-1 text-sm font-bold hard-border border-2 ${battle.result === \"WIN\"\r\n                                            ? \"border-toxic-green text-toxic-green\"\r\n                                            : \"border-red-500 text-red-500\"\r\n                                            }`}>\r\n                                            {battle.result}\r\n                                        </span>\r\n                                        <button\r\n                                            onClick={() => removeBattle(battle.id)}\r\n                                            className=\"text-zinc-700 hover:text-red-500 transition-colors\"\r\n                                        >\r\n                                            <Trash2 size={16} />\r\n                                        </button>\r\n                                    </div>\r\n                                </motion.div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* BADGES */}\r\n                    <div className=\"bg-zinc-950 border-2 border-zinc-800 p-6 hard-border mt-6\">\r\n                        <h3 className=\"text-xl font-bold mb-6 flex items-center gap-2 text-white\">\r\n                            <Award className=\"text-toxic-yellow\" size={24} />\r\n                            ACHIEVEMENTS <span className=\"text-zinc-600 text-sm\">[{unlockedBadges.filter(b => b.unlocked).length}/{BADGE_DEFINITIONS.length}]</span>\r\n                        </h3>\r\n\r\n                        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                            {unlockedBadges.map((badge) => (\r\n                                <motion.div\r\n                                    key={badge.id}\r\n                                    initial={{ scale: 0.9 }}\r\n                                    animate={{ scale: 1 }}\r\n                                    className={`p-4 border-2 text-center transition-all hard-border ${badge.unlocked\r\n                                        ? \"bg-toxic-yellow/10 border-toxic-yellow/50 shadow-[0_0_10px_rgba(250,204,21,0.2)]\"\r\n                                        : \"bg-black border-zinc-900 opacity-30 grayscale\"\r\n                                        }`}\r\n                                >\r\n                                    <div className=\"text-4xl mb-2 grayscale-0 filter-none\">{badge.icon}</div>\r\n                                    <div className={`text-sm font-bold ${badge.unlocked ? \"text-toxic-yellow\" : \"text-zinc-600\"}`}>\r\n                                        {badge.name}\r\n                                    </div>\r\n                                    <div className=\"text-zinc-500 text-[10px] uppercase font-bold mt-2\">{badge.description}</div>\r\n                                </motion.div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\run\\RunMapView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\run\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Timer' is defined but never used.","line":9,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Gauge' is defined but never used.","line":9,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Navigation2' is defined but never used.","line":9,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used.","line":9,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":43},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\run\\page.tsx:78:19\n  76 |\n  77 |         if (savedCars) {\n> 78 |             try { setCars(JSON.parse(savedCars)); } catch { }\n     |                   ^^^^^^^ Avoid calling setState() directly within an effect\n  79 |         }\n  80 |         if (savedRoutes) {\n  81 |             try { setTouges(JSON.parse(savedRoutes)); } catch { }","line":78,"column":19,"nodeType":null,"endLine":78,"endColumn":26}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport dynamic from \"next/dynamic\";\r\nimport Link from \"next/link\";\r\nimport {\r\n    ArrowLeft, Car as CarIcon, MapPin, Play, Square,\r\n    Timer, Gauge, Navigation2, AlertCircle, Trophy\r\n} from \"lucide-react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport {\r\n    Car, Weather, GhostRun, GhostPoint,\r\n    WEATHER_INFO, STORAGE_KEYS, LatLng\r\n} from \"../lib/types\";\r\nimport { addRewards } from \"../lib/profile\";\r\n\r\n// Dynamic map import\r\nconst RunMapView = dynamic(() => import(\"./RunMapView\"), {\r\n    ssr: false,\r\n    loading: () => (\r\n        <div className=\"w-full h-full bg-black flex items-center justify-center font-pixel\">\r\n            <div className=\"text-toxic-cyan text-xl animate-pulse glitch-hover\">LOADING MAP...</div>\r\n        </div>\r\n    )\r\n});\r\n\r\ntype UserRoute = {\r\n    id: string;\r\n    name: string;\r\n    points: LatLng[];\r\n    routeGeometry?: LatLng[];\r\n    distance: number;\r\n    createdAt: string;\r\n    type: string;\r\n    difficulty: \"EASY\" | \"MEDIUM\" | \"HARD\" | \"LEGENDARY\";\r\n    region: string;\r\n};\r\n\r\nexport default function RunPage() {\r\n    const router = useRouter();\r\n\r\n    // Selection state\r\n    const [cars, setCars] = useState<Car[]>([]);\r\n    const [touges, setTouges] = useState<UserRoute[]>([]);\r\n    const [selectedCar, setSelectedCar] = useState<Car | null>(null);\r\n    const [selectedTouge, setSelectedTouge] = useState<UserRoute | null>(null);\r\n    const [selectedWeather, setSelectedWeather] = useState<Weather>(\"SEC\");\r\n    const [driverName, setDriverName] = useState(\"\");\r\n\r\n    // Recording state\r\n    const [isSetupComplete, setIsSetupComplete] = useState(false);\r\n    const [isRecording, setIsRecording] = useState(false);\r\n    const [gpsPoints, setGpsPoints] = useState<GhostPoint[]>([]);\r\n    const [currentPosition, setCurrentPosition] = useState<LatLng | null>(null);\r\n    const [gpsAccuracy, setGpsAccuracy] = useState<number>(0);\r\n    const [gpsError, setGpsError] = useState<string | null>(null);\r\n\r\n    // Timer state\r\n    const [startTime, setStartTime] = useState<number>(0);\r\n    const [elapsedTime, setElapsedTime] = useState<number>(0);\r\n    const [currentSpeed, setCurrentSpeed] = useState<number>(0);\r\n    const [maxSpeed, setMaxSpeed] = useState<number>(0);\r\n\r\n    // Rewards state\r\n    const [runRewards, setRunRewards] = useState<{ xp: number, cr: number, ghostId: string } | null>(null);\r\n\r\n    // Refs\r\n    const watchIdRef = useRef<number | null>(null);\r\n    const timerRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n    // Load cars and touges\r\n    useEffect(() => {\r\n        const savedCars = localStorage.getItem(STORAGE_KEYS.CARS);\r\n        const savedRoutes = localStorage.getItem(STORAGE_KEYS.ROUTES);\r\n\r\n        if (savedCars) {\r\n            try { setCars(JSON.parse(savedCars)); } catch { }\r\n        }\r\n        if (savedRoutes) {\r\n            try { setTouges(JSON.parse(savedRoutes)); } catch { }\r\n        }\r\n    }, []);\r\n\r\n    // Timer effect\r\n    useEffect(() => {\r\n        if (isRecording && startTime > 0) {\r\n            timerRef.current = setInterval(() => {\r\n                setElapsedTime(Date.now() - startTime);\r\n            }, 100);\r\n        }\r\n\r\n        return () => {\r\n            if (timerRef.current) clearInterval(timerRef.current);\r\n        };\r\n    }, [isRecording, startTime]);\r\n\r\n    // Cleanup on unmount\r\n    useEffect(() => {\r\n        return () => {\r\n            if (watchIdRef.current !== null) {\r\n                navigator.geolocation.clearWatch(watchIdRef.current);\r\n            }\r\n            if (timerRef.current) clearInterval(timerRef.current);\r\n        };\r\n    }, []);\r\n\r\n    const formatTime = (ms: number): string => {\r\n        const minutes = Math.floor(ms / 60000);\r\n        const seconds = Math.floor((ms % 60000) / 1000);\r\n        const milliseconds = Math.floor((ms % 1000) / 10);\r\n        return `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}.${milliseconds.toString().padStart(2, '0')}`;\r\n    };\r\n\r\n    const calculateSpeed = (p1: GhostPoint, p2: GhostPoint): number => {\r\n        const R = 6371; // km\r\n        const dLat = (p2.lat - p1.lat) * Math.PI / 180;\r\n        const dLon = (p2.lng - p1.lng) * Math.PI / 180;\r\n        const a = Math.sin(dLat / 2) ** 2 +\r\n            Math.cos(p1.lat * Math.PI / 180) * Math.cos(p2.lat * Math.PI / 180) *\r\n            Math.sin(dLon / 2) ** 2;\r\n        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n        const distance = R * c; // km\r\n        const timeDiff = (p2.timestamp - p1.timestamp) / 3600000; // hours\r\n        return timeDiff > 0 ? distance / timeDiff : 0;\r\n    };\r\n\r\n    const startRun = () => {\r\n        if (!navigator.geolocation) {\r\n            setGpsError(\"G√©olocalisation non support√©e\");\r\n            return;\r\n        }\r\n\r\n        setGpsError(null);\r\n        setGpsPoints([]);\r\n        setMaxSpeed(0);\r\n        const now = Date.now();\r\n        setStartTime(now);\r\n        setIsRecording(true);\r\n\r\n        const options: PositionOptions = {\r\n            enableHighAccuracy: true,\r\n            timeout: 10000,\r\n            maximumAge: 0\r\n        };\r\n\r\n        const onSuccess = (position: GeolocationPosition) => {\r\n            const { latitude, longitude, accuracy, speed } = position.coords;\r\n            const timestamp = Date.now() - startTime;\r\n\r\n            const newPoint: GhostPoint = {\r\n                lat: latitude,\r\n                lng: longitude,\r\n                timestamp,\r\n                speed: speed ? speed * 3.6 : undefined // m/s to km/h\r\n            };\r\n\r\n            setCurrentPosition([latitude, longitude]);\r\n            setGpsAccuracy(accuracy);\r\n\r\n            setGpsPoints(prev => {\r\n                if (prev.length === 0) return [newPoint];\r\n\r\n                const lastPoint = prev[prev.length - 1];\r\n                // Calculate speed if not provided\r\n                if (!newPoint.speed && prev.length > 0) {\r\n                    newPoint.speed = calculateSpeed(lastPoint, newPoint);\r\n                }\r\n\r\n                if (newPoint.speed) {\r\n                    setCurrentSpeed(newPoint.speed);\r\n                    if (newPoint.speed > maxSpeed) {\r\n                        setMaxSpeed(newPoint.speed);\r\n                    }\r\n                }\r\n\r\n                return [...prev, newPoint];\r\n            });\r\n        };\r\n\r\n        const onError = (error: GeolocationPositionError) => {\r\n            setGpsError(\"Erreur GPS: \" + error.message);\r\n        };\r\n\r\n        watchIdRef.current = navigator.geolocation.watchPosition(onSuccess, onError, options);\r\n    };\r\n\r\n    const stopRun = () => {\r\n        if (watchIdRef.current !== null) {\r\n            navigator.geolocation.clearWatch(watchIdRef.current);\r\n            watchIdRef.current = null;\r\n        }\r\n        if (timerRef.current) {\r\n            clearInterval(timerRef.current);\r\n            timerRef.current = null;\r\n        }\r\n        setIsRecording(false);\r\n\r\n        // Save the ghost run\r\n        if (gpsPoints.length >= 2 && selectedCar && selectedTouge) {\r\n            const totalDistance = gpsPoints.reduce((acc, point, i) => {\r\n                if (i === 0) return 0;\r\n                const prev = gpsPoints[i - 1];\r\n                const R = 6371;\r\n                const dLat = (point.lat - prev.lat) * Math.PI / 180;\r\n                const dLon = (point.lng - prev.lng) * Math.PI / 180;\r\n                const a = Math.sin(dLat / 2) ** 2 +\r\n                    Math.cos(prev.lat * Math.PI / 180) * Math.cos(point.lat * Math.PI / 180) *\r\n                    Math.sin(dLon / 2) ** 2;\r\n                const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n                return acc + R * c;\r\n            }, 0);\r\n\r\n            const avgSpeed = totalDistance / (elapsedTime / 3600000);\r\n\r\n            const ghostRun: GhostRun = {\r\n                id: Date.now().toString(),\r\n                tougeId: selectedTouge.id,\r\n                tougeName: selectedTouge.name,\r\n                carId: selectedCar.id,\r\n                carName: selectedCar.name,\r\n                weather: selectedWeather,\r\n                points: gpsPoints,\r\n                totalTime: elapsedTime,\r\n                totalDistance,\r\n                avgSpeed,\r\n                maxSpeed,\r\n                date: new Date().toLocaleDateString('fr-FR'),\r\n                driverName: driverName || \"Anonyme\"\r\n            };\r\n\r\n            // Save to localStorage\r\n            const savedGhosts = localStorage.getItem(\"projectd_ghosts\");\r\n            const ghosts: GhostRun[] = savedGhosts ? JSON.parse(savedGhosts) : [];\r\n            ghosts.push(ghostRun);\r\n            localStorage.setItem(\"projectd_ghosts\", JSON.stringify(ghosts));\r\n\r\n            // Award XP and CR based on distance and speed and weather\r\n            let weatherBonus = 1.0;\r\n            if (selectedWeather === \"PLUIE\") weatherBonus = 1.2; // 20% bonus for rain\r\n            if (selectedWeather === \"NUIT\") weatherBonus = 1.1;  // 10% bonus for night\r\n\r\n            const rewards = addRewards(totalDistance, avgSpeed, weatherBonus);\r\n\r\n            // Show rewards modal instead of redirecting immediately\r\n            setRunRewards({ xp: rewards.gainedXp, cr: rewards.gainedCr, ghostId: ghostRun.id });\r\n        }\r\n    };\r\n\r\n    // Setup screen\r\n    if (!isSetupComplete) {\r\n        return (\r\n            <div className=\"min-h-screen bg-black text-white p-4 md:p-8 font-pixel\">\r\n                {/* Header */}\r\n                <header className=\"mb-8 border-b-2 border-zinc-800 pb-4\">\r\n                    <Link href=\"/\" className=\"inline-flex text-zinc-500 hover:text-toxic-cyan text-sm items-center gap-2 mb-4 uppercase tracking-widest hard-border px-3 py-1 border-2 border-transparent hover:border-toxic-cyan transition-colors\">\r\n                        <ArrowLeft size={14} /> Accueil\r\n                    </Link>\r\n                    <h1 className=\"text-3xl md:text-5xl font-bold uppercase tracking-widest text-toxic-magenta text-shadow-neon glitch-hover\">\r\n                        START RUN\r\n                    </h1>\r\n                    <p className=\"text-zinc-500 mt-2 uppercase text-xs tracking-widest\">Configure telemetry link</p>\r\n                </header>\r\n\r\n                <div className=\"max-w-2xl mx-auto space-y-8\">\r\n\r\n                    {/* Driver Name */}\r\n                    <div className=\"bg-zinc-950 p-4 border-2 border-zinc-800 hard-border shadow-[0_0_15px_rgba(0,0,0,0.5)]\">\r\n                        <label className=\"text-toxic-cyan text-[10px] md:text-xs font-bold tracking-widest uppercase block mb-2\">NOM DU PILOTE</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Ton pseudo...\"\r\n                            value={driverName}\r\n                            onChange={(e) => setDriverName(e.target.value)}\r\n                            className=\"w-full bg-black border-2 border-zinc-800 hard-border focus:border-toxic-cyan placeholder-zinc-700 outline-none px-4 py-3 text-lg text-white\"\r\n                        />\r\n                    </div>\r\n\r\n                    {/* Car Selection */}\r\n                    <div className=\"bg-zinc-950 p-4 border-2 border-zinc-800 hard-border shadow-[0_0_15px_rgba(0,0,0,0.5)]\">\r\n                        <label className=\"text-toxic-magenta text-[10px] md:text-xs font-bold tracking-widest uppercase block mb-3 flex items-center gap-2\">\r\n                            <CarIcon size={14} /> S√âLECTIONNE TA VOITURE\r\n                        </label>\r\n                        {cars.length === 0 ? (\r\n                            <Link\r\n                                href=\"/cars\"\r\n                                className=\"block w-full bg-black border-2 border-dashed border-zinc-800 hard-border p-6 text-center text-zinc-500 hover:border-toxic-cyan hover:text-toxic-cyan transition-colors uppercase tracking-widest text-sm\"\r\n                            >\r\n                                Aucune voiture ‚Üí Aller au Garage\r\n                            </Link>\r\n                        ) : (\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n                                {cars.map(car => (\r\n                                    <button\r\n                                        key={car.id}\r\n                                        onClick={() => setSelectedCar(car)}\r\n                                        className={`p-4 border-2 text-left hard-border transition-colors ${selectedCar?.id === car.id\r\n                                            ? \"bg-toxic-magenta/20 border-toxic-magenta text-toxic-magenta shadow-[0_0_10px_rgba(255,0,255,0.2)]\"\r\n                                            : \"bg-black border-zinc-800 text-zinc-400 hover:border-zinc-500\"\r\n                                            }`}\r\n                                    >\r\n                                        <div className=\"font-bold uppercase tracking-widest\">{car.name}</div>\r\n                                        <div className=\"text-[10px] text-zinc-500 mt-1 uppercase\">\r\n                                            {car.power}ch ‚Ä¢ {car.weight}kg ‚Ä¢ {car.drivetrain}\r\n                                        </div>\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Touge Selection */}\r\n                    <div className=\"bg-zinc-950 p-4 border-2 border-zinc-800 hard-border shadow-[0_0_15px_rgba(0,0,0,0.5)]\">\r\n                        <label className=\"text-toxic-yellow text-[10px] md:text-xs font-bold tracking-widest uppercase block mb-3 flex items-center gap-2\">\r\n                            <MapPin size={14} /> S√âLECTIONNE LE TOUGE\r\n                        </label>\r\n                        {touges.length === 0 ? (\r\n                            <Link\r\n                                href=\"/conquest/builder\"\r\n                                className=\"block w-full bg-black border-2 border-dashed border-zinc-800 hard-border p-6 text-center text-zinc-500 hover:border-toxic-yellow hover:text-toxic-yellow transition-colors uppercase tracking-widest text-sm\"\r\n                            >\r\n                                Aucun touge ‚Üí Route Builder\r\n                            </Link>\r\n                        ) : (\r\n                            <div className=\"space-y-2\">\r\n                                {touges.map(touge => (\r\n                                    <button\r\n                                        key={touge.id}\r\n                                        onClick={() => setSelectedTouge(touge)}\r\n                                        className={`w-full p-4 border-2 text-left hard-border transition-colors ${selectedTouge?.id === touge.id\r\n                                            ? \"bg-toxic-yellow/20 border-toxic-yellow text-toxic-yellow shadow-[0_0_10px_rgba(255,255,0,0.2)]\"\r\n                                            : \"bg-black border-zinc-800 text-zinc-400 hover:border-zinc-500\"\r\n                                            }`}\r\n                                    >\r\n                                        <div className=\"font-bold uppercase tracking-widest\">{touge.name}</div>\r\n                                        <div className=\"text-[10px] text-zinc-500 mt-1 uppercase\">\r\n                                            {touge.distance.toFixed(1)}km ‚Ä¢ {touge.region}\r\n                                        </div>\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Weather Selection */}\r\n                    <div className=\"bg-zinc-950 p-4 border-2 border-zinc-800 hard-border shadow-[0_0_15px_rgba(0,0,0,0.5)]\">\r\n                        <label className=\"text-toxic-green text-[10px] md:text-xs font-bold tracking-widest uppercase block mb-3\">CONDITIONS M√âT√âO</label>\r\n                        <div className=\"grid grid-cols-3 gap-3\">\r\n                            {([\"SEC\", \"PLUIE\", \"NUIT\"] as Weather[]).map(weather => {\r\n                                const isSelected = selectedWeather === weather;\r\n                                let colorClass = \"\";\r\n                                if (weather === \"SEC\") colorClass = isSelected ? \"border-white text-white shadow-[0_0_10px_rgba(255,255,255,0.4)] bg-white/10\" : \"text-zinc-500\";\r\n                                if (weather === \"PLUIE\") colorClass = isSelected ? \"border-toxic-cyan text-toxic-cyan shadow-[0_0_10px_rgba(0,255,255,0.4)] bg-toxic-cyan/10\" : \"text-zinc-500\";\r\n                                if (weather === \"NUIT\") colorClass = isSelected ? \"border-toxic-magenta text-toxic-magenta shadow-[0_0_10px_rgba(255,0,255,0.4)] bg-toxic-magenta/10\" : \"text-zinc-500\";\r\n\r\n                                return (\r\n                                    <button\r\n                                        key={weather}\r\n                                        onClick={() => setSelectedWeather(weather)}\r\n                                        className={`p-4 border-2 hard-border text-center transition-all flex flex-col items-center justify-center ${isSelected\r\n                                            ? colorClass\r\n                                            : \"bg-black border-zinc-800 hover:border-zinc-500\"\r\n                                            }`}\r\n                                    >\r\n                                        <div className=\"text-2xl md:text-3xl mb-1\">{WEATHER_INFO[weather].icon}</div>\r\n                                        <div className={`text-[10px] md:text-xs font-bold uppercase tracking-widest`}>\r\n                                            {WEATHER_INFO[weather].label}\r\n                                        </div>\r\n                                        {weather === \"PLUIE\" && <div className=\"text-[8px] md:text-[10px] text-toxic-cyan mt-1 font-bold tracking-widest\">+20% XP/CR</div>}\r\n                                        {weather === \"NUIT\" && <div className=\"text-[8px] md:text-[10px] text-toxic-magenta mt-1 font-bold tracking-widest\">+10% XP/CR</div>}\r\n                                    </button>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Start Button */}\r\n                    <button\r\n                        onClick={() => setIsSetupComplete(true)}\r\n                        disabled={!selectedCar || !selectedTouge}\r\n                        className=\"w-full py-4 bg-toxic-green text-black font-bold text-xl hard-border hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-zinc-800 disabled:text-zinc-500 transition-colors flex items-center justify-center gap-3 uppercase tracking-widest shadow-[0_0_20px_rgba(0,255,65,0.4)] glitch-hover\"\r\n                    >\r\n                        <Play size={24} />\r\n                        CONNECT TELEMETRY\r\n                    </button>\r\n                    <div className=\"h-12\" /> {/* Mobile bottom spacer */}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Recording screen\r\n    return (\r\n        <div className=\"h-[100dvh] w-full bg-black relative overflow-hidden font-pixel\">\r\n\r\n            {/* Map (full screen, behind HUD) */}\r\n            <div className=\"absolute inset-0 top-24 md:top-32 bottom-24\">\r\n                <RunMapView\r\n                    tougePoints={selectedTouge?.routeGeometry || selectedTouge?.points || []}\r\n                    currentPosition={currentPosition}\r\n                    ghostPoints={gpsPoints.map(p => [p.lat, p.lng] as LatLng)}\r\n                />\r\n            </div>\r\n\r\n            {/* UNIFIED HUD - Top (Mobile friendly) */}\r\n            <div className=\"absolute top-0 left-0 right-0 z-[1000]\">\r\n                <div className=\"bg-black/95 backdrop-blur-md border-b-2 border-zinc-800 p-3 shadow-[0_10px_30px_rgba(0,0,0,0.8)]\">\r\n\r\n                    {/* Info Row */}\r\n                    <div className=\"flex items-center justify-between border-b-2 border-zinc-800 pb-2 mb-2\">\r\n                        <div className=\"flex items-center gap-2 text-[10px] md:text-xs uppercase tracking-widest\">\r\n                            <span className=\"text-toxic-cyan font-bold truncate max-w-[80px] md:max-w-[200px]\">{selectedCar?.name}</span>\r\n                            <span className=\"text-zinc-600\">|</span>\r\n                            <span className=\"text-zinc-400 truncate max-w-[80px] md:max-w-[200px] pl-1\">{selectedTouge?.name}</span>\r\n                            <span className=\"text-base leading-none pl-1\">{WEATHER_INFO[selectedWeather].icon}</span>\r\n                        </div>\r\n                        <div className=\"text-[10px] md:text-xs font-bold tracking-widest\">\r\n                            {gpsError ? (\r\n                                <span className=\"text-red-500 animate-pulse\">{gpsError}</span>\r\n                            ) : (\r\n                                <span className=\"text-toxic-green text-shadow-[0_0_5px_rgba(0,255,65,0.5)]\">GPS: ¬±{gpsAccuracy.toFixed(0)}m</span>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Stats Row */}\r\n                    <div className=\"flex items-center justify-between\">\r\n                        {/* Left: Waypoints */}\r\n                        <div className=\"text-center w-16 md:w-24\">\r\n                            <div className=\"text-xl md:text-2xl font-bold text-toxic-magenta\">{gpsPoints.length}</div>\r\n                            <div className=\"text-zinc-600 text-[10px] uppercase tracking-widest\">PTS</div>\r\n                        </div>\r\n\r\n                        {/* Center: Timer */}\r\n                        <div className=\"text-center flex-1\">\r\n                            <div className=\"text-4xl md:text-5xl font-bold text-toxic-yellow text-shadow-[0_0_10px_rgba(255,255,0,0.3)]\">\r\n                                {formatTime(elapsedTime)}\r\n                            </div>\r\n                            {isRecording && (\r\n                                <div className=\"text-red-500 text-[10px] md:text-xs uppercase tracking-widest flex items-center justify-center gap-1 mt-1 font-bold\">\r\n                                    <span className=\"w-2 h-2 bg-red-500 rounded-none animate-pulse\"></span>\r\n                                    REC\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Right: Speed */}\r\n                        <div className=\"text-center w-20 md:w-24 border-l-2 border-zinc-800 pl-2\">\r\n                            <div className=\"text-2xl md:text-3xl font-bold text-toxic-green\">{currentSpeed.toFixed(0)}</div>\r\n                            <div className=\"text-zinc-600 text-[10px] uppercase tracking-widest border-b-2 border-zinc-800 pb-1 mb-1\">KM/H</div>\r\n                            <div className=\"text-xs md:text-sm font-bold text-zinc-400\">{maxSpeed.toFixed(0)} <span className=\"text-[8px] text-zinc-600\">MAX</span></div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* HUD - Bottom Controls */}\r\n            <div className=\"absolute bottom-6 inset-x-4 flex justify-center z-[1000]\">\r\n                {!isRecording ? (\r\n                    <button\r\n                        onClick={startRun}\r\n                        className=\"w-full md:w-auto md:min-w-[300px] flex justify-center items-center gap-2 px-8 py-3 md:py-4 bg-toxic-green text-black font-bold text-xl hard-border border-2 border-toxic-green hover:bg-white transition-colors shadow-[0_0_20px_rgba(0,255,65,0.4)] glitch-hover uppercase tracking-widest\"\r\n                    >\r\n                        <Play size={24} />\r\n                        START RUN\r\n                    </button>\r\n                ) : (\r\n                    <button\r\n                        onClick={stopRun}\r\n                        disabled={gpsPoints.length < 2}\r\n                        className=\"w-full md:w-auto md:min-w-[300px] flex justify-center items-center gap-2 px-8 py-3 md:py-4 bg-toxic-magenta text-white font-bold text-xl hard-border border-2 border-toxic-magenta hover:bg-white hover:text-black disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-[0_0_20px_rgba(255,0,255,0.4)] glitch-hover uppercase tracking-widest\"\r\n                    >\r\n                        <Square size={24} />\r\n                        STOP RUN\r\n                    </button>\r\n                )}\r\n            </div>\r\n\r\n            {/* REWARDS MODAL */}\r\n            <AnimatePresence>\r\n                {runRewards && (\r\n                    <motion.div\r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        className=\"absolute inset-0 z-[2000] bg-black/90 backdrop-blur-md flex items-center justify-center p-4\"\r\n                    >\r\n                        <motion.div\r\n                            initial={{ scale: 0.9, y: 20 }}\r\n                            animate={{ scale: 1, y: 0 }}\r\n                            className=\"bg-black border-2 border-toxic-yellow hard-border p-6 md:p-8 max-w-md w-full text-center shadow-[0_0_30px_rgba(255,255,0,0.3)]\"\r\n                        >\r\n                            <Trophy size={48} className=\"text-toxic-yellow mx-auto mb-4\" />\r\n                            <h2 className=\"text-2xl md:text-3xl font-bold uppercase tracking-widest text-toxic-yellow mb-2 text-shadow-[0_0_10px_rgba(255,255,0,0.5)] glitch-hover\">\r\n                                TELEMETRY SAVED\r\n                            </h2>\r\n                            <p className=\"text-zinc-500 text-xs md:text-sm uppercase tracking-widest mb-8 border-b-2 border-zinc-800 pb-4\">\r\n                                Donn√©es de t√©l√©m√©trie transf√©r√©es au Network.\r\n                            </p>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-4 mb-8\">\r\n                                <div className=\"bg-zinc-950 border-2 border-zinc-800 hard-border p-3\">\r\n                                    <div className=\"text-zinc-500 text-[10px] uppercase tracking-widest mb-1\">EXP√âRIENCE</div>\r\n                                    <div className=\"text-xl md:text-2xl font-bold text-toxic-yellow\">+{runRewards.xp} <span className=\"text-xs\">XP</span></div>\r\n                                </div>\r\n                                <div className=\"bg-zinc-950 border-2 border-zinc-800 hard-border p-3\">\r\n                                    <div className=\"text-zinc-500 text-[10px] uppercase tracking-widest mb-1\">CR√âDITS</div>\r\n                                    <div className=\"text-xl md:text-2xl font-bold text-toxic-green\">+{runRewards.cr} <span className=\"text-xs\">CR</span></div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <button\r\n                                onClick={() => router.push(`/ghosts/detail?id=${runRewards.ghostId}`)}\r\n                                className=\"w-full py-4 bg-toxic-yellow border-2 border-toxic-yellow text-black uppercase tracking-widest font-bold text-sm md:text-lg hover:bg-white hard-border transition-colors shadow-[0_0_15px_rgba(255,255,0,0.4)]\"\r\n                            >\r\n                                CONTINUER ({selectedWeather === \"PLUIE\" ? \"BONUS PLUIE\" : selectedWeather === \"NUIT\" ? \"BONUS NUIT\" : \"BASE\"}) ‚Üí\r\n                            </button>\r\n                        </motion.div>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\sw.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\touge\\[id]\\TougeDetailClient.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Ruler' is defined but never used.","line":10,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingDown' is defined but never used.","line":10,"column":38,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":50},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":40,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":17},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\touge\\[id]\\TougeDetailClient.tsx:46:13\n  44 |         const found = allCircuits.find(c => c.id === id);\n  45 |         if (found) {\n> 46 |             setCircuit(found);\n     |             ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  47 |         }\n  48 |     }, [id]);\n  49 |","line":46,"column":13,"nodeType":null,"endLine":46,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\n// Remove useParams since we can pass id as prop\r\n// import { useParams, useRouter } from \"next/navigation\"; \r\nimport { useRouter } from \"next/navigation\";\r\nimport dynamic from \"next/dynamic\";\r\nimport Link from \"next/link\";\r\nimport {\r\n    ArrowLeft, MapPin, Ruler, Clock, TrendingDown,\r\n    Mountain, Flag, Route as RouteIcon\r\n} from \"lucide-react\";\r\nimport { motion } from \"framer-motion\";\r\nimport type { TougeCircuit } from \"../types\";\r\nimport { allCircuits } from \"../data\";\r\n\r\n// Dynamic import for the map\r\nconst TougeMapView = dynamic(() => import(\"./TougeMapView\"), {\r\n    ssr: false,\r\n    loading: () => (\r\n        <div className=\"w-full h-full bg-zinc-900 flex items-center justify-center\">\r\n            <div className=\"text-zinc-500 font-mono animate-pulse\">LOADING MAP...</div>\r\n        </div>\r\n    )\r\n});\r\n\r\nconst difficultyColors = {\r\n    EASY: \"bg-green-500/20 text-green-500 border-green-500\",\r\n    MEDIUM: \"bg-blue-500/20 text-blue-500 border-blue-500\",\r\n    HARD: \"bg-orange-500/20 text-orange-500 border-orange-500\",\r\n    LEGENDARY: \"bg-yellow-500/20 text-yellow-500 border-yellow-500\",\r\n};\r\n\r\ninterface TougeDetailClientProps {\r\n    id: string;\r\n}\r\n\r\nexport default function TougeDetailClient({ id }: TougeDetailClientProps) {\r\n    // const params = useParams(); // No longer needed\r\n    const router = useRouter();\r\n    const [circuit, setCircuit] = useState<TougeCircuit | null>(null);\r\n\r\n    useEffect(() => {\r\n        const found = allCircuits.find(c => c.id === id);\r\n        if (found) {\r\n            setCircuit(found);\r\n        }\r\n    }, [id]);\r\n\r\n    if (!circuit) {\r\n        return (\r\n            <div className=\"min-h-screen bg-zinc-950 text-zinc-100 flex items-center justify-center\">\r\n                <div className=\"text-zinc-500\">Circuit non trouv√©...</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"h-screen w-full bg-zinc-950 relative overflow-hidden\">\r\n\r\n            {/* MAP (Full screen) */}\r\n            <div className=\"absolute inset-0\">\r\n                <TougeMapView routePoints={circuit.routePoints} />\r\n            </div>\r\n\r\n            {/* HUD - Header */}\r\n            <motion.div\r\n                initial={{ y: -50, opacity: 0 }}\r\n                animate={{ y: 0, opacity: 1 }}\r\n                className=\"absolute top-4 left-4 right-4 z-[1000]\"\r\n            >\r\n                <div className=\"bg-zinc-950/90 backdrop-blur-md border border-zinc-800 rounded p-4\">\r\n                    <div className=\"flex items-center justify-between flex-wrap gap-4\">\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <Link\r\n                                href=\"/touge\"\r\n                                className=\"text-zinc-400 hover:text-yellow-500 transition-colors\"\r\n                            >\r\n                                <ArrowLeft size={24} />\r\n                            </Link>\r\n                            <div>\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <h1 className=\"text-2xl font-bold text-yellow-500\">{circuit.name}</h1>\r\n                                    <span className={`px-2 py-1 text-xs font-bold border ${difficultyColors[circuit.difficulty]}`}>\r\n                                        {circuit.difficulty}\r\n                                    </span>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-3 mt-1 text-sm text-zinc-500\">\r\n                                    <span className=\"flex items-center gap-1\">\r\n                                        <MapPin size={14} />\r\n                                        {circuit.location}\r\n                                    </span>\r\n                                    <span className=\"text-zinc-700\">|</span>\r\n                                    <span>{circuit.country}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </motion.div>\r\n\r\n            {/* HUD - Stats Panel */}\r\n            <motion.div\r\n                initial={{ x: 50, opacity: 0 }}\r\n                animate={{ x: 0, opacity: 1 }}\r\n                transition={{ delay: 0.2 }}\r\n                className=\"absolute top-28 right-4 z-[1000]\"\r\n            >\r\n                <div className=\"bg-zinc-950/90 backdrop-blur-md border border-zinc-800 rounded p-4 space-y-4 w-72\">\r\n\r\n                    {/* Distance */}\r\n                    <div className=\"text-center py-2\">\r\n                        <div className=\"text-5xl font-bold text-yellow-500\">{circuit.lengthKm}</div>\r\n                        <div className=\"text-zinc-500 text-sm\">KILOM√àTRES</div>\r\n                    </div>\r\n\r\n                    <div className=\"border-t border-zinc-800\" />\r\n\r\n                    {/* Description */}\r\n                    <p className=\"text-zinc-400 text-sm leading-relaxed\">{circuit.description}</p>\r\n\r\n                    <div className=\"border-t border-zinc-800\" />\r\n\r\n                    {/* Stats Grid */}\r\n                    <div className=\"grid grid-cols-2 gap-3\">\r\n                        <div className=\"bg-zinc-800/50 p-3 rounded\">\r\n                            <div className=\"text-zinc-500 text-xs flex items-center gap-1\">\r\n                                <RouteIcon size={10} /> Points\r\n                            </div>\r\n                            <div className=\"text-zinc-100 font-bold\">{circuit.routePoints.length}</div>\r\n                        </div>\r\n                        <div className=\"bg-zinc-800/50 p-3 rounded\">\r\n                            <div className=\"text-zinc-500 text-xs flex items-center gap-1\">\r\n                                <Mountain size={10} /> Pays\r\n                            </div>\r\n                            <div className=\"text-zinc-100 font-bold\">{circuit.country}</div>\r\n                        </div>\r\n                        {circuit.record && (\r\n                            <div className=\"bg-zinc-800/50 p-3 rounded col-span-2\">\r\n                                <div className=\"text-zinc-500 text-xs flex items-center gap-1\">\r\n                                    <Clock size={10} /> Record\r\n                                </div>\r\n                                <div className=\"text-yellow-500 font-bold text-lg\">{circuit.record}</div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"border-t border-zinc-800\" />\r\n\r\n                    {/* Coordinates */}\r\n                    <div className=\"space-y-2 text-xs\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <Flag size={12} className=\"text-green-500\" />\r\n                            <span className=\"text-zinc-500\">D√©part:</span>\r\n                            <span className=\"text-zinc-300 font-mono\">\r\n                                {circuit.routePoints[0][0].toFixed(4)}, {circuit.routePoints[0][1].toFixed(4)}\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <Flag size={12} className=\"text-red-500\" />\r\n                            <span className=\"text-zinc-500\">Arriv√©e:</span>\r\n                            <span className=\"text-zinc-300 font-mono\">\r\n                                {circuit.routePoints[circuit.routePoints.length - 1][0].toFixed(4)}, {circuit.routePoints[circuit.routePoints.length - 1][1].toFixed(4)}\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </motion.div>\r\n\r\n            {/* Legend */}\r\n            <motion.div\r\n                initial={{ y: 50, opacity: 0 }}\r\n                animate={{ y: 0, opacity: 1 }}\r\n                transition={{ delay: 0.3 }}\r\n                className=\"absolute bottom-4 left-4 z-[1000]\"\r\n            >\r\n                <div className=\"bg-zinc-950/90 backdrop-blur-md border border-zinc-800 rounded px-4 py-2 flex items-center gap-4 text-xs\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <span className=\"w-3 h-3 rounded-full bg-green-500\"></span>\r\n                        <span className=\"text-zinc-400\">D√©part</span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <span className=\"w-3 h-3 rounded-full bg-red-500\"></span>\r\n                        <span className=\"text-zinc-400\">Arriv√©e</span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <span className=\"w-6 h-1 bg-yellow-500 rounded\"></span>\r\n                        <span className=\"text-zinc-400\">Trac√©</span>\r\n                    </div>\r\n                </div>\r\n            </motion.div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\touge\\[id]\\TougeMapView.tsx","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":20,"column":23,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":20,"endColumn":41}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect } from \"react\";\r\nimport { MapContainer, TileLayer, Polyline, CircleMarker, useMap } from \"react-leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport type { LatLngBounds } from \"leaflet\";\r\n\r\ntype LatLng = [number, number];\r\n\r\ninterface TougeMapViewProps {\r\n    routePoints: LatLng[];\r\n}\r\n\r\n// Fit map to route bounds\r\nfunction FitBounds({ points }: { points: LatLng[] }) {\r\n    const map = useMap();\r\n\r\n    useEffect(() => {\r\n        if (points.length > 0) {\r\n            const L = require(\"leaflet\");\r\n            const bounds: LatLngBounds = L.latLngBounds(points);\r\n            map.fitBounds(bounds, { padding: [80, 80] });\r\n        }\r\n    }, [map, points]);\r\n\r\n    return null;\r\n}\r\n\r\nexport default function TougeMapView({ routePoints }: TougeMapViewProps) {\r\n    const defaultCenter: LatLng = routePoints.length > 0 ? routePoints[0] : [46.2276, 2.2137];\r\n\r\n    return (\r\n        <MapContainer\r\n            center={defaultCenter}\r\n            zoom={13}\r\n            className=\"w-full h-full\"\r\n            style={{ background: \"#0a0a0a\" }}\r\n            zoomControl={false}\r\n        >\r\n            <TileLayer\r\n                attribution='&copy; <a href=\"https://carto.com/\">CARTO</a>'\r\n                url=\"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png\"\r\n            />\r\n\r\n            <FitBounds points={routePoints} />\r\n\r\n            {/* Outer glow effect */}\r\n            {routePoints.length >= 2 && (\r\n                <Polyline\r\n                    positions={routePoints}\r\n                    pathOptions={{\r\n                        color: \"#facc15\",\r\n                        weight: 18,\r\n                        opacity: 0.15,\r\n                        lineCap: \"round\",\r\n                        lineJoin: \"round\",\r\n                    }}\r\n                />\r\n            )}\r\n\r\n            {/* Main route line */}\r\n            {routePoints.length >= 2 && (\r\n                <Polyline\r\n                    positions={routePoints}\r\n                    pathOptions={{\r\n                        color: \"#facc15\",\r\n                        weight: 6,\r\n                        opacity: 0.95,\r\n                        lineCap: \"round\",\r\n                        lineJoin: \"round\",\r\n                    }}\r\n                />\r\n            )}\r\n\r\n            {/* All waypoint markers with glow */}\r\n            {routePoints.map((point, index) => (\r\n                <CircleMarker\r\n                    key={`glow-${index}`}\r\n                    center={point}\r\n                    radius={index === 0 ? 22 : index === routePoints.length - 1 ? 22 : 10}\r\n                    pathOptions={{\r\n                        color: index === 0 ? \"#22c55e\" : index === routePoints.length - 1 ? \"#ef4444\" : \"#facc15\",\r\n                        fillColor: \"transparent\",\r\n                        fillOpacity: 0,\r\n                        weight: 3,\r\n                        opacity: 0.3,\r\n                    }}\r\n                />\r\n            ))}\r\n\r\n            {/* Waypoint circles */}\r\n            {routePoints.map((point, index) => (\r\n                <CircleMarker\r\n                    key={index}\r\n                    center={point}\r\n                    radius={index === 0 ? 14 : index === routePoints.length - 1 ? 14 : 6}\r\n                    pathOptions={{\r\n                        color: index === 0 ? \"#22c55e\" : index === routePoints.length - 1 ? \"#ef4444\" : \"#facc15\",\r\n                        fillColor: index === 0 ? \"#22c55e\" : index === routePoints.length - 1 ? \"#ef4444\" : \"#facc15\",\r\n                        fillOpacity: 0.9,\r\n                        weight: 3,\r\n                    }}\r\n                />\r\n            ))}\r\n        </MapContainer>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\touge\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\touge\\data.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'LatLng' is defined but never used.","line":1,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type { LatLng, TougeCircuit } from \"./types\";\r\n\r\n// === CIRCUITS JAPONAIS ===\r\nconst japaneseCircuits: TougeCircuit[] = [\r\n    {\r\n        id: \"akina\",\r\n        name: \"AKINA\",\r\n        location: \"Gunma Prefecture\",\r\n        country: \"Japon\",\r\n        length: \"4.2 km\",\r\n        lengthKm: 4.2,\r\n        difficulty: \"LEGENDARY\",\r\n        record: \"4:02.38\",\r\n        description: \"Le Mont Haruna, connu sous le nom d'Akina dans Initial D. La piste de descente l√©gendaire de Takumi Fujiwara.\",\r\n        routePoints: [\r\n            [36.4858, 138.9456], [36.4842, 138.9478], [36.4823, 138.9495],\r\n            [36.4801, 138.9512], [36.4778, 138.9534], [36.4756, 138.9551],\r\n            [36.4733, 138.9567], [36.4711, 138.9589], [36.4689, 138.9612],\r\n            [36.4667, 138.9634],\r\n        ],\r\n    },\r\n    {\r\n        id: \"akagi\",\r\n        name: \"AKAGI\",\r\n        location: \"Gunma Prefecture\",\r\n        country: \"Japon\",\r\n        length: \"5.1 km\",\r\n        lengthKm: 5.1,\r\n        difficulty: \"HARD\",\r\n        record: \"3:58.12\",\r\n        description: \"Le Mont Akagi, territoire des RedSuns. C√©l√®bre pour ses virages en √©pingle.\",\r\n        routePoints: [\r\n            [36.5567, 139.1789], [36.5545, 139.1812], [36.5523, 139.1834],\r\n            [36.5498, 139.1856], [36.5476, 139.1878], [36.5451, 139.1901],\r\n            [36.5429, 139.1923], [36.5404, 139.1945], [36.5382, 139.1967],\r\n            [36.5357, 139.1989], [36.5335, 139.2012],\r\n        ],\r\n    },\r\n    {\r\n        id: \"irohazaka\",\r\n        name: \"IROHAZAKA\",\r\n        location: \"Tochigi Prefecture\",\r\n        country: \"Japon\",\r\n        length: \"6.5 km\",\r\n        lengthKm: 6.5,\r\n        difficulty: \"LEGENDARY\",\r\n        record: \"5:12.00\",\r\n        description: \"Les c√©l√®bres lacets d'Irohazaka. 48 virages nomm√©s d'apr√®s l'alphabet japonais.\",\r\n        routePoints: [\r\n            [36.7456, 139.4823], [36.7434, 139.4845], [36.7412, 139.4867],\r\n            [36.7389, 139.4889], [36.7367, 139.4912], [36.7345, 139.4934],\r\n            [36.7323, 139.4956], [36.7301, 139.4978], [36.7278, 139.5001],\r\n            [36.7256, 139.5023], [36.7234, 139.5045], [36.7212, 139.5067],\r\n        ],\r\n    },\r\n    {\r\n        id: \"myogi\",\r\n        name: \"MYOGI\",\r\n        location: \"Gunma Prefecture\",\r\n        country: \"Japon\",\r\n        length: \"3.8 km\",\r\n        lengthKm: 3.8,\r\n        difficulty: \"MEDIUM\",\r\n        record: \"3:24.55\",\r\n        description: \"Les routes sinueuses du Mont Myogi. Terrain des Night Kids.\",\r\n        routePoints: [\r\n            [36.2978, 138.7456], [36.2956, 138.7478], [36.2934, 138.7501],\r\n            [36.2912, 138.7523], [36.2889, 138.7545], [36.2867, 138.7567],\r\n            [36.2845, 138.7589], [36.2823, 138.7612],\r\n        ],\r\n    },\r\n    {\r\n        id: \"usui\",\r\n        name: \"USUI PASS\",\r\n        location: \"Gunma/Nagano Border\",\r\n        country: \"Japon\",\r\n        length: \"4.0 km\",\r\n        lengthKm: 4.0,\r\n        difficulty: \"HARD\",\r\n        description: \"Le col d'Usui, route historique entre Gunma et Nagano.\",\r\n        routePoints: [\r\n            [36.3456, 138.6123], [36.3434, 138.6145], [36.3412, 138.6167],\r\n            [36.3389, 138.6189], [36.3367, 138.6212], [36.3345, 138.6234],\r\n            [36.3323, 138.6256], [36.3301, 138.6278], [36.3278, 138.6301],\r\n        ],\r\n    },\r\n    {\r\n        id: \"shomaru\",\r\n        name: \"SHOMARU PASS\",\r\n        location: \"Saitama Prefecture\",\r\n        country: \"Japon\",\r\n        length: \"3.2 km\",\r\n        lengthKm: 3.2,\r\n        difficulty: \"EASY\",\r\n        description: \"Un col plus accessible, parfait pour les d√©butants.\",\r\n        routePoints: [\r\n            [35.9456, 139.0123], [35.9434, 139.0145], [35.9412, 139.0167],\r\n            [35.9389, 139.0189], [35.9367, 139.0212], [35.9345, 139.0234],\r\n            [35.9323, 139.0256],\r\n        ],\r\n    },\r\n];\r\n\r\n// === CIRCUITS FRAN√áAIS ===\r\nconst frenchCircuits: TougeCircuit[] = [\r\n    // ALPES\r\n    {\r\n        id: \"galibier\",\r\n        name: \"COL DU GALIBIER\",\r\n        location: \"Alpes\",\r\n        country: \"France\",\r\n        length: \"18.1 km\",\r\n        lengthKm: 18.1,\r\n        difficulty: \"LEGENDARY\",\r\n        description: \"√Ä 2642m d'altitude, l'un des cols les plus hauts des Alpes fran√ßaises.\",\r\n        routePoints: [\r\n            [45.0642, 6.4078], [45.0598, 6.4112], [45.0554, 6.4145],\r\n            [45.0510, 6.4178], [45.0466, 6.4212], [45.0422, 6.4245],\r\n            [45.0378, 6.4278], [45.0334, 6.4312],\r\n        ],\r\n    },\r\n    {\r\n        id: \"iseran\",\r\n        name: \"COL DE L'ISERAN\",\r\n        location: \"Alpes\",\r\n        country: \"France\",\r\n        length: \"14.5 km\",\r\n        lengthKm: 14.5,\r\n        difficulty: \"LEGENDARY\",\r\n        description: \"Le plus haut col routier des Alpes √† 2764m. Route ferm√©e en hiver.\",\r\n        routePoints: [\r\n            [45.4167, 7.0306], [45.4123, 7.0345], [45.4078, 7.0389],\r\n            [45.4034, 7.0423], [45.3989, 7.0467], [45.3945, 7.0501],\r\n            [45.3901, 7.0545], [45.3856, 7.0589],\r\n        ],\r\n    },\r\n    {\r\n        id: \"izoard\",\r\n        name: \"COL DE L'IZOARD\",\r\n        location: \"Alpes\",\r\n        country: \"France\",\r\n        length: \"15.9 km\",\r\n        lengthKm: 15.9,\r\n        difficulty: \"HARD\",\r\n        description: \"C√©l√®bre pour la Casse D√©serte, un paysage lunaire unique.\",\r\n        routePoints: [\r\n            [44.8203, 6.7344], [44.8156, 6.7389], [44.8112, 6.7423],\r\n            [44.8067, 6.7467], [44.8023, 6.7512], [44.7978, 6.7556],\r\n            [44.7934, 6.7601], [44.7889, 6.7645],\r\n        ],\r\n    },\r\n    {\r\n        id: \"alpe-huez\",\r\n        name: \"ALPE D'HUEZ\",\r\n        location: \"Alpes\",\r\n        country: \"France\",\r\n        length: \"13.8 km\",\r\n        lengthKm: 13.8,\r\n        difficulty: \"LEGENDARY\",\r\n        record: \"37:35.00\",\r\n        description: \"Les 21 virages l√©gendaires. Chaque lacet porte le nom d'un vainqueur du Tour.\",\r\n        routePoints: [\r\n            [45.0922, 6.0703], [45.0878, 6.0745], [45.0834, 6.0789],\r\n            [45.0789, 6.0823], [45.0745, 6.0867], [45.0701, 6.0912],\r\n            [45.0656, 6.0956], [45.0612, 6.1001],\r\n        ],\r\n    },\r\n    {\r\n        id: \"croix-fer\",\r\n        name: \"COL DE LA CROIX DE FER\",\r\n        location: \"Alpes\",\r\n        country: \"France\",\r\n        length: \"22.0 km\",\r\n        lengthKm: 22.0,\r\n        difficulty: \"HARD\",\r\n        description: \"Un des plus longs cols alpins avec des panoramas spectaculaires.\",\r\n        routePoints: [\r\n            [45.2264, 6.2047], [45.2220, 6.2089], [45.2175, 6.2134],\r\n            [45.2131, 6.2178], [45.2086, 6.2223], [45.2042, 6.2267],\r\n            [45.1997, 6.2312], [45.1953, 6.2356],\r\n        ],\r\n    },\r\n    // C√îTE D'AZUR\r\n    {\r\n        id: \"turini\",\r\n        name: \"COL DE TURINI\",\r\n        location: \"C√¥te d'Azur\",\r\n        country: \"France\",\r\n        length: \"15.2 km\",\r\n        lengthKm: 15.2,\r\n        difficulty: \"LEGENDARY\",\r\n        record: \"12:45.00\",\r\n        description: \"C√©l√®bre √©tape du Rallye Monte-Carlo. 34 virages entre La Boll√®ne et le sommet.\",\r\n        routePoints: [\r\n            [43.9797, 7.3917], [43.9756, 7.3945], [43.9712, 7.3978],\r\n            [43.9667, 7.4012], [43.9623, 7.4045], [43.9578, 7.4078],\r\n            [43.9534, 7.4112], [43.9489, 7.4145], [43.9445, 7.4178],\r\n        ],\r\n    },\r\n    {\r\n        id: \"vence\",\r\n        name: \"COL DE VENCE\",\r\n        location: \"C√¥te d'Azur\",\r\n        country: \"France\",\r\n        length: \"9.7 km\",\r\n        lengthKm: 9.7,\r\n        difficulty: \"MEDIUM\",\r\n        description: \"Route sinueuse au-dessus de Nice avec vue sur la M√©diterran√©e.\",\r\n        routePoints: [\r\n            [43.7567, 7.0667], [43.7523, 7.0712], [43.7478, 7.0756],\r\n            [43.7434, 7.0801], [43.7389, 7.0845], [43.7345, 7.0889],\r\n        ],\r\n    },\r\n    {\r\n        id: \"braus\",\r\n        name: \"COL DE BRAUS\",\r\n        location: \"C√¥te d'Azur\",\r\n        country: \"France\",\r\n        length: \"10.5 km\",\r\n        lengthKm: 10.5,\r\n        difficulty: \"MEDIUM\",\r\n        description: \"Route technique pr√®s de la fronti√®re italienne avec de nombreux lacets.\",\r\n        routePoints: [\r\n            [43.8667, 7.3833], [43.8623, 7.3878], [43.8578, 7.3923],\r\n            [43.8534, 7.3967], [43.8489, 7.4012], [43.8445, 7.4056],\r\n        ],\r\n    },\r\n    {\r\n        id: \"bonette\",\r\n        name: \"COL DE LA BONETTE\",\r\n        location: \"C√¥te d'Azur\",\r\n        country: \"France\",\r\n        length: \"24.0 km\",\r\n        lengthKm: 24.0,\r\n        difficulty: \"LEGENDARY\",\r\n        description: \"La plus haute route d'Europe √† 2802m. D√©fi ultime pour les cyclistes.\",\r\n        routePoints: [\r\n            [44.3261, 6.8072], [44.3217, 6.8123], [44.3172, 6.8167],\r\n            [44.3128, 6.8212], [44.3083, 6.8256], [44.3039, 6.8301],\r\n            [44.2994, 6.8345], [44.2950, 6.8389],\r\n        ],\r\n    },\r\n    // PROVENCE\r\n    {\r\n        id: \"ventoux\",\r\n        name: \"MONT VENTOUX\",\r\n        location: \"Provence\",\r\n        country: \"France\",\r\n        length: \"21.5 km\",\r\n        lengthKm: 21.5,\r\n        difficulty: \"LEGENDARY\",\r\n        record: \"18:30.00\",\r\n        description: \"Le G√©ant de Provence. Une ascension mythique avec un d√©nivel√© de 1600m.\",\r\n        routePoints: [\r\n            [44.1736, 5.2789], [44.1689, 5.2823], [44.1642, 5.2856],\r\n            [44.1595, 5.2889], [44.1548, 5.2923], [44.1501, 5.2956],\r\n            [44.1454, 5.2989], [44.1407, 5.3023],\r\n        ],\r\n    },\r\n    // PYR√âN√âES\r\n    {\r\n        id: \"tourmalet\",\r\n        name: \"COL DU TOURMALET\",\r\n        location: \"Pyr√©n√©es\",\r\n        country: \"France\",\r\n        length: \"19.0 km\",\r\n        lengthKm: 19.0,\r\n        difficulty: \"LEGENDARY\",\r\n        description: \"Le plus haut col routier des Pyr√©n√©es. L√©gende du Tour de France.\",\r\n        routePoints: [\r\n            [42.9083, -0.1456], [42.9045, -0.1412], [42.9007, -0.1367],\r\n            [42.8969, -0.1323], [42.8931, -0.1278], [42.8893, -0.1234],\r\n            [42.8855, -0.1189], [42.8817, -0.1145],\r\n        ],\r\n    },\r\n    {\r\n        id: \"aubisque\",\r\n        name: \"COL D'AUBISQUE\",\r\n        location: \"Pyr√©n√©es\",\r\n        country: \"France\",\r\n        length: \"16.5 km\",\r\n        lengthKm: 16.5,\r\n        difficulty: \"HARD\",\r\n        description: \"Route spectaculaire taill√©e dans la roche avec vue sur les cimes.\",\r\n        routePoints: [\r\n            [42.9714, -0.3397], [42.9669, -0.3352], [42.9625, -0.3308],\r\n            [42.9580, -0.3263], [42.9536, -0.3219], [42.9491, -0.3174],\r\n        ],\r\n    },\r\n    {\r\n        id: \"peyresourde\",\r\n        name: \"COL DE PEYRESOURDE\",\r\n        location: \"Pyr√©n√©es\",\r\n        country: \"France\",\r\n        length: \"13.2 km\",\r\n        lengthKm: 13.2,\r\n        difficulty: \"MEDIUM\",\r\n        description: \"Passage historique entre la vall√©e de la Garonne et Luchon.\",\r\n        routePoints: [\r\n            [42.7969, 0.4492], [42.7925, 0.4537], [42.7880, 0.4582],\r\n            [42.7836, 0.4627], [42.7791, 0.4672], [42.7747, 0.4717],\r\n        ],\r\n    },\r\n    // VOSGES\r\n    {\r\n        id: \"schlucht\",\r\n        name: \"COL DE LA SCHLUCHT\",\r\n        location: \"Vosges\",\r\n        country: \"France\",\r\n        length: \"8.5 km\",\r\n        lengthKm: 8.5,\r\n        difficulty: \"EASY\",\r\n        description: \"Col embl√©matique des Vosges entre l'Alsace et la Lorraine.\",\r\n        routePoints: [\r\n            [48.0631, 7.0228], [48.0587, 7.0273], [48.0542, 7.0318],\r\n            [48.0498, 7.0363], [48.0453, 7.0408], [48.0409, 7.0453],\r\n        ],\r\n    },\r\n    {\r\n        id: \"grand-ballon\",\r\n        name: \"GRAND BALLON\",\r\n        location: \"Vosges\",\r\n        country: \"France\",\r\n        length: \"10.2 km\",\r\n        lengthKm: 10.2,\r\n        difficulty: \"MEDIUM\",\r\n        description: \"Le point culminant des Vosges √† 1424m. Vue panoramique sur la plaine d'Alsace.\",\r\n        routePoints: [\r\n            [47.9019, 7.0989], [47.8975, 7.1034], [47.8930, 7.1079],\r\n            [47.8886, 7.1124], [47.8841, 7.1169], [47.8797, 7.1214],\r\n        ],\r\n    },\r\n    // MASSIF CENTRAL\r\n    {\r\n        id: \"puy-dome\",\r\n        name: \"PUY DE D√îME\",\r\n        location: \"Massif Central\",\r\n        country: \"France\",\r\n        length: \"14.5 km\",\r\n        lengthKm: 14.5,\r\n        difficulty: \"HARD\",\r\n        description: \"Ancien volcan et √©tape mythique du Tour de France. Route spectaculaire.\",\r\n        routePoints: [\r\n            [45.7725, 2.9644], [45.7681, 2.9689], [45.7636, 2.9734],\r\n            [45.7592, 2.9779], [45.7547, 2.9824], [45.7503, 2.9869],\r\n        ],\r\n    },\r\n    // √éLE-DE-FRANCE\r\n    {\r\n        id: \"fontainebleau\",\r\n        name: \"FOR√äT DE FONTAINEBLEAU\",\r\n        location: \"√éle-de-France\",\r\n        country: \"France\",\r\n        length: \"12.0 km\",\r\n        lengthKm: 12.0,\r\n        difficulty: \"EASY\",\r\n        description: \"Routes sinueuses dans la for√™t royale. Parfait pour s'entra√Æner pr√®s de Paris.\",\r\n        routePoints: [\r\n            [48.4150, 2.6800], [48.4135, 2.6850], [48.4110, 2.6880],\r\n            [48.4080, 2.6920], [48.4060, 2.6980], [48.4085, 2.7030],\r\n            [48.4100, 2.7090], [48.4075, 2.7140], [48.4045, 2.7180],\r\n            [48.4020, 2.7230], [48.4000, 2.7290], [48.3970, 2.7340],\r\n            [48.3940, 2.7380], [48.3920, 2.7430], [48.3895, 2.7480],\r\n        ],\r\n    },\r\n    {\r\n        id: \"rambouillet\",\r\n        name: \"FOR√äT DE RAMBOUILLET\",\r\n        location: \"√éle-de-France\",\r\n        country: \"France\",\r\n        length: \"15.5 km\",\r\n        lengthKm: 15.5,\r\n        difficulty: \"EASY\",\r\n        description: \"Routes foresti√®res tranquilles dans l'ancienne for√™t de chasse royale.\",\r\n        routePoints: [\r\n            [48.6550, 1.8100], [48.6520, 1.8150], [48.6480, 1.8180],\r\n            [48.6450, 1.8230], [48.6420, 1.8280], [48.6380, 1.8250],\r\n            [48.6350, 1.8300], [48.6320, 1.8360], [48.6280, 1.8340],\r\n            [48.6250, 1.8400], [48.6220, 1.8450], [48.6180, 1.8480],\r\n            [48.6150, 1.8530], [48.6120, 1.8580], [48.6090, 1.8620],\r\n        ],\r\n    },\r\n    {\r\n        id: \"chevreuse\",\r\n        name: \"VALL√âE DE CHEVREUSE\",\r\n        location: \"√éle-de-France\",\r\n        country: \"France\",\r\n        length: \"18.0 km\",\r\n        lengthKm: 18.0,\r\n        difficulty: \"MEDIUM\",\r\n        description: \"Le 'mini-touge' pr√®s de Paris. Virages techniques dans un cadre vallonn√©.\",\r\n        routePoints: [\r\n            [48.7200, 2.0200], [48.7170, 2.0250], [48.7130, 2.0220],\r\n            [48.7100, 2.0280], [48.7070, 2.0340], [48.7040, 2.0300],\r\n            [48.7010, 2.0360], [48.6980, 2.0420], [48.6950, 2.0380],\r\n            [48.6920, 2.0440], [48.6890, 2.0500], [48.6860, 2.0460],\r\n            [48.6830, 2.0520], [48.6800, 2.0570], [48.6770, 2.0620],\r\n            [48.6740, 2.0580], [48.6710, 2.0640], [48.6680, 2.0700],\r\n        ],\r\n    },\r\n    {\r\n        id: \"vexin\",\r\n        name: \"ROUTES DU VEXIN\",\r\n        location: \"√éle-de-France\",\r\n        country: \"France\",\r\n        length: \"22.0 km\",\r\n        lengthKm: 22.0,\r\n        difficulty: \"MEDIUM\",\r\n        description: \"Paysages vallonn√©s du Parc naturel r√©gional au nord-ouest de Paris.\",\r\n        routePoints: [\r\n            [49.1200, 1.7300], [49.1160, 1.7360], [49.1120, 1.7320],\r\n            [49.1080, 1.7380], [49.1040, 1.7440], [49.1000, 1.7400],\r\n            [49.0960, 1.7460], [49.0920, 1.7520], [49.0880, 1.7480],\r\n            [49.0840, 1.7540], [49.0800, 1.7600], [49.0760, 1.7560],\r\n            [49.0720, 1.7620], [49.0680, 1.7680], [49.0640, 1.7640],\r\n            [49.0600, 1.7700], [49.0560, 1.7760], [49.0520, 1.7820],\r\n        ],\r\n    },\r\n    {\r\n        id: \"compiegne\",\r\n        name: \"FOR√äT DE COMPI√àGNE\",\r\n        location: \"√éle-de-France\",\r\n        country: \"France\",\r\n        length: \"20.0 km\",\r\n        lengthKm: 20.0,\r\n        difficulty: \"EASY\",\r\n        description: \"Grande for√™t domaniale avec routes techniques et longues lignes droites.\",\r\n        routePoints: [\r\n            [49.4000, 2.8800], [49.3970, 2.8860], [49.3930, 2.8820],\r\n            [49.3900, 2.8880], [49.3860, 2.8940], [49.3830, 2.8900],\r\n            [49.3790, 2.8960], [49.3760, 2.9020], [49.3720, 2.8980],\r\n            [49.3690, 2.9040], [49.3650, 2.9100], [49.3620, 2.9060],\r\n            [49.3580, 2.9120], [49.3550, 2.9180], [49.3510, 2.9240],\r\n        ],\r\n    },\r\n];\r\n\r\n// Export all circuits combined\r\nexport const allCircuits: TougeCircuit[] = [...japaneseCircuits, ...frenchCircuits];\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\touge\\page.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\touge\\page.tsx:71:17\n  69 |                         : route.points,\n  70 |                 }));\n> 71 |                 setCircuits(convertedRoutes);\n     |                 ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  72 |             } catch { }\n  73 |         }\n  74 |     }, []);","line":71,"column":17,"nodeType":null,"endLine":71,"endColumn":28}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { MapPin, Clock, ChevronRight, Route, Eye, Plus } from \"lucide-react\";\r\nimport { motion } from \"framer-motion\";\r\n\r\n// --- TYPES ---\r\ntype LatLng = [number, number];\r\n\r\ntype TougeCircuit = {\r\n    id: string;\r\n    name: string;\r\n    location: string;\r\n    country: string;\r\n    length: string;\r\n    lengthKm: number;\r\n    difficulty: \"EASY\" | \"MEDIUM\" | \"HARD\" | \"LEGENDARY\";\r\n    record?: string;\r\n    description: string;\r\n    routePoints: LatLng[];\r\n};\r\n\r\nconst difficultyColors = {\r\n    EASY: \"text-toxic-green border-toxic-green bg-toxic-green/10\",\r\n    MEDIUM: \"text-toxic-cyan border-toxic-cyan bg-toxic-cyan/10\",\r\n    HARD: \"text-toxic-magenta border-toxic-magenta bg-toxic-magenta/10\",\r\n    LEGENDARY: \"text-toxic-yellow border-toxic-yellow bg-toxic-yellow/10 animate-pulse\",\r\n};\r\n\r\n// Storage key matching the Route Builder\r\nconst ROUTES_STORAGE_KEY = \"projectd_routes\";\r\n\r\ntype UserRoute = {\r\n    id: string;\r\n    name: string;\r\n    points: LatLng[];\r\n    routeGeometry?: LatLng[];\r\n    distance: number;\r\n    createdAt: string;\r\n    type: \"DOWNHILL\" | \"UPHILL\" | \"MIXED\";\r\n    difficulty: \"EASY\" | \"MEDIUM\" | \"HARD\" | \"LEGENDARY\";\r\n    region: string;\r\n};\r\n\r\nexport default function TougePage() {\r\n    const [circuits, setCircuits] = useState<TougeCircuit[]>([]);\r\n    const [selectedId, setSelectedId] = useState<string | null>(null);\r\n    const [regionFilter, setRegionFilter] = useState<string>(\"ALL\");\r\n\r\n    // Load user-created routes from localStorage\r\n    useEffect(() => {\r\n        const saved = localStorage.getItem(ROUTES_STORAGE_KEY);\r\n        if (saved) {\r\n            try {\r\n                const userRoutes: UserRoute[] = JSON.parse(saved);\r\n                // Convert user routes to TougeCircuit format\r\n                const convertedRoutes: TougeCircuit[] = userRoutes.map(route => ({\r\n                    id: `user-${route.id}`,\r\n                    name: route.name.toUpperCase(),\r\n                    location: route.region || \"Personnalis√©\",\r\n                    country: \"Mes Cr√©ations\",\r\n                    length: `${route.distance.toFixed(1)} km`,\r\n                    lengthKm: route.distance,\r\n                    difficulty: route.difficulty,\r\n                    description: `Trac√© cr√©√© le ${route.createdAt}. Type: ${route.type}.`,\r\n                    routePoints: route.routeGeometry && route.routeGeometry.length > 0\r\n                        ? route.routeGeometry\r\n                        : route.points,\r\n                }));\r\n                setCircuits(convertedRoutes);\r\n            } catch { }\r\n        }\r\n    }, []);\r\n\r\n    // Get available regions\r\n    const availableRegions = [...new Set(circuits.map(c => c.location))];\r\n\r\n    // Filter circuits by region\r\n    const filteredCircuits = circuits.filter(c =>\r\n        regionFilter === \"ALL\" || c.location === regionFilter\r\n    );\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-black text-zinc-100 p-8 font-pixel\">\r\n\r\n            {/* HEADER */}\r\n            <header className=\"mb-8 border-b-2 border-zinc-800 pb-4\">\r\n                <h1 className=\"text-4xl font-bold italic tracking-tighter text-toxic-magenta glitch-hover text-shadow-neon\">\r\n                    PROJECT D // TOUGE\r\n                </h1>\r\n                <p className=\"text-zinc-500 mt-2 font-bold tracking-widest\">TES TRAC√âS PERSONNELS</p>\r\n            </header>\r\n\r\n            {/* CREATE NEW BUTTON */}\r\n            <Link\r\n                href=\"/conquest/builder\"\r\n                className=\"inline-flex items-center gap-3 bg-toxic-green text-black hover:bg-white px-6 py-3 font-bold transition-colors mb-8 hard-border shadow-[0_0_15px_rgba(0,255,65,0.4)]\"\r\n            >\r\n                <Plus size={20} />\r\n                CR√âER UN NOUVEAU TOUGE (GPS)\r\n            </Link>\r\n\r\n            {/* FILTER - Region (only show if there are routes) */}\r\n            {availableRegions.length > 0 && (\r\n                <div className=\"flex items-center gap-3 mb-8 bg-zinc-950 border-2 border-zinc-800 p-2 hard-border w-max\">\r\n                    <span className=\"text-zinc-500 text-xs font-bold px-2\">R√âGION</span>\r\n                    <div className=\"flex flex-wrap gap-2\">\r\n                        <button\r\n                            onClick={() => setRegionFilter(\"ALL\")}\r\n                            className={`px-4 py-1.5 text-xs font-bold transition-colors hard-border border-2 ${regionFilter === \"ALL\"\r\n                                ? \"bg-toxic-cyan border-toxic-cyan text-black\"\r\n                                : \"bg-black border-zinc-800 text-zinc-400 hover:border-zinc-500\"\r\n                                }`}\r\n                        >\r\n                            TOUS\r\n                        </button>\r\n                        {availableRegions.map((region) => (\r\n                            <button\r\n                                key={region}\r\n                                onClick={() => setRegionFilter(region)}\r\n                                className={`px-4 py-1.5 text-xs font-bold transition-colors hard-border border-2 uppercase ${regionFilter === region\r\n                                    ? \"bg-toxic-cyan border-toxic-cyan text-black\"\r\n                                    : \"bg-black border-zinc-800 text-zinc-400 hover:border-zinc-500\"\r\n                                    }`}\r\n                            >\r\n                                {region}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* EMPTY STATE */}\r\n            {circuits.length === 0 ? (\r\n                <div className=\"text-center py-16 border-2 border-dashed border-zinc-800 hard-border bg-zinc-950/50\">\r\n                    <Route size={48} className=\"mx-auto text-zinc-700 mb-4\" />\r\n                    <h2 className=\"text-xl font-bold text-zinc-400 mb-2 uppercase\">Aucun touge enregistr√©</h2>\r\n                    <p className=\"text-zinc-600 mb-6 max-w-md mx-auto font-bold tracking-wide\">\r\n                        Cr√©e ton premier touge en utilisant le mode GPS ! Roule sur ta route pr√©f√©r√©e et le site enregistrera ton trac√© en temps r√©el.\r\n                    </p>\r\n                    <Link\r\n                        href=\"/conquest/builder\"\r\n                        className=\"inline-flex items-center gap-2 bg-toxic-green text-black hover:bg-white px-6 py-3 font-bold transition-colors hard-border shadow-[0_0_15px_rgba(0,255,65,0.4)]\"\r\n                    >\r\n                        <Plus size={20} />\r\n                        CREATE FIRST ROUTE\r\n                    </Link>\r\n                </div>\r\n            ) : (\r\n                <>\r\n                    {/* CIRCUIT LIST */}\r\n                    <div className=\"space-y-4\">\r\n                        {filteredCircuits.map((circuit, index) => (\r\n                            <motion.div\r\n                                key={circuit.id}\r\n                                initial={{ opacity: 0, y: 20 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                transition={{ delay: index * 0.05 }}\r\n                                className={`\r\n                                    bg-zinc-950 border-2 border-zinc-800 hard-border\r\n                                    hover:border-toxic-cyan transition-all duration-300\r\n                                    ${selectedId === circuit.id ? \"border-toxic-cyan bg-[#050510]\" : \"\"}\r\n                                `}\r\n                            >\r\n                                {/* Main Info - Clickable Header */}\r\n                                <div\r\n                                    onClick={() => setSelectedId(selectedId === circuit.id ? null : circuit.id)}\r\n                                    className=\"p-4 cursor-pointer\"\r\n                                >\r\n                                    <div className=\"flex justify-between items-center\">\r\n                                        <div className=\"flex items-center gap-4\">\r\n                                            <span className=\"text-zinc-600 text-xs w-8 font-bold\">#{String(index + 1).padStart(2, \"0\")}</span>\r\n                                            <div>\r\n                                                <h3 className=\"text-2xl font-bold text-white uppercase tracking-wider\">{circuit.name}</h3>\r\n                                                <div className=\"flex items-center gap-1 text-zinc-500 text-xs font-bold mt-1 uppercase\">\r\n                                                    <MapPin size={12} />\r\n                                                    <span>{circuit.location}</span>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"flex items-center gap-6\">\r\n                                            {/* Length */}\r\n                                            <div className=\"hidden md:flex items-center gap-2 text-zinc-400 font-bold text-sm\">\r\n                                                <Route size={14} />\r\n                                                <span>{circuit.length}</span>\r\n                                            </div>\r\n\r\n                                            {/* Difficulty Badge */}\r\n                                            <span className={`\r\n                                                px-3 py-1 text-xs font-bold border-2 hard-border shadow-[0_0_10px_currentColor]\r\n                                                ${difficultyColors[circuit.difficulty]}\r\n                                            `} style={{ opacity: 0.8 }}>\r\n                                                {circuit.difficulty}\r\n                                            </span>\r\n\r\n                                            {/* Arrow */}\r\n                                            <ChevronRight\r\n                                                size={20}\r\n                                                className={`\r\n                                                    text-zinc-600 transition-transform duration-300\r\n                                                    ${selectedId === circuit.id ? \"rotate-90 text-toxic-cyan\" : \"\"}\r\n                                                `}\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Expanded Details */}\r\n                                {selectedId === circuit.id && (\r\n                                    <motion.div\r\n                                        initial={{ opacity: 0, height: 0 }}\r\n                                        animate={{ opacity: 1, height: \"auto\" }}\r\n                                        className=\"px-4 pb-4 pt-0\"\r\n                                    >\r\n                                        <div className=\"border-t-2 border-zinc-800 pt-4 mt-2\">\r\n                                            {/* Description */}\r\n                                            <p className=\"text-zinc-400 text-sm mb-4 font-bold tracking-wide\">{circuit.description}</p>\r\n\r\n                                            {/* Stats Row */}\r\n                                            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\">\r\n                                                <div className=\"bg-black border-2 border-zinc-800 p-3 hard-border\">\r\n                                                    <div className=\"text-zinc-500 text-[10px] font-bold tracking-widest uppercase\">Longueur</div>\r\n                                                    <div className=\"text-white font-bold text-lg\">{circuit.length}</div>\r\n                                                </div>\r\n                                                <div className=\"bg-black border-2 border-zinc-800 p-3 hard-border\">\r\n                                                    <div className=\"text-zinc-500 text-[10px] font-bold tracking-widest uppercase\">Points GPS</div>\r\n                                                    <div className=\"text-white font-bold text-lg\">{circuit.routePoints.length}</div>\r\n                                                </div>\r\n                                                {circuit.record && (\r\n                                                    <div className=\"bg-black border-2 border-zinc-800 p-3 hard-border\">\r\n                                                        <div className=\"text-zinc-500 text-[10px] font-bold tracking-widest uppercase flex items-center gap-1\">\r\n                                                            <Clock size={10} /> Record\r\n                                                        </div>\r\n                                                        <div className=\"text-toxic-yellow font-bold text-lg\">{circuit.record}</div>\r\n                                                    </div>\r\n                                                )}\r\n                                                <div className=\"bg-black border-2 border-zinc-800 p-3 hard-border\">\r\n                                                    <div className=\"text-zinc-500 text-[10px] font-bold tracking-widest uppercase\">Difficult√©</div>\r\n                                                    <div className={`font-bold text-lg ${difficultyColors[circuit.difficulty].split(\" \")[0]}`}>\r\n                                                        {circuit.difficulty}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            {/* View Route Button */}\r\n                                            <Link\r\n                                                href={`/touge/${circuit.id}`}\r\n                                                className=\"inline-flex items-center gap-2 bg-toxic-cyan text-black hover:bg-white px-6 py-3 font-bold transition-colors hard-border w-full justify-center md:w-auto shadow-[0_0_15px_rgba(0,255,255,0.2)]\"\r\n                                            >\r\n                                                <Eye size={18} />\r\n                                                ACCESS GPS DATA\r\n                                            </Link>\r\n                                        </div>\r\n                                    </motion.div>\r\n                                )}\r\n                            </motion.div>\r\n                        ))}\r\n                    </div>\r\n\r\n                    {/* STATS FOOTER */}\r\n                    <div className=\"mt-12 pt-6 border-t-2 border-zinc-800 flex flex-wrap gap-8 text-sm font-bold tracking-widest uppercase\">\r\n                        <div>\r\n                            <span className=\"text-zinc-500\">Total Trac√©s:</span>\r\n                            <span className=\"text-white ml-2\">{circuits.length}</span>\r\n                        </div>\r\n                        <div>\r\n                            <span className=\"text-zinc-500\">Distance Totale:</span>\r\n                            <span className=\"text-toxic-cyan ml-2\">\r\n                                {circuits.reduce((acc, c) => acc + c.lengthKm, 0).toFixed(1)} km\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\app\\touge\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\components\\Navbar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\components\\PageTransition.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\components\\ui\\Button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\components\\ui\\Card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\components\\ui\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kylia\\Documents\\Antigravity\\Projet perso\\Project D\\project-d\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]